<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>计算机基础教程</title>
    <meta name="description" content="软件开发教程，渗透测试入门教程，区块链入门教程，物联网，大数据">
    
    
    <link rel="preload" href="/docs/assets/css/0.styles.89d6372f.css" as="style"><link rel="preload" href="/docs/assets/js/app.79bfe0ab.js" as="script"><link rel="preload" href="/docs/assets/js/2.5d2fca3b.js" as="script"><link rel="preload" href="/docs/assets/js/17.9e41722f.js" as="script"><link rel="prefetch" href="/docs/assets/js/10.b403a917.js"><link rel="prefetch" href="/docs/assets/js/11.3c00198c.js"><link rel="prefetch" href="/docs/assets/js/12.d1657a13.js"><link rel="prefetch" href="/docs/assets/js/13.a8c39f42.js"><link rel="prefetch" href="/docs/assets/js/14.cde54419.js"><link rel="prefetch" href="/docs/assets/js/15.e850c978.js"><link rel="prefetch" href="/docs/assets/js/16.36b78963.js"><link rel="prefetch" href="/docs/assets/js/18.49594325.js"><link rel="prefetch" href="/docs/assets/js/19.1627fdbb.js"><link rel="prefetch" href="/docs/assets/js/20.c93e68c2.js"><link rel="prefetch" href="/docs/assets/js/21.faea7c5c.js"><link rel="prefetch" href="/docs/assets/js/22.01d02af0.js"><link rel="prefetch" href="/docs/assets/js/23.f87148a0.js"><link rel="prefetch" href="/docs/assets/js/24.74f8527a.js"><link rel="prefetch" href="/docs/assets/js/25.a4049671.js"><link rel="prefetch" href="/docs/assets/js/26.81465876.js"><link rel="prefetch" href="/docs/assets/js/27.19ca6d3b.js"><link rel="prefetch" href="/docs/assets/js/28.f75d33f6.js"><link rel="prefetch" href="/docs/assets/js/29.22623ead.js"><link rel="prefetch" href="/docs/assets/js/3.ffb01b08.js"><link rel="prefetch" href="/docs/assets/js/30.073102a9.js"><link rel="prefetch" href="/docs/assets/js/31.dab72611.js"><link rel="prefetch" href="/docs/assets/js/32.ece6cb5f.js"><link rel="prefetch" href="/docs/assets/js/33.364cbe96.js"><link rel="prefetch" href="/docs/assets/js/34.8833b6d3.js"><link rel="prefetch" href="/docs/assets/js/35.e4d221bc.js"><link rel="prefetch" href="/docs/assets/js/36.846fa716.js"><link rel="prefetch" href="/docs/assets/js/37.c1cd38bf.js"><link rel="prefetch" href="/docs/assets/js/38.65fa1981.js"><link rel="prefetch" href="/docs/assets/js/39.17e76ea1.js"><link rel="prefetch" href="/docs/assets/js/4.6b1b1ab7.js"><link rel="prefetch" href="/docs/assets/js/40.0c2fce03.js"><link rel="prefetch" href="/docs/assets/js/41.5faa85e3.js"><link rel="prefetch" href="/docs/assets/js/42.21a0c53a.js"><link rel="prefetch" href="/docs/assets/js/43.bed28c2d.js"><link rel="prefetch" href="/docs/assets/js/44.6727afd8.js"><link rel="prefetch" href="/docs/assets/js/45.1c3386c9.js"><link rel="prefetch" href="/docs/assets/js/46.3ff1ae87.js"><link rel="prefetch" href="/docs/assets/js/47.897aa2ce.js"><link rel="prefetch" href="/docs/assets/js/48.f2174d7d.js"><link rel="prefetch" href="/docs/assets/js/49.3089bb7f.js"><link rel="prefetch" href="/docs/assets/js/5.1b8a14a3.js"><link rel="prefetch" href="/docs/assets/js/6.5d168d47.js"><link rel="prefetch" href="/docs/assets/js/7.9d3ec080.js"><link rel="prefetch" href="/docs/assets/js/8.110723eb.js"><link rel="prefetch" href="/docs/assets/js/9.dc74e0ff.js">
    <link rel="stylesheet" href="/docs/assets/css/0.styles.89d6372f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/docs/" class="home-link router-link-active"><!----> <span class="site-name">计算机基础教程</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/docs/" class="nav-link">机器指令</a></div><div class="nav-item"><a href="/docs/software/" class="nav-link router-link-active">软件基础</a></div><div class="nav-item"><a href="/docs/coder2hacker/" class="nav-link">渗透测试</a></div><div class="nav-item"><a href="/docs/blockchain/" class="nav-link">区块链</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/docs/" class="nav-link">机器指令</a></div><div class="nav-item"><a href="/docs/software/" class="nav-link router-link-active">软件基础</a></div><div class="nav-item"><a href="/docs/coder2hacker/" class="nav-link">渗透测试</a></div><div class="nav-item"><a href="/docs/blockchain/" class="nav-link">区块链</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span></span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/software/database/mysql.html#_1-setup" class="sidebar-link">1.Setup</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/software/database/mysql.html#_1-1-install-on-centos" class="sidebar-link">1.1 Install on centos</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/mysql.html#_1-2-install-on-windows" class="sidebar-link">1.2 Install on windows</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/mysql.html#_1-3-tool" class="sidebar-link">1.3 Tool</a></li></ul></li><li><a href="/docs/software/database/mysql.html#_2-common-sql" class="sidebar-link">2. Common SQL</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/docs/software/database/mysql.html#_3-troubleshooting" class="sidebar-link">3.Troubleshooting</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p><a href="/docs/software">回目录</a>  《mysql实用基础》</p> <h2 id="_1-setup"><a href="#_1-setup" class="header-anchor">#</a> 1.Setup</h2> <h3 id="_1-1-install-on-centos"><a href="#_1-1-install-on-centos" class="header-anchor">#</a> 1.1 Install on centos</h3> <p><strong>Using rpm</strong></p> <p><strong>Using tar</strong></p> <p>tar -xvf mysql-5.7.26-1.el7.x86_64.rpm-bundle.tar
yum install mysql-community-{server,client,common,libs}-* mysql-5.*­</p> <p>?#Install error
https://princetonits.com/centos7-mysql-install-fails-due-conflict-libmysqlclient/
yum list installed mariadb*
yum remove mariadb-libs.x86_64</p> <div class="language- extra-class"><pre class="language-text"><code>vim /etc/my.cnf
Bind-address:0.0.0.0
service mysqld stop/start
</code></pre></div><p>Mysql default password
/var/log/mysqld.log
A temporary password
https://www.techietown.info/2017/08/mysql-default-root-password-on-centos7/</p> <p>password policy:</p> <div class="language- extra-class"><pre class="language-text"><code>mysql -uroot -p
SET PASSWORD = PASSWORD(‘1qaz#EDC’);
SHOW VARIABLES LIKE 'validate_password%';
SET GLOBAL validate_password_length = 6;
SET GLOBAL validate_password_number_count = 0;
SET PASSWORD = PASSWORD(‘123456’);
</code></pre></div><p>create database:</p> <div class="language- extra-class"><pre class="language-text"><code>CREATE USER 'newuser'@'%' IDENTIFIED BY 'password';
GRANT ALL PRIVILEGES ON dbname.* TO 'newuser'@'%' identified by 'password';
#GRANT ALL PRIVILEGES ON *.* TO 'newuser'@'localhost';
FLUSH PRIVILEGES;

SHOW GRANTS FOR 'root'@'localhost';
SELECT user, host FROM mysql.user;
DROP USER ''@'localhost';

create database dbname;

</code></pre></div><h3 id="_1-2-install-on-windows"><a href="#_1-2-install-on-windows" class="header-anchor">#</a> 1.2 Install on windows</h3> <p><img src="/docs/docs_image/software/mysql/mysql01.png" alt=""></p> <p>Setup replication
https://lyhistory.com/mysql_replication/#</p> <h3 id="_1-3-tool"><a href="#_1-3-tool" class="header-anchor">#</a> 1.3 Tool</h3> <p>http://sqlfiddle.com/</p> <p>Dbeaver export mysql
Export without data https://github.com/dbeaver/dbeaver/issues/2176</p> <h2 id="_2-common-sql"><a href="#_2-common-sql" class="header-anchor">#</a> 2. Common SQL</h2> <p>a mysql db can have many schema,like a building have many rooms, and users can get access to different room, so schema can have more than one user.</p> <div class="language- extra-class"><pre class="language-text"><code>SELECT DATE_FORMAT(date_add(date_column,INTERVAL 8 HOUR),'%b %d %Y %h %p'),COUNT(distinct(count_column))
FROM db.table
where date_add(date_column,INTERVAL 8 HOUR) between '2015-02-01 00:00:00' and '2015-03-01 00:00:00'
GROUP BY DATE_FORMAT(date_column,'%b %d %Y %h %p')
order by DATE_FORMAT(date_add(date_column,INTERVAL 8 HOUR),'%b %d %Y %h %p');
</code></pre></div><p>CRUD</p> <div class="language- extra-class"><pre class="language-text"><code>insert into phoenix.`program-slot`(duration,dateOfProgram,startTime,`weekly-schedule_id`,presenter_id,producer_id,program_id)
select duration,date_add(dateOfProgram,INTERVAL 2 DAY), IFNULL(date_add(startTime,INTERVAL 2 DAY),null) ,100,presenter_id,producer_id,program_id from phoenix.`program-slot` where `weekly-schedule_id` =3;

</code></pre></div><p>Performance on index : when join a large table</p> <div class="language- extra-class"><pre class="language-text"><code>bad:
select user.*, log.LoginTime
from users user
left join login_log log on user.id=log.userid and log.LoginTime=(select max(LoginTime) from login_log where userid=log.userid and status='true');
good:
select user.*, log.LoginTime
from users user
left join (
select max(LoginTime) LoginTime,userid from login_log
where  status='true'
group by userid) temp on temp.userid=user.userid;
</code></pre></div><p>存储过程互相调用</p> <div class="language- extra-class"><pre class="language-text"><code>DELIMITER $$
CREATE DEFINER=`dbuser`@`%` PROCEDURE `PROCE1`(
in _param varchar(50)
)
root:BEGIN
declare _count int;
select count(1) into _count from table where column=_param;
if _count&lt;&gt;1 then
select -1 as result;
leave root;
end if;
call PROCE2(_param);
do something else
select 0 as result;
END

DELIMITER $$
CREATE DEFINER=`dbuser`@`%` PROCEDURE `PROCE2`(
in _param int
)
BEGIN
DECLARE done INT DEFAULT FALSE;
declare _variable1 int;
declare _variable2 decimal(10,2);
declare resultCur cursor for select column1,column2 from table where column=_param;
DECLARE CONTINUE HANDLER FOR NOT FOUND SET done = TRUE;
DECLARE exit handler for sqlexception
BEGIN
ROLLBACK;
get diagnostics condition 1 @p1 = MESSAGE_TEXT;
select -1 as result, @p1 as message from dual;
END;
open resultCur;
operaLoop:Loop
fetch resultCur into _variable1,_variable2;
if done then
leave operaLoop;
end if;
do something...
end Loop;
close resultCur;
END

</code></pre></div><p>Multiple cursors in mysql stored procedure</p> <div class="language- extra-class"><pre class="language-text"><code>DROP PROCEDURE IF EXISTS `multipleCursorsAtOne`;
DELIMITER $$
CREATE PROCEDURE `multipleCursorsAtOne`()
BEGIN
DROP TABLE IF EXISTS userNames;
CREATE TEMPORARY TABLE userNames
(userName varchar(200) NOT NULL);
BEGIN
DECLARE done BOOLEAN DEFAULT false;
DECLARE p_first_name VARCHAR(200);
DECLARE cursor_a CURSOR FOR SELECT user_name FROM user_info LIMIT 1,3;
DECLARE CONTINUE HANDLER FOR NOT FOUND SET done = TRUE;
OPEN cursor_a;
cursor_a_loop: LOOP
FETCH cursor_a INTO p_first_name;
IF done THEN
LEAVE cursor_a_loop;
END IF;
-- cursor loop statements
IF p_first_name IS NOT NULL AND p_first_name &lt;&gt; &quot;&quot; THEN
INSERT INTO userNames(userName) VALUES(p_first_name);
END IF;
END LOOP;
CLOSE cursor_a;
END;
BEGIN
DECLARE done BOOLEAN DEFAULT false;
DECLARE p_first_name VARCHAR(200);
DECLARE cursor_a CURSOR FOR SELECT user_name FROM user_info LIMIT 4,3;
DECLARE CONTINUE HANDLER FOR NOT FOUND SET done = TRUE;
OPEN cursor_a;
cursor_a_loop: LOOP
FETCH cursor_a INTO p_first_name;
IF done THEN
LEAVE cursor_a_loop;
END IF;
-- cursor loop statements
IF p_first_name IS NOT NULL AND p_first_name &lt;&gt; &quot;&quot; THEN
INSERT INTO userNames(userName) VALUES(p_first_name);
END IF;
END LOOP;
CLOSE cursor_a;
END;
SELECT * FROM userNames;
END
$$

</code></pre></div><h2 id="_3-troubleshooting"><a href="#_3-troubleshooting" class="header-anchor">#</a> 3.Troubleshooting</h2> <p>#Host 'xxx.xx.xxx.xxx' is not allowed to connect to this MySQL server</p> <div class="language- extra-class"><pre class="language-text"><code>CREATE USER 'test'@'%' IDENTIFIED BY '123456';
GRANT ALL PRIVILEGES ON * . * TO 'test'@'%';
FLUSH PRIVILEGES;
</code></pre></div><p>mysql workbench The type initializer for 'HtmlRenderer.Utils.FontsUtils' threw an exception.
http://stackoverflow.com/questions/32020024/upgrading-to-windows-10-breaks-mysql-workbench
https://bugs.mysql.com/bug.php?id=75344</p> <p>script import issue;
delimiter http://buysql.com/mysql/42-delimiter-mysql.html
-- Set new delimiter '$$'
DELIMITER $$
$$
-- Set default delimiter ';'
DELIMITER ;
Recursive query
Hierarchical data in MySQL: parents and children in one query
Managing Hierarchical Data in MySQL</p> <hr> <p>ref:</p> <p>https://www.digitalocean.com/community/tutorials/how-to-install-mysql-on-centos-7</p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/docs/assets/js/app.79bfe0ab.js" defer></script><script src="/docs/assets/js/2.5d2fca3b.js" defer></script><script src="/docs/assets/js/17.9e41722f.js" defer></script>
  </body>
</html>
