https://github.com/f1xpl/openauto

DTC: Diagnostic Trouble Codes æ•…éšœè¯Šæ–­ç 
HEV: hybrid electric vehicle æ··åˆåŠ¨åŠ›ç”µåŠ¨æ±½è½¦
MIL: malfunction indicator lamp æ•…éšœæŒ‡ç¤ºç¯
BCD: Binary-Coded Decimal äºŒè¿›åˆ¶ç åè¿›åˆ¶æ•°æˆ–äºŒ-åè¿›åˆ¶ä»£ç ï¼Œç”¨4ä½äºŒè¿›åˆ¶æ•°æ¥è¡¨ç¤º1ä½åè¿›åˆ¶æ•°ä¸­çš„0~9è¿™10ä¸ªæ•°ç 

## odb - On-board diagnostics
OBD systems give the vehicle owner or repair technician access to the status of the various vehicle sub-systems. 

16-pin D-shaped connector
![](/docs/docs_image/software/hardware/car/odb2.png)

odb socket location:
+ above the pedals on the right
+ in or near the dashboard close to the steering wheel
  
### Electronic control unit/ electronic control module ç”µå­å™¨ä»¶æ§åˆ¶å•å…ƒ
Modern vehicles have many ECUs, and these can include some or all of the following: engine control module (ECM), powertrain control module (PCM), transmission control module (TCM), brake control module (BCM or EBCM), central control module (CCM), central timing module (CTM), general electronic module (GEM), body control module (BCM), and suspension control module (SCM). These ECUs together are sometimes referred to collectively as the car's computer though technically they are all separate computers, not a single one. Sometimes an assembly incorporates several individual control modules (a PCM often controls both the engine and the transmission)

![](/docs/docs_image/software/hardware/car/ecu.jpg)

#### ç»„ä»¶ï¼šECU-Engine control unit/ECM-engine control module å‘åŠ¨æœºæ§åˆ¶å™¨
https://www.youtube.com/watch?v=yGaTsIfxrzM
æ˜¯ä¸€ç§æ§åˆ¶å†…ç‡ƒæœºå„ä¸ªéƒ¨åˆ†è¿ä½œçš„ç”µå­è£…ç½®ã€‚ æœ€ç®€å•çš„ECUåªæ§åˆ¶æ¯ä¸ªå¼•æ“å‘¨æœŸçš„æ³¨æ²¹é‡ã€‚ åœ¨ç°ä»£æ±½è½¦ä¸Šé…å¤‡çš„æ›´é«˜çº§çš„å‘åŠ¨æœºæ§åˆ¶å™¨è¿˜æ§åˆ¶ç‚¹ç«æ—¶é—´ã€å¯å˜é˜€é—¨æ—¶é—´ï¼ˆVVTï¼‰ã€æ¶¡è½®å¢å‹å™¨ç»´æŒçš„æ¨è¿›çº§åˆ«ï¼ˆé…å¤‡æ¶¡è½®å¢å‹çš„æ±½è½¦ï¼‰å’Œå…¶ä»–å¤–å›´è®¾å¤‡ã€‚
also commonly called an engine control module (ECM), is a type of electronic control unit that controls a series of actuators on an internal combustion engine to ensure optimal engine performance. It does this by reading values from a multitude of sensors within the engine bay, interpreting the data using multidimensional performance maps (called lookup tables), and adjusting the engine actuators. 

Sensors for air flow, pressure, temperature, speed, exhaust oxygen, * knock and crank angle position sensor makes a very vital impact in EEMS. sensors:

+ MAP: Manifold Absolute pressure.
+ IAT: Intake Air Temperature.
+ MAF: Mass of Air Flow.
+ CKP: Crank Shaft Position.
+ CMP: CAM Shaft position.
+ ECT: Engine coolant temperature.
+ O2: Oxygen sensor.
+ TP: throttle position.
+ VSS: Vehicle speed sensor.
+ Knock sensor
+ APP: Acceleration pedal position.
+ Refrigrant sensor

Modern ECUs use a microprocessor which can process the inputs from the engine sensors in real-time. An electronic control unit contains the hardware and software (firmware). The hardware consists of electronic components on a printed circuit board (PCB), ceramic substrate or a thin laminate substrate. The main component on this circuit board is a microcontroller chip (MCU). The software is stored in the microcontroller or other chips on the PCB., typically in EPROMs or flash memory so the CPU can be re-programmed by uploading updated code or replacing chips. This is also referred to as an (electronic) Engine Management System (EMS).

Sophisticated engine management systems receive inputs from other sources, and control other parts of the engine; for instance, some variable valve timing systems are electronically controlled, and turbocharger waste gates can also be managed. They also may communicate with transmission control units or directly interface electronically controlled automatic transmissions, traction control systems, and the like. **The Controller Area Network or CAN bus** automotive network is often used to achieve communication between these devices.

2008: All cars sold in the United States are required to use the ISO 15765-4 signaling standard (a variant of the Controller Area Network (CAN) bus).

#### ç»„ä»¶ï¼šTransmission control unit
Difference Between Engine and Transmission- The basic difference between an engine and a transmission is that an engine is a device that converts different types of energy into mechanical output while a transmission is an instrument that controls the use of power generated by an engine in a power transmission system.

A transmission control unit (TCU), also known as a transmission control module (TCM), or a gearbox control unit (GCU), is a type of automotive ECU that is used to control electronic automatic transmissions. Similar systems are used in conjunction with various semi-automatic transmissions, purely for clutch automation and actuation. A TCU in a modern automatic transmission generally uses sensors from the vehicle, as well as data provided by the engine control unit (ECU), to calculate how and when to change gears in the vehicle for optimum performance, fuel economy and shift quality.

### é€šä¿¡ï¼šCAN BUS æ§åˆ¶å™¨å±€åŸŸç½‘æ€»çº¿æŠ€æœ¯ï¼ˆController Area Network-BUSï¼‰
A Controller Area Network (CAN bus) is a vehicle bus standard designed to allow microcontrollers and devices to communicate with each other's applications without a host computer. It is a message-based protocol, designed originally for multiplex electrical wiring within automobiles to save on copper, but it can also be used in many other contexts. For each device, the data in a frame is transmitted serially but in such a way that if more than one device transmits at the same time, the highest priority device can continue while the others back off. Frames are received by all devices, including by the transmitting device.

The CAN bus is one of five protocols used in the on-board diagnostics (OBD)-II vehicle diagnostics standard:
+ CAN
+ LIN
+ MOST
+ FlexRay
+ K-Line

[CAN Bus Explained - A Simple Intro [v1.0 | 2019]](https://www.youtube.com/watch?v=FqLDpHsxvf8)
[CAN Bus Explained - A Simple Intro [v2.0 | 2021](https://www.youtube.com/watch?v=oYps7vT708E)

[How to hack your car | Part 1 - The basics of the CAN bus](https://www.youtube.com/watch?v=cAAzXM5vsi0)

Arduino + CAN driver MCP2515 + OBD-2 Plug pintout(female) by SAE J1962 standard

### Command Codes: OBD-II PIDs 
https://en.wikipedia.org/wiki/OBD-II_PIDs
OBD-II PIDs (On-board diagnostics Parameter IDs) are codes used to request data from a vehicle, used as a diagnostic tool.

å‘½ä»¤æ ¼å¼ï¼š
<Command HEX Value: Mode|PID>
ä¾‹å­ï¼š01 (mode: current data) 0D (vehicle speed)

è¿”å›å€¼ï¼š
å¦‚æœatå‘½ä»¤è®¾ç½®äº†ath1ä¹Ÿå°±æ˜¯è¿”å›headerï¼Œåˆ™ï¼š
å¤´ä¸‰ä¸ªå­—èŠ‚æ˜¯headerï¼Œåé¢çš„å­—èŠ‚æ˜¯è¿”å›ç»“æœï¼š41 [PID] xx xx xx... , 41å°±æ˜¯responseï¼Œ[PID]å°±æ˜¯æˆ‘ä»¬å‘é€çš„PIDæŒ‡ä»¤ï¼Œåé¢çš„xxå°±æ˜¯å…·ä½“çš„å€¼äº†

#### Mode
| Service / Mode (hex) |                                              Description                                              |
|----------------------|-------------------------------------------------------------------------------------------------------|
|          01          |                                           Show current data/æ˜¾ç¤ºå½“å‰æ•°æ®                                           |
|          02          |                                        Show freeze frame data/æ˜¾ç¤ºå†»ç»“å¸§æ•°æ®                                         |
|          03          |                                 Show stored Diagnostic Trouble Codes/æ˜¾ç¤ºå­˜å‚¨è¯Šæ–­æ•…éšœä»£ç                                   |
|          04          |                           Clear Diagnostic Trouble Codes and stored values/æ¸…é™¤è¯Šæ–­æ•…éšœä»£ç å’Œå­˜å‚¨å€¼                            |
|          05          |                         Test results, oxygen sensor monitoring (non CAN only)/æµ‹è¯•ç»“æœ,æ°§ä¼ æ„Ÿå™¨ç›‘æµ‹                         |
|          06          | Test results, other component/system monitoring (Test results, oxygen sensor monitoring for CAN only)/æµ‹è¯•ç»“æœ,å…¶ä»–ç»„ä»¶/ç³»ç»Ÿç›‘æ§ |
|          07          |         Show pending Diagnostic Trouble Codes (detected during current or last driving cycle)/æ˜¾ç¤ºç­‰å¾…è¯Šæ–­æ•…éšœä»£ç          |
|          08          |                            Control operation of on-board component/system/æ§åˆ¶ç”µè·¯æ¿ç»„ä»¶/ç³»ç»Ÿçš„æ“ä½œ                             |
|          09          |                                      Request vehicle information/è¯·æ±‚è½¦è¾†ä¿¡æ¯                                      |
|          0A          |                       Permanent Diagnostic Trouble Codes (DTCs) (Cleared DTCs)/æ¸…é™¤æ•…éšœè¯Šæ–­ç                         |

#### PIDs
|          PIDs (hex)          |         PID (Dec)         | Data bytes returned |                                                                    Description                                                                    |          Min value           |         Max value         |       Units       |                                                       Formula[a]                                                       |
|------------------------------|---------------------------|---------------------|---------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------|---------------------------|-------------------|------------------------------------------------------------------------------------------------------------------------|
|              00              |             0             |          4          |                                                            PIDs supported [$01 - $20]                                                             |                              |                           |                   |                                  Bit encoded [A7..D0] == [PID $01..PID $20] See below                                  |
|              01              |             1             |          4          | Monitor status since DTCs cleared. (Includes malfunction indicator lamp (MIL), status and number of DTCs, components tests, DTC readiness checks) |                              |                           |                   |                                                 Bit encoded. See below                                                 |
|              02              |             2             |          2          |                                                    DTC that caused freeze frame to be stored.                                                     |                              |                           |                   |                                                Decoded as in service 3                                                 |
|              03              |             3             |          2          |                                                                Fuel system status                                                                 |                              |                           |                   |                                                 Bit encoded. See below                                                 |
|              04              |             4             |          1          |                                                              Calculated engine load                                                               |              0               |            100            |         %         |                                               100 255 ğ´  (or  ğ´ 2.55 )                                               |
|              05              |             5             |          1          |                                                            Engine coolant temperature                                                             |             -40              |            215            |        Â°C         |                                                        ğ´ âˆ’ 40                                                         |
|              06              |             6             |          1          |                                                            Short term fuel trimâ€”Bank 1                                                            | -100 (Reduce Fuel: Too Rich) | 99.2 (Add Fuel: Too Lean) |         %         |                                         100 128 ğ´ âˆ’ 100 (or  ğ´ 1.28 âˆ’ 100  )                                         |
| -100 (Reduce Fuel: Too Rich) | 99.2 (Add Fuel: Too Lean) |          %          |                                                      100 128 ğ´ âˆ’ 100 (or  ğ´ 1.28 âˆ’ 100  )                                                       |              07              |             7             |         1         |                                               Long term fuel trimâ€”Bank 1                                               |
| -100 (Reduce Fuel: Too Rich) | 99.2 (Add Fuel: Too Lean) |          %          |                                                      100 128 ğ´ âˆ’ 100 (or  ğ´ 1.28 âˆ’ 100  )                                                       |              08              |             8             |         1         |                                              Short term fuel trimâ€”Bank 2                                               |
| -100 (Reduce Fuel: Too Rich) | 99.2 (Add Fuel: Too Lean) |          %          |                                                      100 128 ğ´ âˆ’ 100 (or  ğ´ 1.28 âˆ’ 100  )                                                       |              09              |             9             |         1         |                                               Long term fuel trimâ€”Bank 2                                               |
|              0A              |            10             |          1          |                                                          Fuel pressure (gauge pressure)                                                           |              0               |            765            |        kPa        |                                                          3 ğ´                                                          |
|              0B              |            11             |          1          |                                                         Intake manifold absolute pressure                                                         |              0               |            255            |        kPa        |                                                           ğ´                                                           |
|              0C              |            12             |          2          |                                                                   Engine speed                                                                    |              0               |         16,383.75         |        rpm        |                                                     256 ğ´ + ğµ 4                                                      |
|              0D              |            13             |          1          |                                                                   Vehicle speed                                                                   |              0               |            255            |       km/h        |                                                           ğ´                                                           |
|              0E              |            14             |          1          |                                                                  Timing advance                                                                   |             -64              |           63.5            |   Â° before TDC    |                                                       ğ´ 2 âˆ’ 64                                                        |
|              0F              |            15             |          1          |                                                              Intake air temperature                                                               |             -40              |            215            |        Â°C         |                                                        ğ´ âˆ’ 40                                                         |
|              10              |            16             |          2          |                                                     Mass air flow sensor (MAF) air flow rate                                                      |              0               |          655.35           |        g/s        |                                                    256 ğ´ + ğµ 100                                                     |
|              11              |            17             |          1          |                                                                 Throttle position                                                                 |              0               |            100            |         %         |                                                       100 255 ğ´                                                       |
|              12              |            18             |          1          |                                                          Commanded secondary air status                                                           |                              |                           |                   |                                                 Bit encoded. See below                                                 |
|              13              |            19             |          1          |                                                        Oxygen sensors present (in 2 banks)                                                        |                              |                           |                   |                                 [A0..A3] == Bank 1, Sensors 1-4. [A4..A7] == Bank 2...                                 |
|              14              |            20             |          2          |                                                Oxygen Sensor 1 A: Voltage B: Short term fuel trim                                                 |            0 -100            |        1.275 99.2         |       V  %        |                      ğ´ 200 100 128 ğµ âˆ’ 100 (if B==$FF, sensor is not used in trim calculation)                       |
|            0 -100            |        1.275 99.2         |        V  %         |                                    ğ´ 200 100 128 ğµ âˆ’ 100 (if B==$FF, sensor is not used in trim calculation)                                    |              15              |            21             |         2         |                                   Oxygen Sensor 2 A: Voltage B: Short term fuel trim                                   |
|            0 -100            |        1.275 99.2         |        V  %         |                                    ğ´ 200 100 128 ğµ âˆ’ 100 (if B==$FF, sensor is not used in trim calculation)                                    |              16              |            22             |         2         |                                   Oxygen Sensor 3 A: Voltage B: Short term fuel trim                                   |
|            0 -100            |        1.275 99.2         |        V  %         |                                    ğ´ 200 100 128 ğµ âˆ’ 100 (if B==$FF, sensor is not used in trim calculation)                                    |              17              |            23             |         2         |                                   Oxygen Sensor 4 A: Voltage B: Short term fuel trim                                   |
|            0 -100            |        1.275 99.2         |        V  %         |                                    ğ´ 200 100 128 ğµ âˆ’ 100 (if B==$FF, sensor is not used in trim calculation)                                    |              18              |            24             |         2         |                                   Oxygen Sensor 5 A: Voltage B: Short term fuel trim                                   |
|            0 -100            |        1.275 99.2         |        V  %         |                                    ğ´ 200 100 128 ğµ âˆ’ 100 (if B==$FF, sensor is not used in trim calculation)                                    |              19              |            25             |         2         |                                   Oxygen Sensor 6 A: Voltage B: Short term fuel trim                                   |
|            0 -100            |        1.275 99.2         |        V  %         |                                    ğ´ 200 100 128 ğµ âˆ’ 100 (if B==$FF, sensor is not used in trim calculation)                                    |              1A              |            26             |         2         |                                   Oxygen Sensor 7 A: Voltage B: Short term fuel trim                                   |
|            0 -100            |        1.275 99.2         |        V  %         |                                    ğ´ 200 100 128 ğµ âˆ’ 100 (if B==$FF, sensor is not used in trim calculation)                                    |              1B              |            27             |         2         |                                   Oxygen Sensor 8 A: Voltage B: Short term fuel trim                                   |
|              1C              |            28             |          1          |                                                      OBD standards this vehicle conforms to                                                       |              1               |            250            |                   |                                                 enumerated. See below                                                  |
|              1D              |            29             |          1          |                                                        Oxygen sensors present (in 4 banks)                                                        |                              |                           |                   |                  Similar to PID $13, but [A0..A7] == [B1S1, B1S2, B2S1, B2S2, B3S1, B3S2, B4S1, B4S2]                  |
|              1E              |            30             |          1          |                                                              Auxiliary input status                                                               |                              |                           |                   |                           A0 == Power Take Off (PTO) status (1 == active) [A1..A7] not used                            |
|              1F              |            31             |          2          |                                                            Run time since engine start                                                            |              0               |          65,535           |         s         |                                                      256 ğ´ + ğµ                                                       |
|              20              |            32             |          4          |                                                            PIDs supported [$21 - $40]                                                             |                              |                           |                   |                                  Bit encoded [A7..D0] == [PID $21..PID $40] See below                                  |
|              21              |            33             |          2          |                                            Distance traveled with malfunction indicator lamp (MIL) on                                             |              0               |          65,535           |        km         |                                                      256 ğ´ + ğµ                                                       |
|              22              |            34             |          2          |                                                 Fuel Rail Pressure (relative to manifold vacuum)                                                  |              0               |         5177.265          |        kPa        |                                                 0.079 ( 256 ğ´ + ğµ )                                                  |
|              23              |            35             |          2          |                                          Fuel Rail Gauge Pressure (diesel, or gasoline direct injection)                                          |              0               |          655,350          |        kPa        |                                                   10 ( 256 ğ´ + ğµ )                                                   |
|              24              |            36             |          4          |                                       Oxygen Sensor 1 AB: Air-Fuel Equivalence Ratio (lambda,Î») CD: Voltage                                       |             0 0              |          < 2 < 8          |      ratio V      |                                    2 65536 ( 256 ğ´ + ğµ ) 8 65536 ( 256 ğ¶ + ğ· )                                     |
|             0 0              |          < 2 < 8          |       ratio V       |                                                  2 65536 ( 256 ğ´ + ğµ ) 8 65536 ( 256 ğ¶ + ğ· )                                                  |              25              |            37             |         4         |                         Oxygen Sensor 2 AB: Air-Fuel Equivalence Ratio (lambda,Î») CD: Voltage                          |
|             0 0              |          < 2 < 8          |       ratio V       |                                                  2 65536 ( 256 ğ´ + ğµ ) 8 65536 ( 256 ğ¶ + ğ· )                                                  |              26              |            38             |         4         |                         Oxygen Sensor 3 AB: Air-Fuel Equivalence Ratio (lambda,Î») CD: Voltage                          |
|             0 0              |          < 2 < 8          |       ratio V       |                                                  2 65536 ( 256 ğ´ + ğµ ) 8 65536 ( 256 ğ¶ + ğ· )                                                  |              27              |            39             |         4         |                         Oxygen Sensor 4 AB: Air-Fuel Equivalence Ratio (lambda,Î») CD: Voltage                          |
|             0 0              |          < 2 < 8          |       ratio V       |                                                  2 65536 ( 256 ğ´ + ğµ ) 8 65536 ( 256 ğ¶ + ğ· )                                                  |              28              |            40             |         4         |                         Oxygen Sensor 5 AB: Air-Fuel Equivalence Ratio (lambda,Î») CD: Voltage                          |
|             0 0              |          < 2 < 8          |       ratio V       |                                                  2 65536 ( 256 ğ´ + ğµ ) 8 65536 ( 256 ğ¶ + ğ· )                                                  |              29              |            41             |         4         |                         Oxygen Sensor 6 AB: Air-Fuel Equivalence Ratio (lambda,Î») CD: Voltage                          |
|             0 0              |          < 2 < 8          |       ratio V       |                                                  2 65536 ( 256 ğ´ + ğµ ) 8 65536 ( 256 ğ¶ + ğ· )                                                  |              2A              |            42             |         4         |                         Oxygen Sensor 7 AB: Air-Fuel Equivalence Ratio (lambda,Î») CD: Voltage                          |
|             0 0              |          < 2 < 8          |       ratio V       |                                                  2 65536 ( 256 ğ´ + ğµ ) 8 65536 ( 256 ğ¶ + ğ· )                                                  |              2B              |            43             |         4         |                         Oxygen Sensor 8 AB: Air-Fuel Equivalence Ratio (lambda,Î») CD: Voltage                          |
|              2C              |            44             |          1          |                                                                   Commanded EGR                                                                   |              0               |            100            |         %         |                                                       100 255 ğ´                                                       |
|              2D              |            45             |          1          |                                                                     EGR Error                                                                     |             -100             |           99.2            |         %         |                                                    100 128 ğ´ âˆ’ 100                                                    |
|              2E              |            46             |          1          |                                                            Commanded evaporative purge                                                            |              0               |            100            |         %         |                                                       100 255 ğ´                                                       |
|              2F              |            47             |          1          |                                                               Fuel Tank Level Input                                                               |              0               |            100            |         %         |                                                       100 255 ğ´                                                       |
|              30              |            48             |          1          |                                                           Warm-ups since codes cleared                                                            |              0               |            255            |                   |                                                           ğ´                                                           |
|              31              |            49             |          2          |                                                       Distance traveled since codes cleared                                                       |              0               |          65,535           |        km         |                                                      256 ğ´ + ğµ                                                       |
|              32              |            50             |          2          |                                                            Evap. System Vapor Pressure                                                            |            -8,192            |          8191.75          |        Pa         |                                   256 ğ´ + ğµ 4  (AB is two's complement signed)[3]                                    |
|              33              |            51             |          1          |                                                           Absolute Barometric Pressure                                                            |              0               |            255            |        kPa        |                                                           ğ´                                                           |
|              34              |            52             |          4          |                                       Oxygen Sensor 1 AB: Air-Fuel Equivalence Ratio (lambda,Î») CD: Current                                       |            0 -128            |         < 2 <128          |     ratio mA      |                                     2 65536 ( 256 ğ´ + ğµ ) 256 ğ¶ + ğ· 256 âˆ’ 128                                      |
|            0 -128            |         < 2 <128          |      ratio mA       |                                                   2 65536 ( 256 ğ´ + ğµ ) 256 ğ¶ + ğ· 256 âˆ’ 128                                                   |              35              |            53             |         4         |                         Oxygen Sensor 2 AB: Air-Fuel Equivalence Ratio (lambda,Î») CD: Current                          |
|            0 -128            |         < 2 <128          |      ratio mA       |                                                   2 65536 ( 256 ğ´ + ğµ ) 256 ğ¶ + ğ· 256 âˆ’ 128                                                   |              36              |            54             |         4         |                         Oxygen Sensor 3 AB: Air-Fuel Equivalence Ratio (lambda,Î») CD: Current                          |
|            0 -128            |         < 2 <128          |      ratio mA       |                                                   2 65536 ( 256 ğ´ + ğµ ) 256 ğ¶ + ğ· 256 âˆ’ 128                                                   |              37              |            55             |         4         |                         Oxygen Sensor 4 AB: Air-Fuel Equivalence Ratio (lambda,Î») CD: Current                          |
|            0 -128            |         < 2 <128          |      ratio mA       |                                                   2 65536 ( 256 ğ´ + ğµ ) 256 ğ¶ + ğ· 256 âˆ’ 128                                                   |              38              |            56             |         4         |                         Oxygen Sensor 5 AB: Air-Fuel Equivalence Ratio (lambda,Î») CD: Current                          |
|            0 -128            |         < 2 <128          |      ratio mA       |                                                   2 65536 ( 256 ğ´ + ğµ ) 256 ğ¶ + ğ· 256 âˆ’ 128                                                   |              39              |            57             |         4         |                         Oxygen Sensor 6 AB: Air-Fuel Equivalence Ratio (lambda,Î») CD: Current                          |
|            0 -128            |         < 2 <128          |      ratio mA       |                                                   2 65536 ( 256 ğ´ + ğµ ) 256 ğ¶ + ğ· 256 âˆ’ 128                                                   |              3A              |            58             |         4         |                         Oxygen Sensor 7 AB: Air-Fuel Equivalence Ratio (lambda,Î») CD: Current                          |
|            0 -128            |         < 2 <128          |      ratio mA       |                                                   2 65536 ( 256 ğ´ + ğµ ) 256 ğ¶ + ğ· 256 âˆ’ 128                                                   |              3B              |            59             |         4         |                         Oxygen Sensor 8 AB: Air-Fuel Equivalence Ratio (lambda,Î») CD: Current                          |
|              3C              |            60             |          2          |                                                      Catalyst Temperature: Bank 1, Sensor 1                                                       |             -40              |          6,513.5          |        Â°C         |                                                  256 ğ´ + ğµ 10 âˆ’ 40                                                   |
|             -40              |          6,513.5          |         Â°C          |                                                                256 ğ´ + ğµ 10 âˆ’ 40                                                                |              3D              |            61             |         2         |                                         Catalyst Temperature: Bank 2, Sensor 1                                         |
|             -40              |          6,513.5          |         Â°C          |                                                                256 ğ´ + ğµ 10 âˆ’ 40                                                                |              3E              |            62             |         2         |                                         Catalyst Temperature: Bank 1, Sensor 2                                         |
|             -40              |          6,513.5          |         Â°C          |                                                                256 ğ´ + ğµ 10 âˆ’ 40                                                                |              3F              |            63             |         2         |                                         Catalyst Temperature: Bank 2, Sensor 2                                         |
|              40              |            64             |          4          |                                                            PIDs supported [$41 - $60]                                                             |                              |                           |                   |                                  Bit encoded [A7..D0] == [PID $41..PID $60] See below                                  |
|              41              |            65             |          4          |                                                          Monitor status this drive cycle                                                          |                              |                           |                   |                                                 Bit encoded. See below                                                 |
|              42              |            66             |          2          |                                                              Control module voltage                                                               |              0               |          65.535           |         V         |                                                    256 ğ´ + ğµ 1000                                                    |
|              43              |            67             |          2          |                                                                Absolute load value                                                                |              0               |          25,700           |         %         |                                                100 255 ( 256 ğ´ + ğµ )                                                 |
|              44              |            68             |          2          |                                                  Commanded Air-Fuel Equivalence Ratio (lambda,Î»)                                                  |              0               |            < 2            |       ratio       |                                                2 65536 ( 256 ğ´ + ğµ )                                                 |
|              45              |            69             |          1          |                                                            Relative throttle position                                                             |              0               |            100            |         %         |                                                       100 255 ğ´                                                       |
|              46              |            70             |          1          |                                                              Ambient air temperature                                                              |             -40              |            215            |        Â°C         |                                                        ğ´ âˆ’ 40                                                         |
|              47              |            71             |          1          |                                                           Absolute throttle position B                                                            |              0               |            100            |         %         |                                                       100 255 ğ´                                                       |
|              0               |            100            |          %          |                                                                    100 255 ğ´                                                                     |              48              |            72             |         1         |                                              Absolute throttle position C                                              |
|              0               |            100            |          %          |                                                                    100 255 ğ´                                                                     |              49              |            73             |         1         |                                              Accelerator pedal position D                                              |
|              0               |            100            |          %          |                                                                    100 255 ğ´                                                                     |              4A              |            74             |         1         |                                              Accelerator pedal position E                                              |
|              0               |            100            |          %          |                                                                    100 255 ğ´                                                                     |              4B              |            75             |         1         |                                              Accelerator pedal position F                                              |
|              0               |            100            |          %          |                                                                    100 255 ğ´                                                                     |              4C              |            76             |         1         |                                              Commanded throttle actuator                                               |
|              4D              |            77             |          2          |                                                               Time run with MIL on                                                                |              0               |          65,535           |        min        |                                                      256 ğ´ + ğµ                                                       |
|              0               |          65,535           |         min         |                                                                    256 ğ´ + ğµ                                                                    |              4E              |            78             |         2         |                                            Time since trouble codes cleared                                            |
|              4F              |            79             |          4          |         Maximum value for Fuelâ€“Air equivalence ratio, oxygen sensor voltage, oxygen sensor current, and intake manifold absolute pressure         |          0, 0, 0, 0          |    255, 255, 255, 2550    | ratio, V, mA, kPa |                                               ğ´ ,  ğµ ,  ğ¶ ,  ğ· Ã— 10                                                |
|              50              |            80             |          4          |                                             Maximum value for air flow rate from mass air flow sensor                                             |              0               |           2550            |        g/s        |                               ğ´ Ã— 10 ;  ğµ ,  ğ¶ , and  ğ·  are reserved for future use                               |
|              51              |            81             |          1          |                                                                     Fuel Type                                                                     |                              |                           |                   |                                             From fuel type table see below                                             |
|              52              |            82             |          1          |                                                                  Ethanol fuelÂ %                                                                   |              0               |            100            |         %         |                                                       100 255 ğ´                                                       |
|              53              |            83             |          2          |                                                        Absolute Evap system Vapor Pressure                                                        |              0               |          327.675          |        kPa        |                                                    256 ğ´ + ğµ 200                                                     |
|              54              |            84             |          2          |                                                            Evap system vapor pressure                                                             |           -32,768            |          32,767           |        Pa         |                                     256 ğ´ + ğµ (AB is two's complement signed)[3]                                     |
|              55              |            85             |          2          |                                           Short term secondary oxygen sensor trim, A: bank 1, B: bank 3                                           |             -100             |           99.2            |         %         |                                           100 128 ğ´ âˆ’ 100  100 128 ğµ âˆ’ 100                                           |
|             -100             |           99.2            |          %          |                                                        100 128 ğ´ âˆ’ 100  100 128 ğµ âˆ’ 100                                                         |              56              |            86             |         2         |                              Long term secondary oxygen sensor trim, A: bank 1, B: bank 3                              |
|             -100             |           99.2            |          %          |                                                        100 128 ğ´ âˆ’ 100  100 128 ğµ âˆ’ 100                                                         |              57              |            87             |         2         |                             Short term secondary oxygen sensor trim, A: bank 2, B: bank 4                              |
|             -100             |           99.2            |          %          |                                                        100 128 ğ´ âˆ’ 100  100 128 ğµ âˆ’ 100                                                         |              58              |            88             |         2         |                              Long term secondary oxygen sensor trim, A: bank 2, B: bank 4                              |
|              59              |            89             |          2          |                                                            Fuel rail absolute pressure                                                            |              0               |          655,350          |        kPa        |                                                   10 ( 256 ğ´ + ğµ )                                                   |
|              5A              |            90             |          1          |                                                        Relative accelerator pedal position                                                        |              0               |            100            |         %         |                                                       100 255 ğ´                                                       |
|              5B              |            91             |          1          |                                                        Hybrid battery pack remaining life                                                         |              0               |            100            |         %         |                                                       100 255 ğ´                                                       |
|              5C              |            92             |          1          |                                                              Engine oil temperature                                                               |             -40              |            210            |        Â°C         |                                                        ğ´ âˆ’ 40                                                         |
|              5D              |            93             |          2          |                                                               Fuel injection timing                                                               |           -210.00            |          301.992          |         Â°         |                                                 256 ğ´ + ğµ 128 âˆ’ 210                                                  |
|              5E              |            94             |          2          |                                                                 Engine fuel rate                                                                  |              0               |          3212.75          |        L/h        |                                                     256 ğ´ + ğµ 20                                                     |
|              5F              |            95             |          1          |                                                Emission requirements to which vehicle is designed                                                 |                              |                           |                   |                                                      Bit Encoded                                                       |
|              60              |            96             |          4          |                                                            PIDs supported [$61 - $80]                                                             |                              |                           |                   |                                  Bit encoded [A7..D0] == [PID $61..PID $80] See below                                  |
|              61              |            97             |          1          |                                                      Driver's demand engine - percent torque                                                      |             -125             |            130            |         %         |                                                        ğ´ âˆ’ 125                                                        |
|              62              |            98             |          1          |                                                          Actual engine - percent torque                                                           |             -125             |            130            |         %         |                                                        ğ´ âˆ’ 125                                                        |
|              63              |            99             |          2          |                                                              Engine reference torque                                                              |              0               |          65,535           |        Nâ‹…m        |                                                      256 ğ´ + ğµ                                                       |
|              64              |            100            |          5          |                                                            Engine percent torque data                                                             |             -125             |            130            |         %         | ğ´ âˆ’ 125  Idle  ğµ âˆ’ 125  Engine point 1  ğ¶ âˆ’ 125  Engine point 2  ğ· âˆ’ 125  Engine point 3  ğ¸ âˆ’ 125  Engine point 4 |
|              65              |            101            |          2          |                                                        Auxiliary input / output supported                                                         |                              |                           |                   |                                                      Bit Encoded                                                       |
|              66              |            102            |          5          |                                                               Mass air flow sensor                                                                |              0               |        2047.96875         |        g/s        |         [A0]== Sensor A Supported [A1]== Sensor B Supported Sensor A: 256 ğµ + ğ¶ 32  Sensor B: 256 ğ· + ğ¸ 32         |
|              67              |            103            |          3          |                                                            Engine coolant temperature                                                             |             -40              |            215            |        Â°C         |                [A0]== Sensor 1 Supported [A1]== Sensor 2 Supported Sensor 1: ğµ âˆ’ 40  Sensor 2: ğ¶ âˆ’ 40                |
|              68              |            104            |          3          |                                                           Intake air temperature sensor                                                           |             -40              |            215            |        Â°C         |                [A0]== Sensor 1 Supported [A1]== Sensor 2 Supported Sensor 1: ğµ âˆ’ 40  Sensor 2: ğ¶ âˆ’ 40                |
|              69              |            105            |          7          |                                                     Actual EGR, Commanded EGR, and EGR Error                                                      |                              |                           |                   |                                                                                                                        |
|              6A              |            106            |          5          |                                  Commanded Diesel intake air flow control and relative intake air flow position                                   |                              |                           |                   |                                                                                                                        |
|              6B              |            107            |          5          |                                                       Exhaust gas recirculation temperature                                                       |                              |                           |                   |                                                                                                                        |
|              6C              |            108            |          5          |                                        Commanded throttle actuator control and relative throttle position                                         |                              |                           |                   |                                                                                                                        |
|              6D              |            109            |         11          |                                                           Fuel pressure control system                                                            |                              |                           |                   |                                                                                                                        |
|              6E              |            110            |          9          |                                                         Injection pressure control system                                                         |                              |                           |                   |                                                                                                                        |
|              6F              |            111            |          3          |                                                      Turbocharger compressor inlet pressure                                                       |                              |                           |                   |                                                                                                                        |
|              70              |            112            |         10          |                                                              Boost pressure control                                                               |                              |                           |                   |                                                                                                                        |
|              71              |            113            |          6          |                                                       Variable Geometry turbo (VGT) control                                                       |                              |                           |                   |                                                                                                                        |
|              72              |            114            |          5          |                                                                 Wastegate control                                                                 |                              |                           |                   |                                                                                                                        |
|              73              |            115            |          5          |                                                                 Exhaust pressure                                                                  |                              |                           |                   |                                                                                                                        |
|              74              |            116            |          5          |                                                                 Turbocharger RPM                                                                  |                              |                           |                   |                                                                                                                        |
|              75              |            117            |          7          |                                                             Turbocharger temperature                                                              |                              |                           |                   |                                                                                                                        |
|              76              |            118            |          7          |                                                             Turbocharger temperature                                                              |                              |                           |                   |                                                                                                                        |
|              77              |            119            |          5          |                                                       Charge air cooler temperature (CACT)                                                        |                              |                           |                   |                                                                                                                        |
|              78              |            120            |          9          |                                                       Exhaust Gas temperature (EGT) Bank 1                                                        |                              |                           |                   |                                                 Special PID. See below                                                 |
|              79              |            121            |          9          |                                                       Exhaust Gas temperature (EGT) Bank 2                                                        |                              |                           |                   |                                                 Special PID. See below                                                 |
|              7A              |            122            |          7          |                                              Diesel particulate filter (DPF)  differential pressure                                               |                              |                           |                   |                                                                                                                        |
|              7B              |            123            |          7          |                                                          Diesel particulate filter (DPF)                                                          |                              |                           |                   |                                                                                                                        |
|              7C              |            124            |          9          |                                                    Diesel Particulate filter (DPF) temperature                                                    |                              |                           |        Â°C         |                                                  256 ğ´ + ğµ 10 âˆ’ 40                                                   |
|              7D              |            125            |          1          |                                                    NOx NTE (Not-To-Exceed) control area status                                                    |                              |                           |                   |                                                                                                                        |
|              7E              |            126            |          1          |                                                    PM NTE (Not-To-Exceed) control area status                                                     |                              |                           |                   |                                                                                                                        |
|              7F              |            127            |         13          |                                                                Engine run time [b]                                                                |                              |                           |         s         |                                                                                                                        |
|              80              |            128            |          4          |                                                            PIDs supported [$81 - $A0]                                                             |                              |                           |                   |                                  Bit encoded [A7..D0] == [PID $81..PID $A0] See below                                  |
|              81              |            129            |         41          |                                           Engine run time for Auxiliary Emissions Control Device(AECD)                                            |                              |                           |                   |                                                                                                                        |
|              82              |            130            |         41          |                                           Engine run time for Auxiliary Emissions Control Device(AECD)                                            |                              |                           |                   |                                                                                                                        |
|              83              |            131            |          9          |                                                                    NOx sensor                                                                     |                              |                           |                   |                                                                                                                        |
|              84              |            132            |          1          |                                                           Manifold surface temperature                                                            |                              |                           |                   |                                                                                                                        |
|              85              |            133            |         10          |                                                                NOx reagent system                                                                 |                              |                           |                   |                                                                                                                        |
|              86              |            134            |          5          |                                                          Particulate matter (PM) sensor                                                           |                              |                           |                   |                                                                                                                        |
|              87              |            135            |          5          |                                                         Intake manifold absolute pressure                                                         |                              |                           |                   |                                                                                                                        |
|              88              |            136            |         13          |                                                                 SCR Induce System                                                                 |                              |                           |                   |                                                                                                                        |
|              89              |            137            |         41          |                                                             Run Time for AECD #11-#15                                                             |                              |                           |                   |                                                                                                                        |
|              8A              |            138            |         41          |                                                             Run Time for AECD #16-#20                                                             |                              |                           |                   |                                                                                                                        |
|              8B              |            139            |          7          |                                                               Diesel Aftertreatment                                                               |                              |                           |                   |                                                                                                                        |
|              8C              |            140            |         17          |                                                              O2 Sensor (Wide Range)                                                               |                              |                           |                   |                                                                                                                        |
|              8D              |            141            |          1          |                                                                Throttle Position G                                                                |              0               |            100            |         %         |                                                                                                                        |
|              8E              |            142            |          1          |                                                         Engine Friction - Percent Torque                                                          |             -125             |            130            |         %         |                                                        ğ´ âˆ’ 125                                                        |
|              8F              |            143            |          7          |                                                               PM Sensor Bank 1 & 2                                                                |                              |                           |                   |                                                                                                                        |
|              90              |            144            |          3          |                                                      WWH-OBD Vehicle OBD System Information                                                       |                              |                           |         h         |                                                                                                                        |
|              91              |            145            |          5          |                                                      WWH-OBD Vehicle OBD System Information                                                       |                              |                           |         h         |                                                                                                                        |
|              92              |            146            |          2          |                                                                Fuel System Control                                                                |                              |                           |                   |                                                                                                                        |
|              93              |            147            |          3          |                                                       WWH-OBD Vehicle OBD Counters support                                                        |                              |                           |         h         |                                                                                                                        |
|              94              |            148            |         12          |                                                         NOx Warning And Inducement System                                                         |                              |                           |                   |                                                                                                                        |
|              98              |            152            |          9          |                                                          Exhaust Gas Temperature Sensor                                                           |                              |                           |                   |                                                                                                                        |
|              99              |            153            |          9          |                                                          Exhaust Gas Temperature Sensor                                                           |                              |                           |                   |                                                                                                                        |
|              9A              |            154            |          6          |                                                  Hybrid/EV Vehicle System Data, Battery, Voltage                                                  |                              |                           |                   |                                                                                                                        |
|              9B              |            155            |          4          |                                                         Diesel Exhaust Fluid Sensor Data                                                          |                              |                           |                   |                                                                                                                        |
|              9C              |            156            |         17          |                                                                  O2 Sensor Data                                                                   |                              |                           |                   |                                                                                                                        |
|              9D              |            157            |          4          |                                                                 Engine Fuel Rate                                                                  |                              |                           |        g/s        |                                                                                                                        |
|              9E              |            158            |          2          |                                                             Engine Exhaust Flow Rate                                                              |                              |                           |       kg/h        |                                                                                                                        |
|              9F              |            159            |          9          |                                                            Fuel System Percentage Use                                                             |                              |                           |                   |                                                                                                                        |
|              A0              |            160            |          4          |                                                            PIDs supported [$A1 - $C0]                                                             |                              |                           |                   |                                  Bit encoded [A7..D0] == [PID $A1..PID $C0] See below                                  |
|              A1              |            161            |          9          |                                                             NOx Sensor Corrected Data                                                             |                              |                           |        ppm        |                                                                                                                        |
|              A2              |            162            |          2          |                                                                Cylinder Fuel Rate                                                                 |              0               |        2047.96875         |     mg/stroke     |                                                     256 ğ´ + ğµ 32                                                     |
|              A3              |            163            |          9          |                                                            Evap System Vapor Pressure                                                             |                              |                           |        Pa         |                                                                                                                        |
|              A4              |            164            |          4          |                                                             Transmission Actual Gear                                                              |              0               |          65.535           |       ratio       |                                           [A1]==Supported  256 ğ¶ + ğ· 1000                                            |
|              A5              |            165            |          4          |                                                       Commanded Diesel Exhaust Fluid Dosing                                                       |              0               |           127.5           |         %         |                                         [A0]= 1:Supported; 0:Unsupported  ğµ 2                                         |
|              A6              |            166            |          4          |                                                                   Odometer [c]                                                                    |              0               |       429,496,729.5       |        km         |                                     ğ´ ( 2 24 ) + ğµ ( 2 16 ) + ğ¶ ( 2 8 ) + ğ· 10                                     |
|              A7              |            167            |          4          |                                                     NOx Sensor Concentration Sensors 3 and 4                                                      |                              |                           |                   |                                                                                                                        |
|              A8              |            168            |          4          |                                                NOx Sensor Corrected Concentration Sensors 3 and 4                                                 |                              |                           |                   |                                                                                                                        |
|              A9              |            169            |          4          |                                                             ABS Disable Switch State                                                              |                              |                           |                   |                                   [A0]= 1:Supported; 0:Unsupported  [B0]= 1:Yes;0:No                                   |
|              C0              |            192            |          4          |                                                            PIDs supported [$C1 - $E0]                                                             |                              |                           |                   |                                  Bit encoded [A7..D0] == [PID $C1..PID $E0] See below                                  |
|              C3              |            195            |          ?          |                                                                         ?                                                                         |              ?               |             ?             |         ?         |                         Returns numerous data, including Drive Condition ID and Engine Speed*                          |
|              C4              |            196            |          ?          |                                                                         ?                                                                         |              ?               |             ?             |         ?         |                                  B5 is Engine Idle Request B6 is Engine Stop Request*                                  |

In the formula column, letters A, B, C, etc. represent the first, second, third, etc. byte of the data. For example, for two data bytes 0F 19, A = 0F and B = 19. Where a (?) appears, contradictory or incomplete information was available.
## head unit æŠ¬å¤´æ˜¾ç¤ºå™¨



## Adapter / PC-to-OBD interface (USB/è“ç‰™/wifi ä¸²å£é€‚é…å™¨)

The ELM327 is a programmed microcontroller produced for translating the on-board diagnostics (OBD) interface found in most modern cars. The ELM327 command protocol is one of the most popular PC-to-OBD interface standards and is also implemented by other vendors.

The original ELM327 was implemented on the PIC18F2480 microcontroller from Microchip Technology.


Why is so important to buy a good adapter? Isnâ€™t it just a simple transmitter?

In fact, ELM327 based adapter is not just a transmitter. Itâ€™s a â€œsmall computerâ€ that actually handles all communication with the car.

Itâ€™s not the software that actually connects to your carâ€™s ECU, itâ€™s ELM327 chip. It can handle about 10 base protocols variations and interprets information from this protocols to a single one.

So, if you have a bad â€œinterpreterâ€, your software (Car Scanner) and your car ECU wouldnâ€™t understand each other. But if you have a good â€œinterpreterâ€, they would have a very interesting conversation and you would get all the information you need.

### ELM327
> ELM327åŸç‰ˆé‡‡ç”¨PIC18F2480èŠ¯ç‰‡æ–¹æ¡ˆï¼Œæˆæœ¬æ¯”è¾ƒé«˜ã€‚å¦‚æœç”¨PIC18F25K80åšï¼Œæˆæœ¬å¯ä»¥é™ä½ä¸å°‘ï¼Œå¹¶ä¸”25K80èµ„æºè¦æ¯”2480è¦å¥½å¾ˆå¤šï¼ŒèŠ¯ç‰‡ä¸ä¸Šä½æœºé€šè®¯æ˜¯UARTè¿æ¥ï¼Œåœ¨æ­¤åŸºç¡€ä¸Šå¯ä»¥è½¬æ¢æˆå¤šç§è¿æ¥æ–¹å¼ï¼Œå¦‚ä¸²å£è½¬USBã€ä¸²å£è½¬è“ç‰™ã€ä¸²å£è½¬WIFIç­‰ï¼Œå¯ä»¥ç”¨çš„ä¸Šä½æœºè½¯ä»¶æœ‰PCç‰ˆçš„ï¼Œä¹Ÿæœ‰æ‰‹æœºç‰ˆçš„ï¼Œå¸‚åœºå¹¿é˜”ï¼Œé”€é‡å¤§åˆ©æ¶¦é«˜ã€‚
> å®ç°æ–¹æ³•
> æ–¹æ¡ˆå…·ä½“å·¥ä½œå°±æ˜¯æŠŠä»£ç ä»PIC18F2480ç§»æ¤åˆ°PIC18F25K80ï¼Œç»è¿‡åˆ†æDatasheetï¼Œå‘ç°è¿™ä¸¤é¢—ICå±äºåŒä¸€ç³»åˆ—ã€åœ¨å¼•è„šåŠŸèƒ½ã€å†…éƒ¨èµ„æºã€ROMå¤§å°ã€EEPROMå¤§å°ã€A/Dä½æ•°éƒ½å·®åˆ«ä¸å¤§ï¼Œè¿™å°±æ»¡è¶³äº†è½¬ç çš„æœ€åŸºæœ¬è¦æ±‚ï¼Œé¦–å…ˆåç¼–è¯‘2480ï¼Œå†ç”¨25K80ç¼–è¯‘ï¼Œä¸€æ¬¡å°±å…¨éƒ¨é€šè¿‡ï¼Œå¾ˆå¥½ï¼Œä½†ä¸ä»£è¡¨å°±å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œå› ä¸ºä»èµ„æ–™ä¸Šçœ‹ï¼Œ25K80çš„å¯„å­˜å™¨ä½ç½®ã€æœ‰äº›ä½æ ‡ç½®ã€æœ‰äº›å¯„å­˜å™¨é…ç½®æ–¹æ³•ä¸ä¸€æ ·ï¼Œæˆ‘ä»¬é€‰å®š2480æ¥åç¼–è¯‘åˆšå¾—åˆ°çš„25K80ä»£ç ï¼Œå¾—åˆ°çš„ASMå†ä¸åŸ2480çš„ASMå¯¹æ¯”ï¼Œå‘ç°æœ‰å‡ åè¡Œä»£ç ä¸ä¸€æ ·ï¼Œè¿™è¯´æ˜è¿™é‡Œé¢æ‰€æ¶‰åŠåˆ°çš„å¯„å­˜å™¨åœ¨ä¸¤ä¸ªICä¸­å¤„äºä¸åŒä½ï¼Œæˆ‘ä»¬é‡ç‚¹æ ¸å¯¹è¿™äº›å¯„å­˜å™¨åœ¨ä¸¤ä¸ªICä¸­çš„åŠŸèƒ½ï¼Œå¦‚æœä¸€è‡´ï¼Œå°±ä¸ç”¨æ›´æ”¹ï¼Œä¸ä¸€è‡´å°±è¦äººå·¥ä¿®æ­£ã€‚è¿™ä¸ªäº§å“ç”¨åˆ°äº†ADCå’ŒCANï¼ŒåŸ2480æ˜¯10ä½ï¼Œè€Œ25K80æ˜¯12ä½ï¼Œé…ç½®æ–¹æ³•ä¹Ÿä¸åŒï¼Œæˆ‘ä»¬äººå·¥ä¿®æ­£é…ç½®æ–¹æ³•ï¼Œå†æŠŠé‡‡æ ·ç»“æœä»12ä½ä¿®æ”¹æˆ10ä½çš„ï¼Œæ–°åŠ å…¥çš„ä»£ç æ”¾åœ¨äº†ç©ºç™½çš„åœ°æ–¹ï¼Œç»è¿‡ä¸Šæœºæµ‹è¯•ï¼ŒåŠŸèƒ½å®Œå…¨OKã€‚ä¾æ‰˜æˆ‘ä»¬å¼ºå¤§çš„åç¼–è¯‘æŠ€æœ¯ï¼Œé¡¹ç›®å¾—åˆ°é¡ºåˆ©å®Œæˆã€‚
> https://blog.csdn.net/xqhrs232/article/details/84939286

### ELM327 USB
ELM327 USBçš„ä¸¤å¤§ä¸»è¦èŠ¯ç‰‡ã€‚

ç¬¬ä¸€ä¸ªæ˜¯ä¸»æ§èŠ¯ç‰‡ï¼šä¸»è¦è´Ÿè´£å¯¹ODBæ¥å£ä¼ è¾“åè®®çš„ç¿»è¯‘è½¬æ¢ï¼Œç®€å•æ¥è¯´å°±æ˜¯é™PCä¼ è¿‡æ¥çš„æŒ‡ä»¤ï¼Œè½¬æ¢æˆç”µè®¯å·å‘åˆ°HS,MSæ€»çº¿ä¸Šçš„æ¨¡å—

ç¬¬äºŒä¸ªæ˜¯RS232èŠ¯ç‰‡:ä¸»è¦ä½œç”¨å°±æ˜¯å°†usbçº¿ä¸Šæ”¶åˆ°çš„PCæŒ‡ä»¤ä¼ ç»™ä¸»æ§èŠ¯ç‰‡ã€‚

è½¦å‹ä¼šå’Œåšå¤–è´¸çš„æœ‹å‹éƒ½ä¼šç•™æ„ELM327 USBç³»åˆ—çš„ä¸¤ä¸ªICï¼Œä¸€ä¸ªæ˜¯Main Control

Chipï¼Œé¡¾åæ€ä¹‰ä¸»æ§ICï¼Œå¦ä¸€ä¸ªæ˜¯USB Drive Chipï¼ŒUSBé©±åŠ¨ICï¼Œä»¥ä¸‹æ˜¯æˆ‘ä»¬å‚å¸¸åšçš„å‡ ç§æ¬¾å¼ï¼š

Main Control Chipï¼š PIC18F2580 ï¼ PIC18F2480 ï¼PIC18F25K80 ï¼ˆæœ€ä¾¿å®œï¼‰ USB Drive Chip: FT232BL /FT 232RL

ï¼ˆFT232BLè¾ƒè´µï¼‰ æ··æ­æ¨¡å¼ï¼šICå„é€‰ä¸€ç§ï¼Œä»·æ ¼ä¸ä¼šç›¸åŒçš„

éFT232RLèŠ¯ç‰‡ï¼Œæˆ‘ä»¬å«ELM327 USB with CP2102ï¼ˆè¿™ç§æœ€ä¾¿å®œï¼‰

> ç›®å‰æ­£å“ELM327ä½¿ç”¨çš„æ˜¯FT232çš„èŠ¯ç‰‡ã€‚å›½å†…å±±å¯¨å‚å•†ç”¨CP2102æ¯”è¾ƒå¤šï¼Œç›®å‰ä¹Ÿæœ‰å¾ˆå¤šå¼€å§‹ä½¿ç”¨FT232èŠ¯ç‰‡çš„å±±å¯¨ELMå‡ºç°äº†ã€‚ä¸è¿‡æœ‰äº›ä½¿ç”¨FT232èŠ¯ç‰‡çš„å±±å¯¨ELMä¼šæœ‰è·ŸFoCCCus è½¯ä»¶ä¸å…¼å®¹ï¼Œä¸èƒ½è¾¨è®¤ELMçš„æƒ…å†µã€‚FT232èŠ¯ç‰‡æ¯”CP2102æœ‰ä¸€ä¸ªå¥½å¤„ï¼Œå¯ä»¥è®¾ç½®ä¼ è¾“çš„timeoutæ—¶é—´ï¼Œè€ŒCP2102æ˜¯åšä¸åˆ°çš„ã€‚ è¿™ä¸ªtimeoutå€¼å¾—æœ€å¤§ä½œç”¨å°±æ˜¯ï¼Œä¸»æ§èŠ¯ç‰‡è½¬æ¢ä¿¡å·æ—¶å¦‚æœå¤„ç†çš„æ¯”è¾ƒæ…¢ï¼Œå°±å¯èƒ½ä¼šæ‰˜æ›´é•¿çš„æ—¶é—´æ‰ä¼šç»™PCè¿”å›æŒ‡ä»¤ç»“æœã€‚è€Œè¿™ä¸ªtimeoutå°±æ˜¯ç­‰å¾…çš„æ—¶é—´ï¼Œå¦‚æœåœ¨è¿™æ®µç­‰å¾…æ—¶é—´å†…æ²¡æœ‰æ”¶åˆ°ç»“æœï¼Œå°±ä¼šæ”¾å¼ƒç­‰å¾…ï¼Œè½¯ä»¶ä¹Ÿä¼šè®¤ä¸ºå‘ç”Ÿäº†é”™è¯¯ï¼Œæˆ–è€…æŒ‡ä»¤æ²¡æœ‰å“åº”ã€‚æ‰€ä»¥åˆ·å›ºä»¶å¤±è´¥çš„åŒå­¦åœ¨ä¿®æ”¹äº†timeoutæ—¶é—´ä¹‹åï¼ŒELM327çš„ç¨³å®šæ€§å¢å¼ºäº†ï¼Œè¯´åˆ°åº•è¿˜æ˜¯å±±å¯¨çš„ELMå¤„ç†é€Ÿåº¦å¤ªæ…¢äº†ã€‚
> https://a.xcar.com.cn/bbs/thread-20413239-0.html

æœ€ä½ç«¯ï¼šPL2303HXçš„USB-RS232èŠ¯ç‰‡ åŠ ä¸Š RS232-OBD IIåè®®çš„25K80èŠ¯ç‰‡
æ¬¡ä½ç«¯ï¼šCP2012(CP201X)çš„USB-RS232èŠ¯ç‰‡ åŠ ä¸Š RS232-OBD IIåè®®çš„25K80èŠ¯ç‰‡
ä¸­ç«¯ï¼šCH340çš„USB-RS232èŠ¯ç‰‡ åŠ ä¸Š RS232-OBD IIåè®®çš„25K80èŠ¯ç‰‡
ä¸­é«˜ç«¯ï¼šè¿›å£åŸè£…FTDI FT232RLçš„USB-RS232èŠ¯ç‰‡ åŠ ä¸Š RS232-OBD IIåè®®çš„2480èŠ¯ç‰‡
é«˜ç«¯ï¼šè¿›å£åŸè£…çš„FTDI FT232RLçš„USB-RS232èŠ¯ç‰‡ åŠ ä¸Š RS232-OBD II ELM327æ­£ç‰ˆèŠ¯ç‰‡ï¼ˆè¿™ä¸ªå°±æ˜¯å¸¸è§çš„320å…ƒå·¦å³çš„ELS27çº¿äº†ï¼‰

### ELM327è“ç‰™OBDå’ŒQBD66è“ç‰™OBD

CSRèŠ¯ç‰‡ VS å›½äº§èŠ¯ç‰‡

ELM327æ˜¯æ—©å¹´åŠ æ‹¿å¤§å…¬å¸å¼€å‘çš„ä¸€ç§OBDåè®®èŠ¯ç‰‡ã€‚å¸‚é¢ä¸ŠåæœŸå¾ˆå¤šAPPï¼Œè½¯ä»¶ï¼Œç¡¬ä»¶å·¥å…·éƒ½é‡‡ç”¨327çš„æ ¼å¼æŒ‡ä»¤ã€‚æ‰€ä»¥åç»­åŸºäºELM327æŒ‡ä»¤å¼€å‘OBDè“ç‰™å°±å«ELM327è“ç‰™ã€‚èŠ¯æ–¹æ¡ˆçš„QBD61 QBD327å®Œå…¨å…¼å®¹ELM327æ‰€æœ‰æŒ‡ä»¤ QBD61æ›´æ˜¯ç¡¬ä»¶å¯ä»¥å®Œå…¨å…¼å®¹ã€‚ QBD327ä»·æ ¼è¶…çº§ä½å»‰ã€‚

QBD66æ˜¯æ·±åœ³èŠ¯æ–¹æ¡ˆè‡ªè¡Œå¼€å‘çš„ä¸€æ¬¾è¿›é˜¶OBDåè®®èŠ¯ç‰‡ã€‚

ELM327 è“ç‰™æ˜¯ä¸€æ¬¾æ‰‹åŠ¨ï¼Œ ä½æˆæœ¬ å“è´¨ä½ï¼Œé‡å¤§çš„ä½ç«¯OBDè“ç‰™äº§å“ã€‚å¼€å‘ä½¿ç”¨è€…éœ€è¦ç†Ÿæ‚‰OBDåŸå§‹æŒ‡ä»¤ï¼ŒåŠæ·±åšçš„ç›¸å…³ä¸“ä¸šç»éªŒçŸ¥è¯†ã€‚ä¸”ELM327åœ¨æ— çº¿é€šè®¯ä¸‹å®¹æ˜“æ–­çº¿ï¼Œé€ æˆå¼€å‘åº”ç”¨åœºæ™¯å—é™ï¼Œè¡Œç¨‹æ•°æ®ç»Ÿè®¡ä¸¢å¤±ä¸å¤Ÿç²¾ç¡®ã€‚ QBD66 è“ç‰™å°±æ˜¯é«˜çº§å…¨è‡ªåŠ¨ç‰ˆæœ¬ï¼Œé«˜æ€§ä»·æ¯”ï¼Œé«˜å¯é æ€§ã€‚ä¸”QBD66è‡ªå¸¦OBDé€»è¾‘ï¼Œå®Œæˆäº†327å¾ˆå¤šä¸Šä½æœºçš„åŠŸèƒ½ï¼Œç›¸æ¯”ELM327å¤šäº†ä¸€å±‚å°åŒ…ï¼Œæ›´é€‚åˆå¼€å‘è€…å®šåˆ¶ï¼Œå¤§å¤§æ–¹ä¾¿ç®€åŒ–å¼€å‘å‘¨æœŸï¼Œæä¾›é«˜å¯é çš„ç¡¬ä»¶å›ºåŒ–è§£å†³æ–¹æ¡ˆã€‚ä¸”QDB66å›ºä»¶å¯ä»¥è‡ªå¸¦OTAå‡çº§ï¼Œå¯ä»¥æ‹“å±•æ›´å¤šåº”ç”¨ã€‚
https://www.eechina.com/thread-568843-1-1.html

### Android client
+ Torque Pro (OBD 2 & Car)
+ (æ¨è) [å¼€æº AndrOBD](https://github.com/lyhistory/tools_car_AndrOBD)
  å®‰è£…æ–¹æ³•ï¼š
  - installation via [F-Droid](https://f-droid.org/)
  - è‡ªè¡Œç¼–è¯‘apk
  
### OBD2 ELM Adapter command - AT-attention commands

```
AT Z [reset all]
Reset adapter settings to factory state

AT L1-0
Enable / Disable line feed characters æ¢è¡Œ

AT E1-0
Echo on â€“ off

AT H1-0
Headers on â€“ off

AT AT0-1-2
Adaptive Timing Off â€” adaptive Timing Auto1 â€” adaptive Timing Auto2

AT ST FF
Set the timeout to max value.

AT D [set all to Default]
Reset settings to the original user-configured state.

AT DP [Describe the current Protocol]
The scanner is able to independently determine the vehicle protocol to which it is connected.

AT IB10 [set the ISO Baud rate to 10400]
The command sets the baud rate for ISO 9141-2 and
ISO 14230-4 10400

AT IB96 [ set the ISO Baud rate to 9600]
The command sets the baud rate for ISO 9141-2 and
ISO 14230-4 9600 for protocols 3,4,5.

AT SP h [ Set Protocol h]
Protocol selection command h, where h is:
0 â€“ Automatic;
1 â€” SAE J1850 PWM (41.6 Kbaud);
2 â€” SAE J1850 VPW (10.4 Kbaud);
3 â€” ISO 9141-2 (5 baud init, 10.4 Kbaud);
4 â€” ISO 14230-4 KWP (5 baud init, 10.4 Kbaud);
5 â€” ISO 14230-4 KWP (fast init, 10.4 Kbaud);
6 â€” ISO 15765-4 CAN (11 bit ID, 500 Kbaud);
7 â€” ISO 15765-4 CAN (29 bit ID, 500 Kbaud);
8 â€” ISO 15765-4 CAN (11 bit ID, 250 Kbaud);
9 â€” ISO 15765-4 CAN (29 bit ID, 250 Kbaud);
AT SP Ah [Set Protocol h with Auto]
```
[ELM327_AT_Commands](https://www.sparkfun.com/datasheets/Widgets/ELM327_AT_Commands.pdf)

## æµ‹è¯•ï¼šåŸºæœ¬æ•°æ®è¯»å– odb2 bluetooth adapter + raspberry pi(usb tethering to android phone)
notice that the Bluetooth light comes on even though the car is off this is, because the obd2 port has an always-on 12 volt power supply which means that the Bluetooth adapter is always going to be on.

```
$ bluetoothctl
[bluetooth] # power on
[bluetooth] # pairable on
[bluetooth] # agent on
[bluetooth] # default-agent
[bluetooth] # scan on
//find Device <MAC ADDRESS> Name: OBDII
[bluetooth] # scan off
[bluetooth] # pair <MAC ADDRESS>
// default pin code: 1234 or 0000
[bluetooth] # trust <MAC ADDRESS>
[bluetooth] # quit

$ sudo rfcomm bind rfcomm0 <MAC ADDRESS>
$ cat /dev/rfcomm0
$ sudo apt-get install screen
$ screen /dev/rfcomm0
>atz #resets the device and return the id
>atl1 #enables line feeds
>ath1 #sets display headers
>atsp<n> #how we want to communicate with the port(n is 0-9, set desired commnunication protocol, if not sure, atsp0 will auto search)
><Command HEX Value: Mode|PID>
01 (mode: current data) 0D (vehicle speed)
01 (mode: current data) 2F(Fuel Tank Level Input)
>
```

å¤šä¸ª ECU
Received frames from vehicles with multiple ECU chips https://mechanics.stackexchange.com/questions/22982/received-frames-from-vehicles-with-multiple-ecu-chips

## æµ‹è¯•ï¼šç‰©ä½“æ£€æµ‹ã€å±å¹•å±•ç¤º
[Make A Smart Car Digital Display - DIY Smart Car (Part 4)](https://www.youtube.com/watch?v=VCU81PfSlcI)
[Simple Car Object Detection - DIY Smart Car (Part 2)](https://www.youtube.com/watch?v=FH015Pzys-8)

refer:

ELM327 hacking https://area515.org/elm327-hacking/
å½“å¿ƒâ€œå±±å¯¨â€ç‰ˆæœ¬çš„ELM327 OBD-IIè“ç‰™é€‚é…å™¨ https://cnx-software.cn/2022/09/01/elm327-obd-ii-bluetooth-adapters/

(Car Diagnostics With A Raspberry PI - DIY Smart Car (Part 3))[https://www.youtube.com/watch?v=DABytIdutKk]

## software development
https://www.sdd-technology.com/blog/obd2-reader-car-diagnostics
https://github.com/MacFJA/OBD2


REF:

[DIFFERENCES BETWEEN ELM327 SCANNER FIRMWARE VERSION 1.5 AND 2.1](https://elm327scantool.wordpress.com/2018/11/03/differences-between-elm327-firmware-version-1-5-and-2-1/)

[How to choose odp adapter](https://www.carscanner.info/choosing-obdii-adapter/)

KWP OBD2 ECU Target Address https://mechanics.stackexchange.com/questions/83343/kwp-obd2-ecu-target-address

https://www.linkedin.com/pulse/electronic-control-unit-ecu-vijay-tharad

https://zhuanlan.zhihu.com/p/35973304