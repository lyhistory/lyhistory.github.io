(window.webpackJsonp=window.webpackJsonp||[]).push([[203],{654:function(s,e,t){"use strict";t.r(e);var a=t(65),o=Object(a.a)({},(function(){var s=this,e=s.$createElement,t=s._self._c||e;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p",[s._v("user file-creation mode mask ("),t("em",[s._v("umask")]),s._v(")")]),s._v(" "),t("p",[s._v("https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/configuring_basic_system_settings/assembly_managing-file-permissions_configuring-basic-system-settings#user-file-creation-mode-mask_assembly_managing-file-permissions")]),s._v(" "),t("h2",{attrs:{id:"firewall"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#firewall"}},[s._v("#")]),s._v(" firewall")]),s._v(" "),t("p",[s._v("define your own service name in /usr/lib/firewalld/services/")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("firewall-cmd --get-services\nfirewall-cmd --permanent --zone=public --add-service=postgresql\nfirewall-cmd --reload\n")])])]),t("h2",{attrs:{id:"selinux"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#selinux"}},[s._v("#")]),s._v(" selinux")]),s._v(" "),t("p",[s._v("chcon 会被重新标记")]),s._v(" "),t("p",[s._v("使用semanage\ngetenforce")]),s._v(" "),t("h2",{attrs:{id:"linux-pam"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#linux-pam"}},[s._v("#")]),s._v(" Linux-PAM")]),s._v(" "),t("p",[s._v("Linux-PAM (short for Pluggable Authentication Modules which evolved from the Unix-PAM architecture) is a powerful suite of shared libraries used to dynamically authenticate a user to applications (or services) in a Linux system.")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("/etc/pam.d/crond\n/etc/cron.allow \n")])])]),t("h2",{attrs:{id:"example"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#example"}},[s._v("#")]),s._v(" example")]),s._v(" "),t("h3",{attrs:{id:"troubleshoot-passwordless-ssh-login"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#troubleshoot-passwordless-ssh-login"}},[s._v("#")]),s._v(" troubleshoot passwordless ssh login")]),s._v(" "),t("p",[s._v("Machine A need to access B using pub key instead of password")]),s._v(" "),t("ol",[t("li",[s._v("Setup")])]),s._v(" "),t("p",[s._v("on A:\nssh-keygen -t rsa 重命名生成id_rsa_B/id_rsa_B.pub\nssh-copy-id -i .ssh/id_rsa_B.pub root@B\nssh root@B still prompt password require, 仍然弹出密码要求")]),s._v(" "),t("ol",{attrs:{start:"2"}},[t("li",[s._v("Troubleshoot:")])]),s._v(" "),t("ul",[t("li",[s._v("selinux")]),s._v(" "),t("li",[s._v("make sure correct permission for .ssh(700 at least) and .ssh/authorized_keys (400 at least)\nBoth the host and the client should have the following permissions and owners:")])]),s._v(" "),t("p",[s._v("~/.ssh permissions should be 700\n~/.ssh should be owned by your account\n~/.ssh/authorized_keys permissions should be 600\n~/.ssh/authorized_keys should be owned by your account\nClient environments should additionally have the following permissions and owners:")]),s._v(" "),t("p",[s._v("~/.ssh/config permissions should be 600\n~/.ssh/id_* permissions should be 600")]),s._v(" "),t("ul",[t("li",[s._v("remote server firewall")]),s._v(" "),t("li",[s._v("/etc/ssh/sshd_config\nPubkeyAuthentication yes\nRSAAuthentication yes")])]),s._v(" "),t("p",[s._v("[root@os-node3 apps]# tail -f /var/log/secure\nApr 26 13:58:29 os-node3 su: pam_unix(su-l:session): session opened for user fundingrate by root(uid=0)\nApr 26 13:58:59 os-node3 sshd[31048]: reprocess config line 44: Deprecated option RSAAuthentication\nsystemctl status sshd 也可以看到这个日志")]),s._v(" "),t("p",[s._v("有意思，之前我手动在 开启了\nRSAAuthentication yes\n日志的意思是，rsa的选项已经是废弃的了，难道ssh升级了？\n果然查了下，最新的ssh Protocol=2，之前的1可能不支持了，测试：\non A:\nssh -1 root@B\nProtocol major versions differ: 1 vs. 2\n说明B不支持 ssh Protocol 1了，only Protocol 2 is supported")]),s._v(" "),t("p",[s._v("不过最后发现原因竟然是因为我创建秘钥对的时候重命名了id_rsa/id_rsa.pub 为 id_rsa_B/id_rsa_B.pub\nssh默认只会找id_rsa（之前已经生成了一对id_rsa/id_rsa.pub），所以跟copy到B上的id_rsa_B.pub对不上，\n需要指定\nssh -i id_rsa_B root@B 即可！\n查看版本号：ssh -v localhost")])])}),[],!1,null,null,null);e.default=o.exports}}]);