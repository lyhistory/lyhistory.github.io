(window.webpackJsonp=window.webpackJsonp||[]).push([[158],{587:function(s,e,o){"use strict";o.r(e);var t=o(56),n=Object(t.a)({},(function(){var s=this,e=s.$createElement,o=s._self._c||e;return o("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[o("p",[s._v("user file-creation mode mask ("),o("em",[s._v("umask")]),s._v(")")]),s._v(" "),o("p",[s._v("https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/configuring_basic_system_settings/assembly_managing-file-permissions_configuring-basic-system-settings#user-file-creation-mode-mask_assembly_managing-file-permissions")]),s._v(" "),o("h2",{attrs:{id:"selinux"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#selinux"}},[s._v("#")]),s._v(" selinux")]),s._v(" "),o("p",[s._v("chcon 会被重新标记")]),s._v(" "),o("p",[s._v("使用semanage\ngetenforce")]),s._v(" "),o("h2",{attrs:{id:"etc-cron-allow"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#etc-cron-allow"}},[s._v("#")]),s._v(" /etc/cron.allow")]),s._v(" "),o("h2",{attrs:{id:"example"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#example"}},[s._v("#")]),s._v(" example")]),s._v(" "),o("h3",{attrs:{id:"troubleshoot-passwordless-ssh-login"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#troubleshoot-passwordless-ssh-login"}},[s._v("#")]),s._v(" troubleshoot passwordless ssh login")]),s._v(" "),o("p",[s._v("Machine A need to access B using pub key instead of password")]),s._v(" "),o("ol",[o("li",[s._v("Setup")])]),s._v(" "),o("p",[s._v("on A:\nssh-keygen -t rsa 重命名生成id_rsa_B/id_rsa_B.pub\nssh-copy-id -i .ssh/id_rsa_B.pub root@B\nssh root@B still prompt password require, 仍然弹出密码要求")]),s._v(" "),o("ol",{attrs:{start:"2"}},[o("li",[s._v("Troubleshoot:")])]),s._v(" "),o("ul",[o("li",[s._v("selinux")]),s._v(" "),o("li",[s._v("make sure correct permission for .ssh(700 at least) and .ssh/authorized_keys (400 at least)\nBoth the host and the client should have the following permissions and owners:")])]),s._v(" "),o("p",[s._v("~/.ssh permissions should be 700\n~/.ssh should be owned by your account\n~/.ssh/authorized_keys permissions should be 600\n~/.ssh/authorized_keys should be owned by your account\nClient environments should additionally have the following permissions and owners:")]),s._v(" "),o("p",[s._v("~/.ssh/config permissions should be 600\n~/.ssh/id_* permissions should be 600")]),s._v(" "),o("ul",[o("li",[s._v("remote server firewall")]),s._v(" "),o("li",[s._v("/etc/ssh/sshd_config\nPubkeyAuthentication yes\nRSAAuthentication yes")])]),s._v(" "),o("p",[s._v("[root@os-node3 apps]# tail -f /var/log/secure\nApr 26 13:58:29 os-node3 su: pam_unix(su-l:session): session opened for user fundingrate by root(uid=0)\nApr 26 13:58:59 os-node3 sshd[31048]: reprocess config line 44: Deprecated option RSAAuthentication\nsystemctl status sshd 也可以看到这个日志")]),s._v(" "),o("p",[s._v("有意思，之前我手动在 开启了\nRSAAuthentication yes\n日志的意思是，rsa的选项已经是废弃的了，难道ssh升级了？\n果然查了下，最新的ssh Protocol=2，之前的1可能不支持了，测试：\non A:\nssh -1 root@B\nProtocol major versions differ: 1 vs. 2\n说明B不支持 ssh Protocol 1了，only Protocol 2 is supported")]),s._v(" "),o("p",[s._v("不过最后发现原因竟然是因为我创建秘钥对的时候重命名了id_rsa/id_rsa.pub 为 id_rsa_B/id_rsa_B.pub\nssh默认只会找id_rsa（之前已经生成了一对id_rsa/id_rsa.pub），所以跟copy到B上的id_rsa_B.pub对不上，\n需要指定\nssh -i id_rsa_B root@B 即可！\n查看版本号：ssh -v localhost")])])}),[],!1,null,null,null);e.default=n.exports}}]);