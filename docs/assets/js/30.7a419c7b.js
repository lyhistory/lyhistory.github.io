(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{231:function(e,t,a){"use strict";a.r(t);var r=a(0),s=Object(r.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("p",[a("a",{attrs:{href:"/docs/software"}},[e._v("回目录")]),e._v("  《架构》")]),e._v(" "),a("p",[e._v("architecture VS framework")]),e._v(" "),a("p",[e._v("https://docs.google.com/document/d/1fOjh7ujeIfuRazSW4W23Ijz5PdMU2UemnI-ieJ1Jrh8/edit")]),e._v(" "),a("p",[e._v("我们谈过"),a("a",{attrs:{href:"/docs/software/highlevel/distrubuted_system"}},[e._v("分布式系统")]),e._v("，谈过"),a("a",{attrs:{href:"/docs/software/highlevel/concurrent"}},[e._v("并发和并行")]),e._v("，\n也谈过"),a("a",{attrs:{href:"/docs/software/java_spring"}},[e._v("微服务框架")]),e._v(",")]),e._v(" "),a("p",[e._v("学习"),a("a",{attrs:{href:"https://segmentfault.com/a/1190000018626163",target:"_blank",rel:"noopener noreferrer"}},[e._v("服务端高并发分布式架构演进之路"),a("OutboundLink")],1)]),e._v(" "),a("p",[e._v("对话独角兽得物（毒）App CTO 陈思淼：组建技术团队的十件事\nhttps://mp.weixin.qq.com/s/TNgbzCzqSCWy_ZcK_ZZC_w")]),e._v(" "),a("h2",{attrs:{id:"recommended-frameworks-for-sme-or-small-projects"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#recommended-frameworks-for-sme-or-small-projects"}},[e._v("#")]),e._v(" Recommended frameworks for SME or small projects")]),e._v(" "),a("p",[e._v("Web framework https://iris-go.com/donate")]),e._v(" "),a("p",[e._v("architect will get evolved along with business growing when critical issues emerge.\nIt's impossible to design an architect which will keep unchanged\nfor example, at the beginning we are limited to one server, some design can not be adopt to such\nsituation which may be time consuming and meaningless.\nLayered Application Guidelines\nhttps://msdn.microsoft.com/en-us/library/ee658109.aspx#ServicesLayers")]),e._v(" "),a("p",[e._v("Architectural Styles vs. Architectural Patterns vs. Design Patterns https://herbertograca.com/2017/07/28/architectural-styles-vs-architectural-patterns-vs-design-patterns/")]),e._v(" "),a("h2",{attrs:{id:"principles"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#principles"}},[e._v("#")]),e._v(" Principles")]),e._v(" "),a("p",[e._v("https://drive.google.com/file/d/0B01BZttEuPVvR2V5QnZXXzlTYUE/view?ths=true")]),e._v(" "),a("p",[e._v("Single-Responsibility\nSeparate of concern (interception,cross-cutting concerns: logging, auditing, access control, validation)\nHigh level objects don’t care the detail of lower level objects ( IOC)\nLiskov substitution principle\nOpen/Closed Principle - programming to an interface - Loose coupling\nresponsibility and segregation")]),e._v(" "),a("h2",{attrs:{id:"theorem"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#theorem"}},[e._v("#")]),e._v(" Theorem")]),e._v(" "),a("ol",[a("li",[e._v("CAP\nC-Consistency A-Availability P-Performance/Partition Tolerance\nTypes of Consistency\n• Consistency with other users: If two users query the database at the same time, will they see the same data? Traditional relational systems would generally try to ensure that they do, while non-relational databases often take a more relaxed stance.\n• Consistency within a single session: Does the data maintain some logical consistency within the context of a single database session? For instance, if we modify a row and then read it again, do we see our own update?\n• Consistency within a single request: Does an individual request return data that is internally coherent? For instance, when we read all the rows in a relational table, we are generally guaranteed to see the state of the table as it was at a moment in time. Modifications to the table that occurred after we began our query are not included.\n• Consistency with reality: Does the data correspond with the reality that the database is trying to reflect? For example, it’s not enough for a banking transaction to simply be consistent at the end of the transaction; it also has to correctly represent the actual account balances. Consistency at the expense of accuracy is not usually acceptable.")])]),e._v(" "),a("h2",{attrs:{id:"high-level-design-architectural-patterns-and-styles"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#high-level-design-architectural-patterns-and-styles"}},[e._v("#")]),e._v(" High level design - Architectural Patterns and Styles")]),e._v(" "),a("h3",{attrs:{id:"architecture-style"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#architecture-style"}},[e._v("#")]),e._v(" Architecture Style")]),e._v(" "),a("p",[e._v("Microsoft Application Architecture Guide, 2nd Edition\nhttps://docs.microsoft.com/en-us/previous-versions/msp-n-p/ff650706(v%3dpandp.10)")]),e._v(" "),a("p",[e._v("https://docs.microsoft.com/en-us/previous-versions/msp-n-p/ee658117(v=pandp.10)")]),e._v(" "),a("p",[e._v("https://github.com/mspnp")]),e._v(" "),a("p",[a("img",{attrs:{src:"/docs/docs_image/software/architecture/architecture01.png",alt:""}})]),e._v(" "),a("h3",{attrs:{id:"samples"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#samples"}},[e._v("#")]),e._v(" Samples")]),e._v(" "),a("h4",{attrs:{id:"soa-vs-microservices"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#soa-vs-microservices"}},[e._v("#")]),e._v(" SOA VS Microservices")]),e._v(" "),a("p",[e._v("https://www.youtube.com/watch?v=EpyPFnjue38")]),e._v(" "),a("p",[a("img",{attrs:{src:"/docs/docs_image/software/architecture/architecture02.png",alt:""}})]),e._v(" "),a("h4",{attrs:{id:"cors-command-query-responsibility-segregation"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#cors-command-query-responsibility-segregation"}},[e._v("#")]),e._v(" CORS - Command-Query Responsibility Segregation")]),e._v(" "),a("p",[e._v("Principle: responsibility and segregation")]),e._v(" "),a("p",[e._v("https://kalele.io/blog-posts/really-simple-cqrs/\nhttps://docs.microsoft.com/en-us/azure/architecture/patterns/cqrs")]),e._v(" "),a("h2",{attrs:{id:"detail-design-technical-architecture"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#detail-design-technical-architecture"}},[e._v("#")]),e._v(" Detail design - technical architecture")]),e._v(" "),a("h3",{attrs:{id:"n-tier"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#n-tier"}},[e._v("#")]),e._v(" N-tier")]),e._v(" "),a("p",[a("img",{attrs:{src:"/docs/docs_image/software/architecture/architecture03.png",alt:""}})]),e._v(" "),a("h3",{attrs:{id:"layer-and-related-concepts"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#layer-and-related-concepts"}},[e._v("#")]),e._v(" Layer and related concepts")]),e._v(" "),a("p",[e._v("Presentation Layer\nMVC, Domain Object(Domain objects can have logic (depending on whether you are using domain-driven design or have anemic data model) and they are usually related to the database structure.)\nApplication layer / service layer\nBusiness Layer\nBusiness Object DTO (DTOs don't have any logic. They only have fields (state). They are used when transferring data from one layer/subsystem to another)\nData Access Layer\nDAO\nThe Data Access Layer(DAL) is the layer of a system that exists between the business logic layer and the persistence / storage layer.\nA DAL might be a single class, or it might be composed of multiple Data Access Objects(DAOs). It may have a facade over the top for the business layer to\ntalk to, hiding the complexity of the data access logic. It might be a third-party object-relational mapping tool(ORM) such as Hibernate.\nPersistence Layer\nORM(Entity framework) (POCO/entity)")]),e._v(" "),a("pre",[a("code",[e._v("1. MVC framework is for Presentation layer\n2. About Persistence layer \n\ta. PL == DAL\n\tb. PL == Storage, BL - DAL - PL\n")])]),e._v(" "),a("h3",{attrs:{id:"bl-dal-pl-patterns"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#bl-dal-pl-patterns"}},[e._v("#")]),e._v(" BL/DAL/PL - patterns")]),e._v(" "),a("p",[e._v("BL/DAL: Repository Pattern(+ Unit Of Work), DAO Pattern\nDAL/PL: Data Mapper Pattern, ORM Pattern(entity framework or NHibernate), DAO Pattern\nPL/DB: ORM (vs Stored Procedure https://rob.conery.io/2015/02/20/its-time-to-get-over-that-stored-procedure-aversion-you-have/)\n.NET 主流的ORM:https://segmentfault.com/a/1190000011676744\nDapper\nClownFish：比手写代码还快的通用数据访问层 https://www.cnblogs.com/fish-li/archive/2012/07/17/ClownFish.html#!comments\nEntity framework (buit on ADO.NET https://stackoverflow.com/questions/22328889/entityframework-vs-pure-ado-net,\nhttps://stackoverflow.com/questions/40506382/what-is-the-difference-between-an-orm-and-ado-net)")]),e._v(" "),a("p",[a("img",{attrs:{src:"/docs/docs_image/software/architecture/architecture04.png",alt:""}})]),e._v(" "),a("p",[e._v("Perfomance\nDataReaders, Entity Framework, NHibernate and Dapper\nhttp://www.luisrocha.net/2011/12/data-access-performance-comparison-in.html\nhttps://github.com/lerocha/DotNetDataAccessPerformance/tree/c2a71ede37f3dd9ee437221a84054e504773b626")]),e._v(" "),a("p",[a("img",{attrs:{src:"/docs/docs_image/software/architecture/architecture05.png",alt:""}})]),e._v(" "),a("p",[e._v("Refer:\nPattern vs Data Mapper Pattern\nhttp://www.bradoncode.com/blog/2013/08/repository-vs-domain-model-vs-data.html")]),e._v(" "),a("p",[e._v("Generic repository pattern using EF with Dependency injection\nhttps://www.codeproject.com/Tips/572761/Generic-repository-pattern-using-EF-with-Dependenc\nDesigning the infrastructure persistence layer https://docs.microsoft.com/en-us/dotnet/standard/microservices-architecture/microservice-ddd-cqrs-patterns/infrastructure-persistence-layer-design\nDAL、DAO、ORM、Active Record辨析\nhttps://blog.csdn.net/suiye/article/details/7824943")]),e._v(" "),a("p",[e._v("https://stackoverflow.com/questions/6732124/difference-between-transfer-objects-and-domain-objects\nPO, VO, TO, BO, DAO, POJO https://www.programering.com/a/MDM2kjNwATc.html\nDTO, DAO, and VO in Java https://www.quora.com/What-is-DTO-DAO-and-VO-in-Java")]),e._v(" "),a("p",[e._v("Repository pattern vs DAO pattern\n4 Common Mistakes with the Repository Pattern\nhttps://programmingwithmosh.com/entity-framework/common-mistakes-with-the-repository-pattern/\nDon’t use DAO, use Repository https://thinkinginobjects.com/2012/08/26/dont-use-dao-use-repository/")]),e._v(" "),a("p",[e._v("https://www.thoughtfulcode.com/orm-active-record-vs-data-mapper/\nhttps://social.msdn.microsoft.com/Forums/en-US/aed501f8-d7e4-40d9-8a98-32c5cdc78243/help-with-the-orm-vs-stored-procedures-argument?forum=architecturegeneral\nhttps://www.quora.com/What-are-the-pros-and-cons-of-using-SQL-Stored-Procs-versus-ORM-for-database-quering\nDAO Pattern https://www.baeldung.com/java-dao-pattern")]),e._v(" "),a("h2",{attrs:{id:"network-physical-design"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#network-physical-design"}},[e._v("#")]),e._v(" Network/Physical design")]),e._v(" "),a("p",[e._v("正向代理 反向代理Forward proxy and reverse proxy\nforward proxy proxies in behalf of clients (or requesting hosts), a reverse proxy proxies in behalf of servers\nhttps://www.jscape.com/blog/bid/87783/Forward-Proxy-vs-Reverse-Proxy\nExample:\nGrafana-server runs its own service and hosts dashboard on 3000, if bind to domain, to the normal use access domain, default using 80, need a proxy server who use 80 to forward request to grafana-server for example nginx")]),e._v(" "),a("h2",{attrs:{id:"framework-misconception"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#framework-misconception"}},[e._v("#")]),e._v(" Framework misconception")]),e._v(" "),a("p",[e._v("what is the difference between 3 tier architecture and a mvc? https://stackoverflow.com/questions/10739914/what-is-the-difference-between-3-tier-architecture-and-a-mvc")]),e._v(" "),a("p",[e._v("At first glance, the three tiers may seem similar to the model-view-controller (MVC) concept; however, topologically they are different. A fundamental rule in a three tier architecture is the client tier never communicates directly with the data tier; in a three-tier model all communication must pass through the middle tier. Conceptually the three-tier architecture is linear. However, the [model-view-controller] MVC architecture is triangular: the view sends updates to the controller, the controller updates the model, and the view gets updated directly from the model.")]),e._v(" "),a("p",[e._v("SOAP vs REST\nhttps://www.soapui.org/learn/api/soap-vs-rest-api.html")]),e._v(" "),a("h2",{attrs:{id:"application-misconception"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#application-misconception"}},[e._v("#")]),e._v(" Application misconception")]),e._v(" "),a("h3",{attrs:{id:"static及singleton-and-thread-safe"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#static及singleton-and-thread-safe"}},[e._v("#")]),e._v(" Static及singleton and thread safe")]),e._v(" "),a("p",[e._v("首先要看不同的线程是否在竞争同一个资源：\n如果是各自访问其上下文context的资源，比如kafka consumer partition worker线程访问各自的storage则是互相不打扰的；\n如果执行的某个方法内只用到了局部变量，由于局部变量位于各自thread的栈里，所以互不干扰；\n如果执行的某个方法用到了传入的变量，也就是所谓的形式参数变量，则要看这个传入的变量是否是object，如果只是普通的参数则没关系，如果是对象，要看对象是否是同一个引用，不同引用没有关系；\n如果执行的某个方法内用到了同一个引用，不管是传入的还是外部全局的变量，比如log4的logger，由于log4已经做好了线程安全写log，所以不用担心；\n如果执行的某个方法内用到了同一个引用，但是只是读没有写，读和读是没有冲突的，也没有关系，只有涉及到写才有关系；\n关于static及singleton：\nSingleton可以是static的，static是vm级别的静态变量，singleton可以是application级别的单例，如果是vm级别的，需要考虑application之间的冲突,如果是standalone程序，则可以使用vm static，引用一段shiro关于SecurityManager的注释：\nThe Shiro development team prefers that SecurityManager instances are non-static application singletons\n* and "),a("em",[e._v("not")]),e._v(" VM static singletons.  Application singletons that do not use static memory require some sort\n* of application configuration framework to maintain the application-wide SecurityManager instance for you\n* (for example, Spring or EJB3 environments) such that the object reference does not need to be static.")]),e._v(" "),a("h4",{attrs:{id:"oop-static"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#oop-static"}},[e._v("#")]),e._v(" OOP static")]),e._v(" "),a("p",[e._v("Static method defeat OOP, because static method is not object behavior,\nFor thread safe, we should look at static variable not static method/instruction\nt’s not the static methods that you have to watch out for – it’s the static fields.")]),e._v(" "),a("p",[e._v("https://stackoverflow.com/questions/7026507/why-are-static-variables-considered-evil")]),e._v(" "),a("h4",{attrs:{id:"framework-level-net-framework-and-other-plugins-threadsafe"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#framework-level-net-framework-and-other-plugins-threadsafe"}},[e._v("#")]),e._v(" Framework level(.net framework and other plugins) threadsafe")]),e._v(" "),a("p",[e._v('Many of the classes in the .NET framework have the following remark in the “Thread Safety” section: "Any public static (Shared in Visual Basic) members of this type are thread safe. Any instance members are not guaranteed to be thread safe."Does this mean static methods are inherently thread safe? The answer is no. Classes with the above note will have thread safe static methods because the Microsoft engineers wrote the code in a thread safe manner, perhaps by using locks or other thread synchronization mechanisms\nFile.Open(XXX)\nString.XXX')]),e._v(" "),a("p",[e._v("Plugin Example: log4net\nLog4net Thread-Safe but not Process-Safe\nhttp://hectorcorrea.com/blog/log4net-thread-safe-but-not-process-safe/17")]),e._v(" "),a("h4",{attrs:{id:"application-global-state-thread-safe"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#application-global-state-thread-safe"}},[e._v("#")]),e._v(" Application global state thread safe")]),e._v(" "),a("p",[e._v("init(write at application start) and used(read) from everywhere, that’s fine\nConcurrentDictionary")]),e._v(" "),a("h4",{attrs:{id:"use-it-in-thread-safe-way"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#use-it-in-thread-safe-way"}},[e._v("#")]),e._v(" Use it in thread-safe way")]),e._v(" "),a("p",[e._v("System.timer\nIt will Continue Executing on different thread\nSo set autoreset=false")]),e._v(" "),a("p",[e._v("Message queue, multiple consumer retrieve messages from queue.")]),e._v(" "),a("p",[e._v("Refer:\nhttps://odetocode.com/articles/313.aspx")]),e._v(" "),a("h4",{attrs:{id:"class-load-time"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#class-load-time"}},[e._v("#")]),e._v(" Class-load time")]),e._v(" "),a("p",[a("img",{attrs:{src:"/docs/docs_image/software/architecture/architecture111.png",alt:""}})]),e._v(" "),a("h3",{attrs:{id:"db-connection-misconception"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#db-connection-misconception"}},[e._v("#")]),e._v(" DB Connection misconception")]),e._v(" "),a("p",[e._v("Difference between driver and provider https://stackoverflow.com/questions/19293744/difference-between-driver-and-provider\nDriver is a program installed on a workstation or a server; it allows programs to interact with a Database Management System (DBMS). Such as, JDBC driver provides database connectivity through the standard JDBC application program interface (APIs) available in J2EE.\nA data provider is a set of libraries that is used to communicate with data source. Such as, SQL data provider for SQL, Oracle data provider for Oracle, OLE DB data provider for access, excel and MySQL. It serves as a bridge between an application and a data source and is used to retrieve data from a data source and to reconcile changes to that data back to the data source.")]),e._v(" "),a("p",[e._v("DB Access => DB provider(ODP.NET) => DB driver(Oracle for .net ODAC, JDBC)\nDB Driver maintain connection pool (closed put into pool)")]),e._v(" "),a("h3",{attrs:{id:"connection-pool"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#connection-pool"}},[e._v("#")]),e._v(" Connection pool")]),e._v(" "),a("p",[e._v("https://www.youtube.com/watch?v=3JMK1JK5UEo")]),e._v(" "),a("p",[e._v("https://docs.oracle.com/cd/E15586_01/fusionapps.1111/e20836/conn_pool.htm\nhttps://social.msdn.microsoft.com/Forums/vstudio/en-US/a5239fc6-151b-4e3a-97e3-286c8c785f7b/c-net-in-iis-connection-pooling-question?forum=csharpgeneral")]),e._v(" "),a("p",[e._v("Pgbouncer and pg pooling cannot use together\nhttps://pgbouncer.github.io/usage.html#quick-start")]),e._v(" "),a("p",[e._v("Performance monitor config\nhttps://docs.oracle.com/cd/E15296_01/doc.111/e15167/featConnecting.htm#CJAFIDDC")])])}),[],!1,null,null,null);t.default=s.exports}}]);