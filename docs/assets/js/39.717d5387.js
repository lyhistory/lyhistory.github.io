(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{491:function(e,t,n){"use strict";n.r(t);var i=n(65),a=Object(i.a)({},(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[n("p",[n("a",{attrs:{href:"/docs/blockchain"}},[e._v("回目录")]),e._v("  《比特币：开发基础》")]),e._v(" "),n("p",[e._v("Completely Offline Bitcoin Transactions https://medium.com/hackernoon/completely-offline-bitcoin-transactions-4e58324637bd")]),e._v(" "),n("h2",{attrs:{id:"_1-references"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-references"}},[e._v("#")]),e._v(" 1. References")]),e._v(" "),n("p",[e._v("** Statistics **")]),e._v(" "),n("p",[e._v("Nodes\nhttps://bitnodes.earn.com/nodes/leaderboard/\nFees\nhttps://bitcoinfees.earn.com/\nBitcoin Network Momentum\nhttp://charts.woobull.com/bitcoin-network-momentum/")]),e._v(" "),n("p",[e._v("Current/prevailing  market rate:\nhttps://www.cmegroup.com/trading/cryptocurrency-indices/cf-bitcoin-reference-rate.html\nhttps://coincap.io/\nhttps://bitcoinaverage.com/")]),e._v(" "),n("p",[e._v("Btc explorer\nhttps://insight.bitpay.com/\nhttps://www.blockchain.com/explorer\nhttps://live.blockcypher.com/")]),e._v(" "),n("p",[e._v("** Codes/Demo **\nhttps://github.com/lyhistory/learn_coding/tree/master/blockchain/btc")]),e._v(" "),n("p",[e._v("http://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html\nhttps://github.com/shirriff/bitcoin-code/blob/master/txnUtils.py")]),e._v(" "),n("p",[e._v("Rpc learn\nhttps://github.com/bitcoin/bitcoin/tree/c033c4b5cef89a654e4d9d5c5f9bd823871b068b/test/functional")]),e._v(" "),n("p",[e._v("** Course/ community **")]),e._v(" "),n("p",[e._v("https://crypto.stanford.edu/cs251_fall15/cs251p.html\nhttps://crypto.stanford.edu/cs251_fall15/syllabus.html\nhttps://makecodecode.blogspot.sg/2016/12/blockchain-bitcoin-moocs.html\nhttps://www.youtube.com/watch?v=7nQqN5MBcBo&index=1&list=PL68lGg7SjGZDKz8ut9oLkbDqK_ngqmJg-")]),e._v(" "),n("p",[e._v("https://lopp.net/bitcoin.html\nhttps://bitcoin.page/\nhttps://www.lopp.net/bitcoin-information.html\nhttps://www.lopp.net/lightning-information.html")]),e._v(" "),n("p",[e._v("https://www.bitcoindesigned.com/")]),e._v(" "),n("p",[e._v('Bitcoin P2P e-cash paper by Satoshi Nakamoto https://www.mail-archive.com/search?l=cryptography%40metzdowd.com&q=subject:"Bitcoin+P2P+e%5C-cash+paper"&o=oldest&f=1')]),e._v(" "),n("p",[e._v("Money, blockchains, and social scalability https://unenumerated.blogspot.com/2017/02/money-blockchains-and-social-scalability.html?m=1")]),e._v(" "),n("p",[e._v("https://bitcoincore.slack.com/\nhttp://learnmeabitcoin.com/\nhttps://www.youtube.com/watch?v=6Fa04MnURhw")]),e._v(" "),n("p",[e._v("** Other **")]),e._v(" "),n("p",[e._v("https://twitter.com/MITBitcoinClub")]),e._v(" "),n("p",[e._v("Certified Bitcoin Professional https://cryptoconsortium.org/certifications/cbp/")]),e._v(" "),n("h2",{attrs:{id:"_2-development-and-deployment"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-development-and-deployment"}},[e._v("#")]),e._v(" 2. Development and Deployment")]),e._v(" "),n("p",[e._v("bitcoin是开源项目，没有所谓官方，不过确实有bitcoin core项目，然后也有很多变种，首先从bitcoin core说起")]),e._v(" "),n("h3",{attrs:{id:"_2-1-bitcoin-core"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-bitcoin-core"}},[e._v("#")]),e._v(" 2.1 Bitcoin Core")]),e._v(" "),n("p",[n("strong",[e._v("reference")])]),e._v(" "),n("p",[e._v("https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch03.asciidoc")]),e._v(" "),n("p",[e._v("Feature Refer to release note\nhttps://github.com/bitcoin/bitcoin/blob/master/doc/release-notes/release-notes-0.17.0.md#configuration-sections-for-testnet-and-regtest")]),e._v(" "),n("p",[e._v("Refer to test case and samples\nhttps://github.com/bitcoin/bitcoin/blob/master/doc/zmq.md\nhttps://github.com/bitcoin/bitcoin/blob/master/contrib/zmq/zmq_sub.py\nhttps://github.com/bitcoin/bitcoin/blob/452bb90c718da18a79bfad50ff9b7d1c8f1b4aa3/contrib/debian/examples/bitcoin.conf\nhttps://github.com/ChristopherA/Learning-Bitcoin-from-the-Command-Line/blob/master/bitcoin-cli-commands-help.md")]),e._v(" "),n("h4",{attrs:{id:"setup"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#setup"}},[e._v("#")]),e._v(" "),n("strong",[e._v("Setup")])]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("git clone https://github.com/bitcoin/bitcoin.git\ncd bitcoin\ngit tag        \t \ngit checkout v0.17.1\n")])])]),n("p",[e._v("See doc/build-*.md for instructions on building the various elements of the Bitcoin Core reference implementation of Bitcoin.")]),e._v(" "),n("p",[e._v("比如测试过的：https://github.com/bitcoin/bitcoin/blob/master/doc/build-unix.md")]),e._v(" "),n("p",[n("img",{attrs:{src:"/docs/docs_image/blockchain/btc/btc_dev01.png",alt:""}})]),e._v(" "),n("p",[n("strong",[e._v("Prerequisite")])]),e._v(" "),n("p",[e._v("ubuntu:")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("sudo apt-get install build-essential libtool autotools-dev automake pkg-config libssl-dev libevent-dev bsdmainutils python3 libboost-system-dev libboost-filesystem-dev libboost-chrono-dev libboost-test-dev libboost-thread-dev -y\n")])])]),n("p",[e._v("The following removed https://github.com/bitcoin/bitcoin/commit/fa3148aacbea0e1a0ba8016b66b8d6b876c267b2\n"),n("s",[e._v("For ubuntu only(enable wallet mode dependency):")]),e._v(" "),n("s",[e._v("sudo apt-get install software-properties-common")]),e._v(" "),n("s",[e._v("sudo add-apt-repository ppa:bitcoin/bitcoin")]),e._v(" "),n("s",[e._v("sudo apt-get update")]),e._v(" "),n("s",[e._v("sudo apt-get install libdb4.8-dev libdb4.8++-dev")])]),e._v(" "),n("p",[e._v("ZMQ dependencies (provides ZMQ API 4.x):")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("sudo apt-get install libzmq3-dev\n")])])]),n("p",[e._v("GUI:")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("sudo apt-get install libqt5gui5 libqt5core5a libqt5dbus5 qttools5-dev qttools5-dev-tools libprotobuf-dev protobuf-compiler\n")])])]),n("p",[e._v("centos")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("yum -y install epel-release\nyum install -y autoconf automake boost-devel gcc-c++ git libdb4-cxx libdb4-cxx-devel libevent-devel libtool openssl-devel wget\nhttps://ma.ttias.be/run-a-bitcoin-core-full-node-on-centos-7/\n")])])]),n("p",[n("strong",[e._v("Build")])]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("./autogen.sh\n./configure\nmake\nmake install （这一步是可选的，如果不做这一步，结果bitcoind bitcoin-cli都在./src目录里面）\n")])])]),n("p",[n("img",{attrs:{src:"/docs/docs_image/blockchain/btc/btc_dev02.png",alt:""}})]),e._v(" "),n("p",[n("strong",[n("span",{staticStyle:{color:"red"}},[e._v("Latest Version")])])]),e._v(" "),n("ol",[n("li",[n("p",[e._v("Auto script\n./contrib/install_db4.sh "),n("code",[e._v("pwd")])])]),e._v(" "),n("li",[n("p",[e._v("Manually install")])])]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('BITCOIN_ROOT=$(pwd)\n# Pick some path to install BDB to, here we create a directory within the bitcoin directory\nBDB_PREFIX="${BITCOIN_ROOT}/db4"\nmkdir -p $BDB_PREFIX\n# Fetch the source and verify that it is not tampered with\nwget \'http://download.oracle.com/berkeley-db/db-4.8.30.NC.tar.gz\'\necho \'12edc0df75bf9abd7f82f821795bcee50f42cb2e5f76a6a281b85732798364ef db-4.8.30.NC.tar.gz\' | sha256sum -c\n# -> db-4.8.30.NC.tar.gz: OK\ntar -xzvf db-4.8.30.NC.tar.gz\n# Build the library and install to our prefix\ncd db-4.8.30.NC/build_unix/\n# Note: Do a static build so that it can be embedded into the executable, instead of having to find a .so at runtime\n../dist/configure --enable-cxx --disable-shared --with-pic --prefix=$BDB_PREFIX\nmake install\n# Configure Bitcoin Core to use our own-built instance of BDB\ncd $BITCOIN_ROOT\n./autogen.sh\n./configure LDFLAGS="-L${BDB_PREFIX}/lib/" CPPFLAGS="-I${BDB_PREFIX}/include/" # (other args…)\n\n')])])]),n("p",[n("s",[e._v("Old version:")])]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('# Update & Upgrade the System\nsudo apt-get update\nsudo apt-get upgrade\n\n# Install dependencies there might be more based on your system\n# However below instructions are for the fresh Ubuntu install/server\n# Please carefully watch the logs because if something could not be install\n# You have to make sure it is installed properly by trying the command or that particular\n# dependency again\n\nsudo apt-get install build-essential libtool autotools-dev autoconf pkg-config libssl-dev\nsudo apt-get install libboost-all-dev\nsudo apt-get install libqt5gui5 libqt5core5a libqt5dbus5 qttools5-dev qttools5-dev-tools libprotobuf-dev protobuf-compiler\nsudo apt-get install libqrencode-dev autoconf openssl libssl-dev libevent-dev\nsudo apt-get install libminiupnpc-dev\n\n# Download Bitcoin Source code\ncd ~\ngit clone https://github.com/bitcoin/bitcoin.git\n\n# Bitcoin uses the Berkley DB 4.8\n# We need to install it as well\n# Download & Install Berkley DB\ncd ~\nmkdir bitcoin/db4/\nwget \'http://download.oracle.com/berkeley-db/db-4.8.30.NC.tar.gz\'\ntar -xzvf db-4.8.30.NC.tar.gz\ncd db-4.8.30.NC/build_unix/\n../dist/configure --enable-cxx --disable-shared --with-pic --prefix=/home/theusername/bitcoin/db4/\nmake install\n\n# Compile Bitcoin with Berkley DB 4.8\ncd ~/bitcoin/\n./autogen.sh\n# below command ./configure may return with error for dependencies\n# you need to make sure that it returns with no error\n# If it does please install the dependencies and rerun the /autogen.sh command again and then below command again\n./configure LDFLAGS="-L/home/theusername/bitcoin/db4/lib/" CPPFLAGS="-I/home/theusername/bitcoin/db4/include/"\n\n# below command may take 5-10 minutes based on your system\nmake -s -j5\n\n./autogen.sh\n./configure LDFLAGS="-L/home/lyhistory/workspace/blockchain/bitcoin/bitcoin/db4/lib/" CPPFLAGS="-I/home/lyhistory/workspace/blockchain/bitcoin/bitcoin/db4/include/"\nmake -s -j5\n')])])]),n("p",[n("strong",[e._v("Questions:")])]),e._v(" "),n("p",[e._v("Run bitcoin in container\nhttps://stackoverflow.com/questions/25116608/how-to-connect-to-a-bitcoin-testnet-running-in-a-docker-container")]),e._v(" "),n("p",[e._v("GUI to remote bitcoin core\nhttps://bitcoin.stackexchange.com/questions/44408/how-to-connect-to-a-remote-bitcoin-core-remotely")]),e._v(" "),n("p",[e._v("Dump peers.dat\nhttps://bitcoin.stackexchange.com/questions/75324/how-to-dump-peers-dat-file-to-a-plain-text-file")]),e._v(" "),n("p",[e._v("Mq notification\nhttps://bitcoin.stackexchange.com/questions/40752/what-is-the-use-case-of-bitcoind-zeromq")]),e._v(" "),n("h4",{attrs:{id:"usage"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#usage"}},[e._v("#")]),e._v(" Usage")]),e._v(" "),n("p",[e._v("Refer to <"),n("a",{attrs:{href:"https://github.com/lyhistory/learn_coding/tree/master/blockchain/btc/basic/bitcoincore_v0.17.1_cli.txt",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://github.com/lyhistory/learn_coding/tree/master/blockchain/btc/basic/bitcoincore_v0.17.1_cli.txt"),n("OutboundLink")],1),e._v(">")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('如果没有make install\nmake的结果都在 ./src/下面\n./src/bitcoind -mempoolreplacement=1 -printtoconsole\n\n./src/bitcoin-cli getblockhash 0\n./src/bitcoin-cli getblock 000000000019d6689c085ae165831e934ff763ae46a2a6c172b3f1b60a8ce26f\n./src/bitcoin-cli getblock 000000000019d6689c085ae165831e934ff763ae46a2a6c172b3f1b60a8ce26f 2\n\n./src/bitcoin-cli getrawtransaction 4a5e1e4baab89f3a32518a88c31bc87f618f76673e2cc77ab2127b7afdeda33b\n./src/bitcoin-cli decoderawtransaction\n\n./src/bitcoin-cli stop\n\n\n\nlyhistory@lyhistory-VirtualBox:/opt/bitcoin$ ./src/bitcoin-cli getblockhash 0\n000000000019d6689c085ae165831e934ff763ae46a2a6c172b3f1b60a8ce26f\nlyhistory@lyhistory-VirtualBox:/opt/bitcoin$ ./src/bitcoin-cli getblock 000000000019d6689c085ae165831e934ff763ae46a2a6c172b3f1b60a8ce26f\n{\n  "hash": "000000000019d6689c085ae165831e934ff763ae46a2a6c172b3f1b60a8ce26f",\n  "confirmations": 5631,\n  "strippedsize": 285,\n  "size": 285,\n  "weight": 1140,\n  "height": 0,\n  "version": 1,\n  "versionHex": "00000001",\n  "merkleroot": "4a5e1e4baab89f3a32518a88c31bc87f618f76673e2cc77ab2127b7afdeda33b",\n  "tx": [\n    "4a5e1e4baab89f3a32518a88c31bc87f618f76673e2cc77ab2127b7afdeda33b"\n  ],\n  "time": 1231006505,\n  "mediantime": 1231006505,\n  "nonce": 2083236893,\n  "bits": "1d00ffff",\n  "difficulty": 1,\n  "chainwork": "0000000000000000000000000000000000000000000000000000000100010001",\n  "nTx": 1,\n  "nextblockhash": "00000000839a8e6886ab5951d76f411475428afc90947ee320161bbf18eb6048"\n}\n\nlyhistory@lyhistory-VirtualBox:/opt/bitcoin$ ./src/bitcoin-cli getrawtransaction 4a5e1e4baab89f3a32518a88c31bc87f618f76673e2cc77ab2127b7afdeda33b\nerror code: -5\nerror message:\nThe genesis block coinbase is not considered an ordinary transaction and cannot be retrieved\n\n需要用这种方法：\nlyhistory@lyhistory-VirtualBox:/opt/bitcoin$ ./src/bitcoin-cli getblock 000000000019d6689c085ae165831e934ff763ae46a2a6c172b3f1b60a8ce26f 2\n{\n  "hash": "000000000019d6689c085ae165831e934ff763ae46a2a6c172b3f1b60a8ce26f",\n  "confirmations": 127025,\n  "strippedsize": 285,\n  "size": 285,\n  "weight": 1140,\n  "height": 0,\n  "version": 1,\n  "versionHex": "00000001",\n  "merkleroot": "4a5e1e4baab89f3a32518a88c31bc87f618f76673e2cc77ab2127b7afdeda33b",\n  "tx": [\n    {\n      "txid": "4a5e1e4baab89f3a32518a88c31bc87f618f76673e2cc77ab2127b7afdeda33b",\n      "hash": "4a5e1e4baab89f3a32518a88c31bc87f618f76673e2cc77ab2127b7afdeda33b",\n      "version": 1,\n      "size": 204,\n      "vsize": 204,\n      "weight": 816,\n      "locktime": 0,\n      "vin": [\n        {\n          "coinbase": "04ffff001d0104455468652054696d65732030332f4a616e2f32303039204368616e63656c6c6f72206f6e206272696e6b206f66207365636f6e64206261696c6f757420666f722062616e6b73",\n          "sequence": 4294967295\n        }\n      ],\n      "vout": [\n        {\n          "value": 50.00000000,\n          "n": 0,\n          "scriptPubKey": {\n            "asm": "04678afdb0fe5548271967f1a67130b7105cd6a828e03909a67962e0ea1f61deb649f6bc3f4cef38c4f35504e51ec112de5c384df7ba0b8d578a4c702b6bf11d5f OP_CHECKSIG",\n            "hex": "4104678afdb0fe5548271967f1a67130b7105cd6a828e03909a67962e0ea1f61deb649f6bc3f4cef38c4f35504e51ec112de5c384df7ba0b8d578a4c702b6bf11d5fac",\n            "reqSigs": 1,\n            "type": "pubkey",\n            "addresses": [\n              "1A1zP1eP5QGefi2DMPTfTL5SLmv7DivfNa"\n            ]\n          }\n        }\n      ],\n      "hex": "01000000010000000000000000000000000000000000000000000000000000000000000000ffffffff4d04ffff001d0104455468652054696d65732030332f4a616e2f32303039204368616e63656c6c6f72206f6e206272696e6b206f66207365636f6e64206261696c6f757420666f722062616e6b73ffffffff0100f2052a01000000434104678afdb0fe5548271967f1a67130b7105cd6a828e03909a67962e0ea1f61deb649f6bc3f4cef38c4f35504e51ec112de5c384df7ba0b8d578a4c702b6bf11d5fac00000000"\n    }\n  ],\n  "time": 1231006505,\n  "mediantime": 1231006505,\n  "nonce": 2083236893,\n  "bits": "1d00ffff",\n  "difficulty": 1,\n  "chainwork": "0000000000000000000000000000000000000000000000000000000100010001",\n  "nTx": 1,\n  "nextblockhash": "00000000839a8e6886ab5951d76f411475428afc90947ee320161bbf18eb6048"\n}\nlyhistory@lyhistory-VirtualBox:/opt/bitcoin$\n\n查看coinbase里面的内容\n方法一：\necho "01000000010000000000000000000000000000000000000000000000000000000000000000ffffffff4d04ffff001d0104455468652054696d65732030332f4a616e2f32303039204368616e63656c6c6f72206f6e206272696e6b206f66207365636f6e64206261696c6f757420666f722062616e6b73ffffffff0100f2052a01000000434104678afdb0fe5548271967f1a67130b7105cd6a828e03909a67962e0ea1f61deb649f6bc3f4cef38c4f35504e51ec112de5c384df7ba0b8d578a4c702b6bf11d5fac00000000" | xxd -r -p\n\n方法二：\nlyhistory@lyhistory-VirtualBox:/opt/bitcoin$ ./src/bitcoin-cli decoderawtransaction 01000000010000000000000000000000000000000000000000000000000000000000000000ffffffff4d04ffff001d0104455468652054696d65732030332f 4a616e2f32303039204368616e63656c6c6f72206f6e206272696e6b206f66207365636f6e64206261696c6f757420666f722062616e6b73ffffffff0100f2052a01000000434104678afdb0fe5548271967f1a67130b7105cd6a828e03909a67962e0ea1f61deb649 f6bc3f4cef38c4f35504e51ec112de5c384df7ba0b8d578a4c702b6bf11d5fac00000000\n{\n  "txid": "4a5e1e4baab89f3a32518a88c31bc87f618f76673e2cc77ab2127b7afdeda33b",\n  "hash": "4a5e1e4baab89f3a32518a88c31bc87f618f76673e2cc77ab2127b7afdeda33b",\n  "version": 1,\n  "size": 204,\n  "vsize": 204,\n  "weight": 816,\n  "locktime": 0,\n  "vin": [\n    {\n      "coinbase": "04ffff001d0104455468652054696d65732030332f4a616e2f32303039204368616e63656c6c6f72206f6e206272696e6b206f66207365636f6e64206261696c6f757420666f722062616e6b73",\n      "sequence": 4294967295\n    }\n  ],\n  "vout": [\n    {\n      "value": 50.00000000,\n      "n": 0,\n      "scriptPubKey": {\n        "asm": "04678afdb0fe5548271967f1a67130b7105cd6a828e03909a67962e0ea1f61deb649f6bc3f4cef38c4f35504e51ec112de5c384df7ba0b8d578a4c702b6bf11d5f OP_CHECKSIG",\n        "hex": "4104678afdb0fe5548271967f1a67130b7105cd6a828e03909a67962e0ea1f61deb649f6bc3f4cef38c4f35504e51ec112de5c384df7ba0b8d578a4c702b6bf11d5fac",\n        "reqSigs": 1,\n        "type": "pubkey",\n        "addresses": [\n          "1A1zP1eP5QGefi2DMPTfTL5SLmv7DivfNa"\n        ]\n      }\n    }\n  ]\n}\n\necho "04ffff001d0104455468652054696d65732030332f4a616e2f32303039204368616e63656c6c6f72206f6e206272696e6b206f66207365636f6e64206261696c6f757420666f722062616e6b73" | xxd -r -p\n♦□□ ♦EThe Times 03/Jan/2009 Chancellor on brink of second bailout for banks\n\n再看一个普通的coinbase交易\nlyhistory@lyhistory-VirtualBox:/opt/bitcoin$ ./src/bitcoin-cli decoderawtransaction 01000000010000000000000000000000000000000000000000000000000000000000000000ffffffff0704ffff001d0136ffffffff0100f2052a0100000043 4104fcc2888ca91cf0103d8c5797c256bf976e81f280205d002d85b9b622ed1a6f820866c7b5fe12285cfa78c035355d752fc94a398b67597dc4fbb5b386816425ddac00000000\n{\n  "txid": "d3ad39fa52a89997ac7381c95eeffeaf40b66af7a57e9eba144be0a175a12b11",\n  "hash": "d3ad39fa52a89997ac7381c95eeffeaf40b66af7a57e9eba144be0a175a12b11",\n  "version": 1,\n  "size": 134,\n  "vsize": 134,\n  "weight": 536,\n  "locktime": 0,\n  "vin": [\n    {\n      "coinbase": "04ffff001d0136",\n      "sequence": 4294967295\n    }\n  ],\n  "vout": [\n    {\n      "value": 50.00000000,\n      "n": 0,\n      "scriptPubKey": {\n        "asm": "04fcc2888ca91cf0103d8c5797c256bf976e81f280205d002d85b9b622ed1a6f820866c7b5fe12285cfa78c035355d752fc94a398b67597dc4fbb5b386816425dd OP_CHECKSIG",\n        "hex": "4104fcc2888ca91cf0103d8c5797c256bf976e81f280205d002d85b9b622ed1a6f820866c7b5fe12285cfa78c035355d752fc94a398b67597dc4fbb5b386816425ddac",\n        "reqSigs": 1,\n        "type": "pubkey",\n        "addresses": [\n          "15yN7NPEpu82sHhB6TzCW5z5aXoamiKeGy"\n        ]\n      }\n    }\n  ]\n}\n\n "coinbase": "04ffff001d0136",解释：\nhttps://bitcoin.stackexchange.com/questions/48540/how-is-the-extra-nonce-formatted\n\n')])])]),n("h3",{attrs:{id:"_2-2-libbitcoin"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-libbitcoin"}},[e._v("#")]),e._v(" 2.2 Libbitcoin")]),e._v(" "),n("p",[e._v("Amir Taaki’s libbitcoin has come to be one of the most advanced alternative implementations of the Bitcoin protocol in existence. Although there are now dozens of alternative implementations on the market, libbitcoin is one of the few that re-implements the complete Bitcoin standard, allowing users to run a deterministic wallet, an elliptic curve message signing interface and, of course, a fully functional Bitcoin node.\nsx=>libbitcoin")]),e._v(" "),n("p",[e._v("bx tool\nhttps://github.com/libbitcoin/libbitcoin-explorer")]),e._v(" "),n("p",[e._v("https://bitcointalk.org/index.php?topic=259999.0\nhttps://github.com/libbitcoin/libbitcoin-explorer/wiki/Wallet-Commands")]),e._v(" "),n("p",[n("img",{attrs:{src:"/docs/docs_image/blockchain/btc/btc_dev03.png",alt:""}})]),e._v(" "),n("p",[n("strong",[e._v("Setup")])]),e._v(" "),n("p",[e._v("Manual install(failed):\nInstall dependency:\nLibbitcoin-explorer => Libbitcoin-client => Libbitcoin-protocol => libbitcoin/libbitcoin-system\nAuto install:\n./libbitcoin-explorer.sh --prefix=/opt/tools/libbitcoin-sh --build-boost --build-zmq --disable-shared\nOr\n./install.sh --prefix=/opt/tools/libbitcoin-sh --build-boost --build-zmq --disable-shared")]),e._v(" "),n("p",[e._v("Direct download:https://github.com/libbitcoin/libbitcoin-explorer/wiki/Download-BX")]),e._v(" "),n("p",[e._v("bx tool:\ntype-0 nondeterministic wallet\nbx seed | bx ec-new > privateKey\nbx ec-to-public "),n("privateKey",[e._v("publicKey\nbx ec-to-address < publicKey\ntype-2 deterministic wallet:\nbx seed > seed\nbx hd-new < seed > master\nbx hd-private --hard < master > account\nbx hd-private -- index 0 < account\nbx hd-private --index 0 < account\nbx hd-private --index 1 < account\nbx hd-public --index 0 < account\nbx hd-public --index 1 < account\nbx hd-private --index 0 < account | bx hd-to-public\nbx hd-private --index 1 < account | bx hd-to-public\nbx mnemonic-new < seed > words\nbx mnemonic-to-seed < words")])],1),e._v(" "),n("h3",{attrs:{id:"_2-3-其他开发库"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-其他开发库"}},[e._v("#")]),e._v(" 2.3 其他开发库")]),e._v(" "),n("p",[e._v("bip32utils\nPycoin -python lib\nInstall\nhttps://github.com/richardkiss/pycoin\nvirtualenvwrapper python3\nmake install")]),e._v(" "),n("p",[e._v("Bitcore https://bitcore.io")]),e._v(" "),n("p",[e._v("bitcoinJ https://bitcoinj.github.io/working-with-the-wallet#creating-multi-sends-and-other-contracts")]),e._v(" "),n("p",[e._v("?# Differ bitcore vs bitcoin core?\nhttps://forum.bitcore.io/t/what-is-the-difference-between-bitcore-and-bitcored-and-bitcore-node/1304/6\n?#how to set a fixed coinbase address https://bitcointalk.org/index.php?topic=5119652.msg50127572#msg50127572")]),e._v(" "),n("h3",{attrs:{id:"_2-4-应用架构"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-应用架构"}},[e._v("#")]),e._v(" 2.4 应用架构")]),e._v(" "),n("p",[e._v("参考 "),n("a",{attrs:{href:"/docs/blockchain/btc/btc_indepth"}},[e._v("btc深度解析")]),e._v("和"),n("a",{attrs:{href:"/docs/blockchain/btc/btc_dev_usecase"}},[e._v("btc用例")])]),e._v(" "),n("h2",{attrs:{id:"_3-theory"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-theory"}},[e._v("#")]),e._v(" 3. Theory")]),e._v(" "),n("span",{staticStyle:{color:"red"}},[e._v("\n**主要参考：**\n")]),e._v("\n[Mastering Bitcoin](https://github.com/bitcoinbook/)\n[Bitcoin白皮书: A Peer-to-Peer Electronic Cash System](https://bitcoin.org/bitcoin.pdf)\n"),n("h3",{attrs:{id:"_3-1-introduction"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-introduction"}},[e._v("#")]),e._v(" 3.1 introduction")]),e._v(" "),n("p",[e._v("Bitcoin consists of:\n●\tA decentralized peer-to-peer network (the bitcoin protocol)\n●\tA public transaction ledger (the blockchain)\n●\tA set of rules for independent transaction validation and currency issuance (consensus rules)\n●\tA mechanism for reaching global decentralized consensus on the valid blockchain (Proof-of-Work algorithm)\nThree basic questions for anyone accepting digital money are:")]),e._v(" "),n("ol",[n("li",[e._v("Can I trust that the money is authentic and not counterfeit?")]),e._v(" "),n("li",[e._v("Can I trust that the digital money can only be spent once (known as the “double-spend” problem)?")]),e._v(" "),n("li",[e._v("Can I be sure that no one else can claim this money belongs to them and not me?")])]),e._v(" "),n("p",[e._v("counterfeiting problem, double spend issue")]),e._v(" "),n("p",[e._v("Confirmation: In traditional financial terms this is known as clearing")]),e._v(" "),n("p",[e._v("Change address\nIf you always use the largest bill in your pocket, you will end up with a pocket full of loose change. If you only use the loose change, you’ll always have only big bills. People subconsciously find a balance between these two extremes, and bitcoin wallet developers strive to program this balance.")]),e._v(" "),n("p",[e._v("Common trasaction forms\nTransaction aggregating funds\nTrrsanction distributing funds")]),e._v(" "),n("p",[e._v('a propagation technique known as flooding\nA common misconception about bitcoin transactions is that they must be "confirmed" by waiting 10 minutes for a new block, or up to 60 minutes for a full six confirmations. Although confirmations ensure the transaction has been accepted by the whole network, such a delay is unnecessary for small-value items such as a cup of coffee. A merchant may accept a valid small-value transaction with no confirmations, with no more risk than a credit card payment made without an ID or a signature, as merchants routinely accept today.')]),e._v(" "),n("h3",{attrs:{id:"_3-2-bitcoin-core-the-reference-implementation"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-bitcoin-core-the-reference-implementation"}},[e._v("#")]),e._v(" 3.2 Bitcoin Core: The Reference Implementation")]),e._v(" "),n("p",[e._v("Bitcoin Core architecture (Source: Eric Lombrozo) shows the architecture of Bitcoin Core.")]),e._v(" "),n("p",[n("img",{attrs:{src:"/docs/docs_image/blockchain/btc/btc_dev04.png",alt:""}})]),e._v(" "),n("p",[e._v('A transaction ID is not authoritative until a transaction has been confirmed. Absence of a transaction hash in the blockchain does not mean the transaction was not processed. This is known as "transaction malleability," because transaction hashes can be modified prior to confirmation in a block. After confirmation, the txid is immutable and authoritative.')]),e._v(" "),n("h3",{attrs:{id:"_3-3-keys-addresses"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-keys-addresses"}},[e._v("#")]),e._v(" 3.3 Keys, Addresses")]),e._v(" "),n("p",[e._v("digital keys, bitcoin addresses/fingerprint(represent public key or scripts), and digital signatures/witness\nThe size of bitcoin’s private key space, (2^256) is an unfathomably large number. It is approximately 1077 in decimal. For comparison, the visible universe is estimated to contain 1080 atoms.\nBase58 checksum-encoded format called the Wallet Import Format (WIF)")]),e._v(" "),n("p",[e._v("Most bitcoin implementations use the "),n("a",{attrs:{href:"http://bit.ly/1ql7bn8",target:"_blank",rel:"noopener noreferrer"}},[e._v("OpenSSL cryptographic library"),n("OutboundLink")],1),e._v(" to do the elliptic curve math. For example, to derive the public key, the function EC_POINT_mul() is used.\nThe algorithms used to make a bitcoin address from a public key are the Secure Hash Algorithm (SHA) and the RACE Integrity Primitives Evaluation Message Digest (RIPEMD), specifically SHA256 and RIPEMD160.")]),e._v(" "),n("p",[n("img",{attrs:{src:"/docs/docs_image/blockchain/btc/btc_dev05.png",alt:""}})]),e._v(" "),n("p",[e._v('"compressed private key" really means "private key from which only compressed public keys should be derived,\n"Compressed private keys" is a misnomer! They are not compressed; rather, WIF-compressed signifies that the keys should only be used to derive compressed public keys and their corresponding bitcoin addresses. Ironically, a "WIF-compressed" encoded private key is one byte longer because it has the added 01 suffix to distinguish it from an "uncompressed" one.')]),e._v(" "),n("p",[e._v("List of address prefixes\nhttps://en.bitcoin.it/wiki/List_of_address_prefixes")]),e._v(" "),n("p",[n("strong",[e._v("比特币HASH生成")])]),e._v(" "),n("p",[e._v("Cryptographic Hash function , (collision-free, hiding, puzzle-friendly)")]),e._v(" "),n("p",[e._v("算法：Dsha256(headerbytes)\nHeader字段：version(4)、prev_block_hash(32)、merkle_root_hash(32)、time(4)、bits(4)、nonce(4) 共80字节")]),e._v(" "),n("p",[e._v("每个块的第一个交易为coinbase交易，没有input，output是矿工地址，数量是区块奖励和所有交易费用的总和")]),e._v(" "),n("p",[e._v("每个交易的txhash生成merkle tree，并生成merkle root hash放在header中；")]),e._v(" "),n("p",[e._v("Merkle tree也用于BT下载")]),e._v(" "),n("p",[e._v("私钥生成：随机数或者通过随机数seed生成\n公钥生成：pubkey=椭圆曲线函数（prikey,p,q）不可逆\n比特币地址生成：address=Base58(pub key hash)=Base58（RIPEMD160(SHA256(PUBKEY))）不可逆")]),e._v(" "),n("p",[n("strong",[e._v("P2PKH (pay to public key hash)")])]),e._v(" "),n("p",[e._v("HASH160 = RIPEMD160(SHA256(pubkey))\nPubkey Script: OP_DUP OP_HASH160 "),n("PubKeyHash",[e._v(" OP_EQUALVERIFY OP_CHECKSIG\n"),n("Sig",[n("PubKey",[e._v(" OP_DUP OP_HASH160 "),n("PubKeyHash",[e._v(" OP_EQUALVERIFY OP_CHECKSIG")])],1)],1)],1)],1),e._v(" "),n("p",[n("strong",[e._v("Advanced Keys and Addresses")])]),e._v(" "),n("p",[e._v("1)Encrypted Private Keys (BIP-38)\nBIP-38 proposes a common standard for encrypting private keys with a passphrase and encoding them with Base58Check so that they can be stored securely on backup media, transported securely between wallets, or kept in any other conditions where the key might be exposed. The standard for encryption uses the Advanced Encryption Standard (AES)")]),e._v(" "),n("p",[e._v("2)Pay-to-Script Hash (P2SH) and Multisig Addresses")]),e._v(" "),n("p",[e._v("通过BIP增加进比特币系统,可实现多重签名等")]),e._v(" "),n("p",[e._v("Redeem Script (input contains source script, output contains the hash)\nExample:")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("OP_2 [A’s pubkey] [B’s pubkey] [C’s pubkey] OP_3 OP_CHECKMULTISIG\n")])])]),n("p",[e._v("3)Vanity Addresses")]),e._v(" "),n("h3",{attrs:{id:"_3-4-wallets"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-wallets"}},[e._v("#")]),e._v(" 3.4 Wallets")]),e._v(" "),n("h4",{attrs:{id:"_3-4-1-nondeterministic-random-wallet-jbok-wallet-just-a-bunch-of-keys"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-1-nondeterministic-random-wallet-jbok-wallet-just-a-bunch-of-keys"}},[e._v("#")]),e._v(" 3.4.1 Nondeterministic(Random) wallet/JBOK wallet(Just a Bunch Of Keys)")]),e._v(" "),n("p",[e._v("The disadvantage of random keys is that if you generate many of them you must keep copies of all of them, meaning that the wallet must be backed up frequently. Each key must be backed up, or the funds it controls are irrevocably lost if the wallet becomes inaccessible. This conflicts directly with the principle of avoiding address reuse, by using each bitcoin address for only one transaction. Address reuse reduces privacy by associating multiple transactions and addresses with each other.")]),e._v(" "),n("p",[e._v("Paper Wallets\nAlthough you can deposit funds into a paper wallet several times, you should withdraw all funds only once, spending everything. This is because in the process of unlocking and spending funds some wallets might generate a change address if you spend less than the whole amount. Additionally, if the computer you use to sign the transaction is compromised, you risk exposing the private key. By spending the entire balance of a paper wallet only once, you reduce the risk of key compromise. If you need only a small amount, send any remaining funds to a new paper wallet in the same transaction.")]),e._v(" "),n("h4",{attrs:{id:"_3-4-2-deterministic-seeded-wallets"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-2-deterministic-seeded-wallets"}},[e._v("#")]),e._v(" 3.4.2 Deterministic (Seeded) Wallets")]),e._v(" "),n("p",[e._v("Deterministic wallet https://en.bitcoin.it/wiki/Deterministic_wallet")]),e._v(" "),n("p",[e._v("Type-1 deterministic (seeded) wallet: a deterministic sequence of keys derived from a seed\nType-2 HD wallet: a tree of keys generated from a single seed")]),e._v(" "),n("p",[n("strong",[e._v("Mnemonic code words, based on BIP-39")])]),e._v(" "),n("p",[n("a",{attrs:{href:"https://github.com/trezor/python-mnemonic",target:"_blank",rel:"noopener noreferrer"}},[e._v("python-mnemonic"),n("OutboundLink")],1),e._v("\nThe reference implementation of the standard by the SatoshiLabs team that proposed BIP-39, in Python\n"),n("a",{attrs:{href:"https://github.com/bitcoinjs/bip39",target:"_blank",rel:"noopener noreferrer"}},[e._v("bitcoinjs/bip39"),n("OutboundLink")],1),e._v("\nAn implementation of BIP-39, as part of the popular bitcoinJS framework, in JavaScript")]),e._v(" "),n("p",[e._v("https://iancoleman.github.io/bip39/")]),e._v(" "),n("p",[n("strong",[e._v("HD wallets, based on BIP-32")])]),e._v(" "),n("p",[e._v("Advantages:\nFirst, the tree structure can be used to express additional organizational meaning, such as when a specific branch of subkeys is used to receive incoming payments and a different branch is used to receive change from outgoing payments. Branches of keys can also be used in corporate settings, allocating different branches to departments, subsidiaries, specific functions, or accounting categories.\nThe second advantage of HD wallets is that users can create a sequence of public keys without having access to the corresponding private keys. This allows HD wallets to be used on an insecure server or in a receive-only capacity, issuing a different public key for each transaction. The public keys do not need to be preloaded or derived in advance, yet the server doesn’t have the private keys that can spend the funds.")]),e._v(" "),n("p",[n("img",{attrs:{src:"/docs/docs_image/blockchain/btc/btc_dev06.png",alt:""}})]),e._v(" "),n("p",[e._v("An extended key consists of a private or public key and chain code. An extended key can create children, generating its own branch in the tree structure. Sharing an extended key gives access to the entire branch.\nThis shortcut can be used to create very secure public key–only deployments where a server or application has a copy of an extended public key and no private keys whatsoever. That kind of deployment can produce an infinite number of public keys and bitcoin addresses, but cannot spend any of the money sent to those addresses. Meanwhile, on another, more secure server, the extended private key can derive all the corresponding private keys to sign transactions and spend the money.")]),e._v(" "),n("p",[e._v("Hardened child key derivation: "),n("code",[e._v("m / purpose' / coin_type' / account' / change / address_index")])]),e._v(" "),n("p",[e._v("Multipurpose HD wallet structure, based on BIP-43")]),e._v(" "),n("p",[e._v("Multicurrency and multiaccount wallets, based on BIP-44")]),e._v(" "),n("h3",{attrs:{id:"_3-5-transactions"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-5-transactions"}},[e._v("#")]),e._v(" 3.5 Transactions")]),e._v(" "),n("p",[e._v("global double-entry bookkeeping ledger\nAlthough an output can have any arbitrary value, once created it is indivisible. This is an important characteristic of outputs that needs to be emphasized: outputs are discrete and indivisible units of value, denominated in integer satoshis. An unspent output can only be consumed in its entirety by a transaction.")]),e._v(" "),n("p",[n("img",{attrs:{src:"/docs/docs_image/blockchain/btc/btc_dev07_1.png",alt:""}})]),e._v(" "),n("p",[n("strong",[e._v("Transaction Outputs")])]),e._v(" "),n("p",[e._v("●\tAn amount of bitcoin, denominated in satoshis, the smallest bitcoin unit\n●\tA cryptographic puzzle/locking script, a witness script, or a scriptPubKey that determines the conditions required to spend the output")]),e._v(" "),n("p",[n("img",{attrs:{src:"/docs/docs_image/blockchain/btc/btc_dev07.png",alt:""}})]),e._v(" "),n("p",[n("strong",[e._v("Transaction Inputs")]),e._v(" "),n("img",{attrs:{src:"/docs/docs_image/blockchain/btc/btc_dev08.png",alt:""}})]),e._v(" "),n("p",[n("strong",[e._v("Transaction Fees")])]),e._v(" "),n("p",[e._v("In Bitcoin Core, fee relay policies are set by the minrelaytxfee option. The current default minrelaytxfee is 0.00001 bitcoin or a hundredth of a millibitcoin per kilobyte. Therefore, by default, transactions with a fee less than 0.00001 bitcoin are treated as free and are only relayed if there is space in the mempool; otherwise, they are dropped.\nthird-party services for fee calculations: http://bitcoinfees.21.co\n"),n("span",{staticStyle:{color:"red"}},[e._v('If you forget to add a change output in a manually constructed transaction, you will be paying the change as a transaction fee. "Keep the change!" might not be what you intended.')])]),e._v(" "),n("p",[e._v("multiple input and output addresses in bitcoin transactions https://bitcoin.stackexchange.com/questions/74003/multiple-input-and-output-addresses-in-bitcoin-transactions")]),e._v(" "),n("p",[e._v("How did these zero-transaction fee transactions make it into the Bitcoin network? https://bitcoin.stackexchange.com/questions/69030/how-did-these-zero-transaction-fee-transactions-make-it-into-the-bitcoin-network")]),e._v(" "),n("p",[n("strong",[e._v("Reclaming disk space")]),e._v(" "),n("img",{attrs:{src:"/docs/docs_image/blockchain/btc/btc_dev08_2.png",alt:""}})]),e._v(" "),n("h4",{attrs:{id:"_3-5-1-transaction-scripts-and-script-language"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-5-1-transaction-scripts-and-script-language"}},[e._v("#")]),e._v(" 3.5.1 Transaction Scripts and Script Language")]),e._v(" "),n("p",[e._v('Historically, the locking script was called a scriptPubKey, because it usually contained a public key or bitcoin address (public key hash). In this book we refer to it as a "locking script" to acknowledge the much broader range of possibilities of this scripting technology. In most bitcoin applications, what we refer to as a locking script will appear in the source code as scriptPubKey. You will also see the locking script referred to as a witness script (see [segwit]) or more generally as a cryptographic puzzle. These terms all mean the same thing, at different levels of abstraction.\nHistorically, the unlocking script was called scriptSig, because it usually contained a digital signature. In most bitcoin applications, the source code refers to the unlocking script as scriptSig. You will also see the unlocking script referred to as a witness (see [segwit]). In this book, we refer to it as an "unlocking script" to acknowledge the much broader range of locking script requirements, because not all unlocking scripts must contain signatures.')]),e._v(" "),n("p",[n("img",{attrs:{src:"/docs/docs_image/blockchain/btc/btc_dev09.png",alt:""}})]),e._v(" "),n("h4",{attrs:{id:"_3-5-2-pay-to-public-key-hash-p2pkh"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-5-2-pay-to-public-key-hash-p2pkh"}},[e._v("#")]),e._v(" 3.5.2 Pay-to-Public-Key-Hash (P2PKH)")]),e._v(" "),n("p",[n("strong",[e._v("Digital Signatures (ECDSA")])]),e._v(" "),n("p",[e._v("First, the signature proves that the owner of the private key, who is by implication the owner of the funds, has authorized the spending of those funds. Secondly, the proof of authorization is undeniable (nonrepudiation). Thirdly, the signature proves that the transaction (or specific parts of the transaction) have not and cannot be modified by anyone after it has been signed.")]),e._v(" "),n("p",[n("img",{attrs:{src:"/docs/docs_image/blockchain/btc/btc_dev10.png",alt:""}})]),e._v(" "),n("p",[e._v("Sig = (R, S, SIGHASH)\nR and S are serialized into a byte-stream using an international standard encoding scheme called the Distinguished Encoding Rules, or DER.\nSignature Hash Types (SIGHASH):\n- ALL\n- NONE\n- SINGLE\n- ANYONECANPAY")]),e._v(" "),n("p",[n("img",{attrs:{src:"/docs/docs_image/blockchain/btc/btc_dev11.png",alt:""}})]),e._v(" "),n("p",[n("strong",[e._v("ECDSA Math AND The Importance of Randomness in Signatures")]),e._v("\nIf the same value k is used in the signing algorithm on two different transactions, the private key can be calculated and exposed to the world!\nTo avoid this vulnerability, the industry best practice is to not generate k with a random-number generator seeded with entropy, but instead to use a deterministic-random process seeded with the transaction data itself. This ensures that each transaction produces a different k. The industry-standard algorithm for deterministic initialization of k is defined in RFC 6979, published by the Internet Engineering Task Force.")]),e._v(" "),n("h3",{attrs:{id:"_3-6-advanced-transactions-and-scripting"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-6-advanced-transactions-and-scripting"}},[e._v("#")]),e._v(" 3.6 Advanced Transactions and Scripting")]),e._v(" "),n("p",[e._v("Transaction Script Language Operators, Constants, and Symbols\nhttps://en.bitcoin.it/wiki/Script")]),e._v(" "),n("p",[e._v("Common Bitcoin Script Templates https://bitcoinedge.org/tutorial/EN:scripting-transactions-p2pkh-p2wpkh-p2sh-p2wsh")]),e._v(" "),n("h4",{attrs:{id:"_3-6-1-multisignature"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-6-1-multisignature"}},[e._v("#")]),e._v(" 3.6.1 Multisignature")]),e._v(" "),n("p",[n("code",[e._v("0 <Signature B> <Signature C> 2 <Public Key A> <Public Key B> <Public Key C> 3 CHECKMULTISIG")])]),e._v(" "),n("h4",{attrs:{id:"_3-6-2-pay-to-script-hash-p2sh"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-6-2-pay-to-script-hash-p2sh"}},[e._v("#")]),e._v(" 3.6.2 Pay-to-Script-Hash (P2SH)")]),e._v(" "),n("p",[n("code",[e._v("<Sig1> <Sig2> <2 PK1 PK2 PK3 PK4 PK5 5 CHECKMULTISIG> <2 PK1 PK2 PK3 PK4 PK5 5 CHECKMULTISIG> HASH160 <redeem scriptHash> EQUAL <Sig1> <Sig2> 2 PK1 PK2 PK3 PK4 PK5 5 CHECKMULTISIG")])]),e._v(" "),n("p",[e._v("P2SH locking scripts contain the hash of a redeem script, which gives no clues as to the content of the redeem script itself. The P2SH transaction will be considered valid and accepted even if the redeem script is invalid. You might accidentally lock bitcoin in such a way that it cannot later be spent.")]),e._v(" "),n("h4",{attrs:{id:"_3-6-3-data-recording-output-return"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-6-3-data-recording-output-return"}},[e._v("#")]),e._v(" 3.6.3 Data Recording Output (RETURN)")]),e._v(" "),n("p",[e._v('In version 0.9 of the Bitcoin Core client, a compromise was reached with the introduction of the RETURN operator. RETURN allows developers to add 80 bytes of nonpayment data to a transaction output. However, unlike the use of "fake" UTXO, the RETURN operator creates an explicitly provably unspendable output, which does not need to be stored in the UTXO set.\nRETURN '),n("data")]),e._v(" "),n("h4",{attrs:{id:"_3-6-4-timelocks"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-6-4-timelocks"}},[e._v("#")]),e._v(" 3.6.4 Timelocks")]),e._v(" "),n("p",[e._v("sequence number & nlocktime:")]),e._v(" "),n("ul",[n("li",[e._v("nLocktimer >=5亿，表示时间，<5亿，表示block高度")]),e._v(" "),n("li",[e._v("sequence number UTXO成熟度")])]),e._v(" "),n("p",[e._v("Bitcoin Timelocks in a nutshell https://medium.com/@RobinHung/bitcoin-timelocks-in-a-nutshell-4c95aafc7a59")]),e._v(" "),n("p",[e._v("Block time:\nThe block time is the average time it takes for the network to generate one extra block in the blockchain. Some blockchains create a new block as frequently as every five seconds.[28] By the time of block completion, the included data becomes verifiable. In cryptocurrency, this is practically when the transaction takes place, so a shorter block time means faster transactions. The block time for Ethereum is set to between 14 and 15 seconds, while for bitcoin it is 10 minutes.")]),e._v(" "),n("p",[e._v("Block height:\nas it pertains to cryptocurrency, refers to the current number block in a blockchain. The genesis block, which is the very first block in any blockchain, has a block height equal to zero. Therefore, the block height is always a positive integer greater than zero.")]),e._v(" "),n("p",[e._v("The Mystery Behind Block Time https://medium.facilelogin.com/the-mystery-behind-block-time-63351e35603a")]),e._v(" "),n("p",[e._v("Transaction script with block height as condition\nhttps://bitcointalk.org/index.php?topic=115084.0")]),e._v(" "),n("p",[n("strong",[e._v("Transaction level lock")])]),e._v(" "),n("p",[e._v("1)Transaction Locktime (nLocktime)")]),e._v(" "),n("p",[e._v("If nLocktime is nonzero and below 500 million, it is interpreted as a block height, meaning the transaction is not valid and is not relayed or included in the blockchain prior to the specified block height. If it is above 500 million, it is interpreted as a Unix Epoch timestamp (seconds since Jan-1-1970) and the transaction is not valid prior to the specified time.")]),e._v(" "),n("p",[e._v("2)Relative Timelocks - nSequence as a consensus-enforced relative timelock\nBIP-68, Relative lock-time using consensus-enforced sequence numbers")]),e._v(" "),n("p",[n("strong",[e._v("UTXO level lock")])]),e._v(" "),n("p",[e._v("1)Check Lock Time Verify (CLTV )")]),e._v(" "),n("p",[e._v("BIP-65 (CHECKLOCKTIMEVERIFY).\n<now + 3 months> CHECKLOCKTIMEVERIFY DROP DUP HASH160 <Bob's Public Key Hash> EQUALVERIFY CHECKSIG")]),e._v(" "),n("p",[e._v("2)Relative Timelocks - (CSV)")]),e._v(" "),n("p",[e._v('BIP-112, CHECKSEQUENCEVERIFY.\nRelative timelocks with CSV are especially useful when several (chained) transactions are created and signed, but not propagated, when they’re kept "off-chain." A child transaction cannot be used until the parent transaction has been propagated, mined, and aged by the time specified in the relative timelock. One application of this use case can be seen in [state_channels] and [lightning_network].')]),e._v(" "),n("p",[n("strong",[e._v("Median-Time-Past")])]),e._v(" "),n("p",[e._v("BIP-113.The consensus time calculated by Median-Time-Past is always approximately one hour behind wall clock time. If you create timelock transactions, you should account for it when estimating the desired value to encode in nLocktime, nSequence, CLTV, and CSV.")]),e._v(" "),n("p",[n("strong",[e._v("Timelock Defense Against Fee Sniping")])]),e._v(" "),n("h4",{attrs:{id:"_3-6-5-scripts-with-flow-control-conditional-clauses"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-6-5-scripts-with-flow-control-conditional-clauses"}},[e._v("#")]),e._v(" 3.6.5 Scripts with Flow Control (Conditional Clauses)")]),e._v(" "),n("p",[e._v("Bitcoin implements flow control using the IF, ELSE, ENDIF, and NOTIF opcodes. Additionally, conditional expressions can contain boolean operators such as BOOLAND, BOOLOR, and NOT.\nConditional Clauses with VERIFY Opcodes")]),e._v(" "),n("p",[e._v("An opcode such as EQUAL will push the result (TRUE/FALSE) onto the stack, leaving it there for evaluation by subsequent opcodes. In contrast, the opcode EQUALVERIFY suffix does not leave anything on the stack. Opcodes that end in VERIFY do not leave the result on the stack.")]),e._v(" "),n("h4",{attrs:{id:"_3-6-6-segregated-witness"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-6-6-segregated-witness"}},[e._v("#")]),e._v(" 3.6.6 Segregated Witness")]),e._v(" "),n("p",[e._v("In the context of bitcoin, a digital signature is one type of witness, but a witness is more broadly any solution that can satisfy the conditions imposed on an UTXO and unlock that UTXO for spending. The term “witness” is a more general term for an “unlocking script” or “scriptSig.”\nBIP-141\nThe main definition of Segregated Witness.\nBIP-143\nTransaction Signature Verification for Version 0 Witness Program\nBIP-144\nPeer Services—New network messages and serialization formats\nBIP-145\ngetblocktemplate Updates for Segregated Witness (for mining)\nBIP-173\nBase32 address format for native v0-16 witness outputs")]),e._v(" "),n("p",[n("strong",[e._v("Pay-to-Witness-Public-Key-Hash (P2WPKH)")])]),e._v(" "),n("p",[e._v("The public key hash in P2WPKH is 20 bytes\nP2WPKH should be constructed by the payee (recipient) by converting a compressed public key to a P2WPKH hash. You should never transform a P2PKH script, bitcoin address, or uncompressed public key to a P2WPKH witness script.")]),e._v(" "),n("p",[n("img",{attrs:{src:"/docs/docs_image/blockchain/btc/btc_dev12.png",alt:""}})]),e._v(" "),n("p",[n("strong",[e._v("Pay-to-Witness-Script-Hash (P2WSH)")])]),e._v(" "),n("p",[e._v("The script hash in P2WSH is 32 bytes\nWhile P2SH uses the 20-byte RIPEMD160(SHA256(script)) hash, the P2WSH witness program uses a 32-byte SHA256(script) hash. This difference in the selection of the hashing algorithm is deliberate and is used to differentiate between the two types of witness programs (P2WPKH and P2WSH) by the length of the hash and to provide stronger security to P2WSH (128 bits of security in P2WSH versus 80 bits of security in P2SH).")]),e._v(" "),n("p",[e._v("1)Pay-to-Witness-Public-Key-Hash inside Pay-to-Script-Hash")]),e._v(" "),n("p",[e._v("2)Pay-to-Witness-Script-Hash inside Pay-to-Script-Hash")]),e._v(" "),n("p",[e._v("Segregated Witness transactions have two IDs: txid and wtxid. The txid is the hash of the transaction without the witness data and the wtxid is the hash inclusive of witness data. The txid of a transaction where all inputs are segwit inputs is not susceptible to third-party transaction malleability.")]),e._v(" "),n("h3",{attrs:{id:"_3-7-the-bitcoin-network"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-7-the-bitcoin-network"}},[e._v("#")]),e._v(" 3.7 The Bitcoin Network")]),e._v(" "),n("p",[n("img",{attrs:{src:"/docs/docs_image/blockchain/btc/btc_dev13_1.png",alt:""}})]),e._v(" "),n("p",[e._v('The term "bitcoin network" refers to the collection of nodes running the bitcoin P2P protocol. In addition to the bitcoin P2P protocol, there are other protocols such as Stratum that are used for mining and lightweight or mobile wallets. These additional protocols are provided by gateway routing servers that access the bitcoin network using the bitcoin P2P protocol and then extend that network to nodes running other protocols.')]),e._v(" "),n("p",[n("img",{attrs:{src:"/docs/docs_image/blockchain/btc/btc_dev13.png",alt:""}})]),e._v(" "),n("p",[e._v("Bitcoin Relay Networks => Fast Internet Bitcoin Relay Engine or FIBRE =>Falcon\nNetwork Discovery")]),e._v(" "),n("p",[n("strong",[e._v("SPV Nodes")])]),e._v(" "),n("p",[n("img",{attrs:{src:"/docs/docs_image/blockchain/btc/btc_dev_spv01.png",alt:""}})]),e._v(" "),n("p",[e._v("SPV verifies transactions by reference to their depth in the blockchain instead of their height.\nwhen examining a transaction in block 300,000,the SPV node will establish a link between the transaction and the block that contains it, using a merkle path (see [merkle_trees]). Then, the SPV node waits until it sees the six blocks 300,001 through 300,006 piled on top of the block containing the transaction and verifies it by establishing its depth under blocks 300,006 to 300,001.")]),e._v(" "),n("p",[e._v("Risks:")]),e._v(" "),n("ol",[n("li",[e._v("An SPV node can definitely prove that a transaction exists but cannot verify that a transaction, such as a double-spend of the same UTXO, doesn’t exist because it doesn’t have a record of all transactions. This vulnerability can be used in a denial-of-service attack or for a double-spending attack against SPV nodes.\nMitigate: random nodes")]),e._v(" "),n("li",[e._v("privacy risk, for example, a third party monitoring a network could keep track of all the transactions requested by a wallet on an SPV node and use those to associate bitcoin addresses with the user of that wallet, destroying the user’s privacy.\nSolve:  bloom filter The network protocol and bloom filter mechanism for SPV nodes is defined in BIP-37 (Peer Services).")])]),e._v(" "),n("p",[n("strong",[e._v("Encrypted and Authenticated Connections")])]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[e._v("there are two solutions that provide encryption of the communications: Tor Transport and P2P Authentication and Encryption with BIP-150/151\n")])])]),n("p",[n("strong",[e._v("Transaction Pools/mempool and orphan pool vs UTXO pool")])]),e._v(" "),n("p",[e._v("orphan pool: If a transaction’s inputs refer to a transaction that is not yet known, such as a missing parent\nWhen a transaction is added to the transaction pool, the orphan pool is checked for any orphans that reference this transaction’s outputs (its children). Any matching orphans are then validated. If valid, they are removed from the orphan pool and added to the transaction pool, completing the chain that started with the parent transaction. In light of the newly added transaction, which is no longer an orphan, the process is repeated recursively looking for any further descendants, until no more descendants are found.\nUTXO pool\nUnlike the transaction and orphan pools, the UTXO pool is not initialized empty but instead contains millions of entries of unspent transaction outputs, everything that is unspent from all the way back to the genesis block. The UTXO pool may be housed in local memory or as an indexed database table on persistent storage.\nWhereas the transaction and orphan pools represent a single node’s local perspective and might vary significantly from node to node depending upon when the node was started or restarted, the UTXO pool represents the emergent consensus of the network and therefore will vary little between nodes. Furthermore, the transaction and orphan pools only contain unconfirmed transactions, while the UTXO pool only contains confirmed outputs.")]),e._v(" "),n("h3",{attrs:{id:"_3-8-the-blockchain"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-8-the-blockchain"}},[e._v("#")]),e._v(" 3.8 The Blockchain")]),e._v(" "),n("p",[n("img",{attrs:{src:"/docs/docs_image/blockchain/btc/btc_dev14.png",alt:""}})]),e._v(" "),n("p",[e._v("Block Identifiers: Block Header Hash and Block Height\nThe cryptographic hash algorithm used in bitcoin’s merkle trees is SHA256 applied twice, also known as double-SHA256\nMerkle Trees and Simplified Payment Verification (SPV)\nSPV node that is interested in incoming payments to an address contained in its wallet. The SPV node will establish a bloom filter (see [bloom_filters]) on its connections to peers to limit the transactions received to only those containing addresses of interest. When a peer sees a transaction that matches the bloom filter, it will send that block using a merkleblock message. The merkleblock message contains the block header as well as a merkle path that links the transaction of interest to the merkle root in the block. The SPV node can use this merkle path to connect the transaction to the block and verify that the transaction is included in the block. The SPV node also uses the block header to link the block to the rest of the blockchain. The combination of these two links, between the transaction and block, and between the block and blockchain, proves that the transaction is recorded in the blockchain.")]),e._v(" "),n("p",[e._v("SPV merkle root\nhttps://bitcoin.org/en/developer-reference#merkle-trees")]),e._v(" "),n("p",[e._v("Bloom filter")]),e._v(" "),n("h3",{attrs:{id:"_3-9-mining-and-consensus"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-9-mining-and-consensus"}},[e._v("#")]),e._v(" 3.9 Mining and Consensus")]),e._v(" "),n("p",[e._v("Decentralized Consensus\nIndependent Verification of Transactions")]),e._v(" "),n("p",[n("img",{attrs:{src:"/docs/docs_image/blockchain/btc/btc_dev15.png",alt:""}})]),e._v(" "),n("p",[e._v("**Mine **\nmining is the process of hashing the block header repeatedly, changing one parameter, until the resulting hash matches a specific target.\nValidating a New Block")]),e._v(" "),n("p",[n("img",{attrs:{src:"/docs/docs_image/blockchain/btc/btc_dev16.png",alt:""}})]),e._v(" "),n("p",[n("strong",[e._v("Assembling and Selecting Chains of Blocks")])]),e._v(" "),n("p",[e._v("Nodes maintain three sets of blocks: those connected to the main blockchain, those that form branches off the main blockchain (secondary chains), and finally, blocks that do not have a known parent in the known chains (orphans).\nthe longest chain or greatest cumulative work chain")]),e._v(" "),n("p",[n("strong",[e._v("Blockchain forks and Consensus development")])]),e._v(" "),n("p",[e._v("temporary inconsistencies fork /spontaneous fork, reconverge")]),e._v(" "),n("p",[e._v("Hark fork")]),e._v(" "),n("p",[e._v("stages: a software fork, a network fork, a mining fork, and a chain fork.\nDiverging Miners and Difficulty")]),e._v(" "),n("p",[e._v("Soft fork:is a forward-compatible change to the consensus rules that allows unupgraded clients to continue to operate in consensus with the new rules")]),e._v(" "),n("p",[e._v('how:\nredefining NOP opcodes\nOther ways like segwit\nSoft Fork Signaling with Block Version\nBIP-34 Signaling and Activation:\nBIP-66 Strict DER Encoding of Signatures was activated by BIP-34 style signaling with a block version "3" and invalidating version "2" blocks.\nBIP-65 CHECKLOCKTIMEVERIFY was activated by BIP-34 style signaling with a block version "4" and invalidating version "3" blocks.\nAfter the activation of BIP-65, the signaling and activation mechanism of BIP-34 was retired and replaced with the BIP-9 signaling mechanism described next.\nBIP-9 Signaling and Activation')]),e._v(" "),n("p",[n("img",{attrs:{src:"/docs/docs_image/blockchain/btc/btc_dev17.png",alt:""}})]),e._v(" "),n("h3",{attrs:{id:"_3-10-bitcoin-security"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-10-bitcoin-security"}},[e._v("#")]),e._v(" 3.10 Bitcoin Security")]),e._v(" "),n("p",[e._v("don’t take control of keys away from users and don’t take transactions off the blockchain.")]),e._v(" "),n("p",[e._v("Consensus Attacks，参考 blockchain_indepth btc_indepth")]),e._v(" "),n("h3",{attrs:{id:"_3-11-blockchain-applications"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-11-blockchain-applications"}},[e._v("#")]),e._v(" 3.11 Blockchain Applications")]),e._v(" "),n("h4",{attrs:{id:"_3-11-1-building-blocks-primitives"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-11-1-building-blocks-primitives"}},[e._v("#")]),e._v(" 3.11.1 Building Blocks (Primitives)")]),e._v(" "),n("p",[e._v("No Double-Spend\nImmutability\nNeutrality\nSecure Timestamping\nAuthorization\nAuditability\nAccounting\nNonexpiration\nIntegrity\nTransaction Atomicity\nDiscrete (Indivisible) Units of Value\nQuorum of Control\nTimelock/Aging\nReplication\nForgery Protection\nConsistency\nRecording External State (OP_RETURN)\nPredictable Issuance")]),e._v(" "),n("h4",{attrs:{id:"_3-11-2-applications-from-building-blocks"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-11-2-applications-from-building-blocks"}},[e._v("#")]),e._v(" 3.11.2 Applications from Building Blocks")]),e._v(" "),n("p",[e._v("Proof-of-Existence (Digital Notary): Immutability + Timestamp + Durability\nKickstarter (Lighthouse): Consistency + Atomicity + Integrity.\nPayment Channels: Quorum of Control + Timelock + No Double Spend + Nonexpiration + Censorship Resistance + Authorization")]),e._v(" "),n("p",[e._v("Colored Coins")]),e._v(" "),n("p",[e._v("Counterparty")]),e._v(" "),n("p",[e._v("Payment Channels and State Channels:\nSimple Trustless Channels with sequence Timelocks commitment")]),e._v(" "),n("p",[n("img",{attrs:{src:"/docs/docs_image/blockchain/btc/btc_dev18.png",alt:""}})]),e._v(" "),n("p",[n("strong",[e._v("Asymmetric Revocable Commitments")]),e._v("\nTwo asymmetric commitment transactions with delayed payment for the party holding the transaction\nThe revocation key is composed of two secrets, each half generated independently by each channel participant.")]),e._v(" "),n("p",[n("strong",[e._v("Hash Time Lock Contracts (HTLC)")])]),e._v(" "),n("p",[n("img",{attrs:{src:"/docs/docs_image/blockchain/btc/btc_dev19.png",alt:""}})]),e._v(" "),n("p",[n("strong",[e._v("Routed Payment Channels (Lightning Network):")])]),e._v(" "),n("p",[e._v("Whitepaper: The Bitcoin Lightning Network:Scalable Off-Chain Instant Payments\nhttps://lightning.network/lightning-network-paper.pdf\nImplementation:Basics of Lightning Technology (BOLT) paper\nhttps://github.com/lightningnetwork/lightning-rfc/blob/master/00-introduction.md\nLightning Network Transport and Routing\nhttps://bitfury.com/content/downloads/whitepaper_flare_an_approach_to_routing_in_lightning_network_7_7_2016.pdf")]),e._v(" "),n("p",[n("img",{attrs:{src:"/docs/docs_image/blockchain/btc/btc_dev20.png",alt:""}})]),e._v(" "),n("hr"),e._v(" "),n("h2",{attrs:{id:"如何购买"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#如何购买"}},[e._v("#")]),e._v(" 如何购买")]),e._v(" "),n("p",[n("a",{attrs:{href:"https://www.coinhako.com/affiliations/sign_up/LYHISTORY_76989",target:"_blank",rel:"noopener noreferrer"}},[e._v("推荐coinhako,目前有赠送活动"),n("OutboundLink")],1)]),e._v(" "),n("disqus"),e._v(" "),n("p",[e._v("ref:")]),e._v(" "),n("p",[e._v("https://nakamotoinstitute.org/")])],1)}),[],!1,null,null,null);t.default=a.exports}}]);