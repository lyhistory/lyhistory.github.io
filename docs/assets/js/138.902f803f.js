(window.webpackJsonp=window.webpackJsonp||[]).push([[138],{568:function(n,e,t){"use strict";t.r(e);var s=t(65),r=Object(s.a)({},(function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[t("p",[n._v("token script study")]),n._v(" "),t("p",[n._v("https://www.tokenscript.org/")]),n._v(" "),t("p",[n._v("https://community.tokenscript.org/")]),n._v(" "),t("p",[n._v("https://medium.com/alphawallet/tokenscript/home")]),n._v(" "),t("h2",{attrs:{id:"tokenscript"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#tokenscript"}},[n._v("#")]),n._v(" TokenScript")]),n._v(" "),t("p",[n._v("https://github.com/TokenScript/TokenScript/tree\nhttps://github.com/TokenScript/TokenScriptTestContracts/tree/master\nhttps://github.com/TokenScript/TokenScript-Examples/tree/master/tutorial")]),n._v(" "),t("h3",{attrs:{id:"example-entrytoken"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#example-entrytoken"}},[n._v("#")]),n._v(" example: EntryToken")]),n._v(" "),t("p",[n._v("EntryToken.sol")]),n._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v("pragma solidity ^0.4.25; //\n\ncontract EntryToken\n\n{\n\n    mapping(address => uint256[]) inventory;\n\n    uint256[] public spawnedTokens;\n\n    mapping(bytes32 => bool) signatureChecked;\n\n    address public organiser;\n\n    address public paymaster;\n\n    string public name;\n\n    uint8 public constant decimals = 0; //no decimals as Tokens cannot be split\n\n    bool expired = false;\n\n    string public state;\n\n    string public locality;\n\n    string public street;\n\n    string public building;\n\n    string public symbol;\n\n    bytes4 balHash = bytes4(keccak256('balanceOf(address)'));\n\n    bytes4 tradeHash =\nbytes4(keccak256('trade(uint256,uint256[],uint8,bytes32,bytes32)'));\n\n    bytes4 passToHash =\nbytes4(keccak256('passTo(uint256,uint256[],uint8,bytes32,bytes32,address)'));\n\n    bytes4 spawnPassToHash =bytes4(keccak256('spawnPassTo(uint256,uint256[],uint8,bytes32,bytes32,address)'\n));\n\n \n\n    event Transfer(address indexed _to, uint256 count);\n\n    event TransferFrom(address indexed _from, address indexed _to, uint256\ncount);\n\n    event Trade(address indexed seller, uint256[] TokenIndices, uint8 v, bytes32\nr, bytes32 s);\n\n    event PassTo(uint256[] TokenIndices, uint8 v, bytes32 r, bytes32 s, address\nindexed recipient);\n\n \n\n    modifier organiserOnly()\n\n    {\n\n        require(msg.sender == organiser);\n\n        _;\n\n    }\n\n \n\n    modifier payMasterOnly()\n\n    {\n\n        require(msg.sender == paymaster);\n\n        _;\n\n    }\n\n \n\n    function() payable public { revert(); } //should not send any ether directly\n\n \n\n    constructor (\n\n        uint256[] Tokens,\n\n        string buildingName,\n\n        string streetName,\n\n        string localityName,\n\n        string stateName,\n\n        string symbolName,\n\n        string contractName) public\n\n    {\n\n        organiser = msg.sender;\n\n        paymaster = msg.sender;\n\n        inventory[msg.sender] = Tokens;\n\n        building = buildingName;\n\n        street = streetName;\n\n        locality = localityName;\n\n        state = stateName;\n\n        symbol = symbolName;\n\n        name = contractName;\n\n    }\n\n \n\n    function supportsInterface(bytes4 interfaceID) external view returns (bool)\n\n    {\n\n        if(interfaceID == balHash\n\n        || interfaceID == tradeHash\n\n        || interfaceID == passToHash\n\n        || interfaceID == spawnPassToHash) return true;\n\n        return false;\n\n    }\n\n \n\n    function isExpired(uint256 tokenId) public view returns(bool)\n\n    {\n\n        return expired;\n\n    }\n\n \n\n    function getStreet(uint256 tokenId) public view returns(string)\n\n    {\n\n        return street;\n\n    }\n\n \n\n    function getBuildingName(uint256 tokenId) public view returns(string)\n\n    {\n\n        return building;\n\n    }\n\n \n\n    function getState(uint256 tokenId) public view returns(string)\n\n    {\n\n        return state;\n\n    }\n\n \n\n    function getLocality(uint256 tokenId) public view returns(string)\n\n    {\n\n        return locality;\n\n    }\n\n \n\n    function getDecimals() public pure returns(uint)\n\n    {\n\n        return decimals;\n\n    }\n\n \n\n    function name() public view returns(string)\n\n    {\n\n        return name;\n\n    }\n\n \n\n    function setExpired(uint256[] tokenIds, bool isExpired) public organiserOnly\n\n    {\n\n        expired = isExpired;\n\n    }\n\n \n\n    function setStreet(uint256[] tokenIds, string newStreet) public\norganiserOnly returns(string)\n\n    {\n\n        street = newStreet;\n\n    }\n\n \n\n    function setBuilding(uint256[] tokenIds, string newBuildingName) public\norganiserOnly returns(string)\n\n    {\n\n        building = newBuildingName;\n\n    }\n\n \n\n    function setState(uint256[] tokenIds, string newState) public organiserOnly\nreturns(string)\n\n    {\n\n        state = newState;\n\n    }\n\n \n\n    function setLocality(uint256[] tokenIds, string newLocality) public organiserOnly returns(string)\n\n    {\n\n        locality = newLocality;\n\n    }\n\n \n\n    // example: 0, [3, 4], 27, \"0x9CAF1C785074F5948310CD1AA44CE2EFDA0AB19C308307610D7BA2C74604AE98\", \"0x23D8D97AB44A2389043ECB3C1FB29C40EC702282DB6EE1D2B2204F8954E4B451\"\n\n    // price is encoded in the server and the msg.value is added to the message digest,\n\n    // if the message digest is thus invalid then either the price or something else in the message is invalid\n\n    function trade(uint256 expiry,\n\n                   uint256[] TokenIndices,\n\n                   uint8 v,\n\n                   bytes32 r,\n\n                   bytes32 s) public payable\n\n    {\n\n        //checks expiry timestamp,\n\n        //if fake timestamp is added then message verification will fail\n\n        require(expiry > block.timestamp || expiry == 0);\n\n \n\n        bytes32 message = encodeMessage(msg.value, expiry, TokenIndices);\n\n        address seller = ecrecover(message, v, r, s);\n\n       \n\n        require(seller == organiser); //only contract owner can issue magiclinks\n\n \n\n        for(uint i = 0; i < TokenIndices.length; i++)\n\n        { // transfer each individual Tokens in the ask order\n\n            uint256 index = TokenIndices[i];\n\n            assert(inventory[seller][index] != uint256(0)); // 0 means Token gone.\n\n            inventory[msg.sender].push(inventory[seller][index]);\n\n            // 0 means Token gone.\n\n            delete inventory[seller][index];\n\n        }\n\n        seller.transfer(msg.value);\n\n \n\n        emit Trade(seller, TokenIndices, v, r, s);\n\n    }\n\n \n\n    function loadNewTokens(uint256[] Tokens) public organiserOnly\n\n    {\n\n        for(uint i = 0; i < Tokens.length; i++)\n\n        {\n\n            inventory[organiser].push(Tokens[i]);\n\n        }\n\n   }\n\n \n\n    //for new Tokens to be created and given over\n\n    //this requires a special magic link format with tokenids inside rather than indicies\n\n    function spawnPassTo(uint256 expiry,\n\n                    uint256[] Tokens,\n\n                    uint8 v,\n\n                    bytes32 r,\n\n                    bytes32 s,\n\n                    address recipient) public payable\n\n    {\n\n        require(expiry > block.timestamp || expiry == 0);\n\n        bytes32 message = encodeMessageSpawnable(msg.value, expiry, Tokens);\n\n        address giver = ecrecover(message, v, r, s);\n\n        //only the organiser can authorise this\n\n        require(giver == organiser);\n\n        require(!signatureChecked[s]);\n\n        organiser.transfer(msg.value);\n\n        for(uint i = 0; i < Tokens.length; i++)\n\n        {\n\n            inventory[recipient].push(Tokens[i]);\n\n            //log each spawned Token used for a record\n\n            spawnedTokens.push(Tokens[i]);\n\n        }\n\n        //prevent link being reused with the same signature\n\n        signatureChecked[s] = true;\n\n    }\n\n \n\n           //check if a spawnable Token that created in a magic link is redeemed\n\n    function spawned(uint256 Token) public view returns (bool)\n\n    {\n\n        for(uint i = 0; i < spawnedTokens.length; i++)\n\n        {\n\n            if(spawnedTokens[i] == Token)\n\n            {\n\n                return true;\n\n            }\n\n        }\n\n        return false;\n\n    }\n\n \n\n    function passTo(uint256 expiry,\n\n                    uint256[] TokenIndices,\n\n                    uint8 v,\n\n                    bytes32 r,\n\n                    bytes32 s,\n\n                    address recipient) public organiserOnly\n\n    {\n\n        require(expiry > block.timestamp || expiry == 0);\n\n        bytes32 message = encodeMessage(0, expiry, TokenIndices);\n\n        address giver = ecrecover(message, v, r, s);\n\n        for(uint i = 0; i < TokenIndices.length; i++)\n\n        {\n\n            uint256 index = TokenIndices[i];\n\n            //needs to use revert as all changes should be reversed\n\n            //if the user doesnt't hold all the Tokens\n\n            assert(inventory[giver][index] != uint256(0));\n\n            uint256 Token = inventory[giver][index];\n\n            inventory[recipient].push(Token);\n\n            delete inventory[giver][index];\n\n        }\n\n        emit PassTo(TokenIndices, v, r, s, recipient);\n\n    }\n\n \n\n    // Pack value, expiry, Tokens into 1 array\n\n    function encodeMessage(uint value, uint expiry, uint256[] TokenIndices)\n\n        internal view returns (bytes32)\n\n    {\n\n        bytes memory message = new bytes(84 + TokenIndices.length * 2);\n\n        address contractAddress = getThisContractAddress();\n\n        for (uint i = 0; i < 32; i++)\n\n        {\n\n            message[i] = byte(bytes32(value << (8 * i)));\n\n        }\n\n \n\n        for (i = 0; i < 32; i++)\n\n        {\n\n            message[i + 32] = byte(bytes32(expiry << (8 * i)));\n\n        }\n\n \n\n        for(i = 0; i < 20; i++)\n\n        {\n\n            message[64 + i] = byte(bytes20(contractAddress) << (8 * i));\n\n        }\n\n \n\n        for (i = 0; i < TokenIndices.length; i++)\n\n        {\n\n            message[84 + i * 2 ] = byte(TokenIndices[i] >> 8);\n\n            message[84 + i * 2 + 1] = byte(TokenIndices[i]);\n\n        }\n\n \n\n        return keccak256(message);\n\n    }\n\n \n\n    // Pack value, expiry, Tokens into 1 array\n\n    function encodeMessageSpawnable(uint value, uint expiry, uint256[] Tokens)\n\n        internal view returns (bytes32)\n\n    {\n\n        bytes memory message = new bytes(84 + Tokens.length * 32);\n\n        address contractAddress = getThisContractAddress();\n\n        for (uint i = 0; i < 32; i++)\n\n        {\n\n            message[i] = byte(bytes32(value << (8 * i)));\n\n        }\n\n \n\n        for (i = 0; i < 32; i++)\n\n        {\n\n            message[i + 32] = byte(bytes32(expiry << (8 * i)));\n\n        }\n\n \n\n        for(i = 0; i < 20; i++)\n\n        {\n\n            message[64 + i] = byte(bytes20(contractAddress) << (8 * i));\n\n        }\n\n \n\n        for (i = 0; i < Tokens.length; i++)\n\n        {\n\n            for (uint j = 0; j < 32; j++)\n\n            {\n\n                message[84 + i * 32 + j] = byte(bytes32(Tokens[i] << (8 * j)));\n\n            }\n\n        }\n\n        return keccak256(message);\n\n    }\n\n \n\n    function getSymbol() public view returns(string)\n\n    {\n\n        return symbol;\n\n    }\n\n \n\n    function balanceOf(address _owner) public view returns (uint256[])\n\n    {\n\n        return inventory[_owner];\n\n    }\n\n \n\n    function myBalance() public view returns(uint256[])\n\n    {\n\n        return inventory[msg.sender];\n\n    }\n\n \n\n    function transfer(address _to, uint256[] TokenIndices) organiserOnly public\n\n    {\n\n        for(uint i = 0; i < TokenIndices.length; i++)\n\n        {\n\n            uint index = uint(TokenIndices[i]);\n\n            require(inventory[msg.sender][index] != uint256(0));\n\n            //pushes each element with ordering\n\n            inventory[_to].push(inventory[msg.sender][index]);\n\n            delete inventory[msg.sender][index];\n\n        }\n\n        emit Transfer(_to, TokenIndices.length);\n\n    }\n\n \n\n    function transferFrom(address _from, address _to, uint256[] TokenIndices)\n\n        organiserOnly public\n\n    {\n\n        for(uint i = 0; i < TokenIndices.length; i++)\n\n        {\n\n            uint index = uint(TokenIndices[i]);\n\n            require(inventory[_from][index] != uint256(0));\n\n            //pushes each element with ordering\n\n            inventory[_to].push(inventory[_from][index]);\n\n            delete inventory[_from][index];\n\n        }\n\n        emit TransferFrom(_from, _to, TokenIndices.length);\n\n    }\n\n \n\n    function endContract() public organiserOnly\n\n    {\n\n        selfdestruct(organiser);\n\n    }\n\n \n\n    function isStormBirdContract() public pure returns (bool)\n\n    {\n\n        return true;\n\n    }\n\n \n\n    function getThisContractAddress() public view returns(address)\n\n    {\n\n        return this;\n\n    }\n\n}\n")])])]),t("p",[n._v("EntryToken.xml:")]),n._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v('<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n<ts:token xmlns:ethereum="urn:ethereum:constantinople"\n          xmlns:ts="http://tokenscript.org/2020/06/tokenscript"\n          xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n          name="entrytoken"\n          xsi:schemaLocation="http://tokenscript.org/2020/06/tokenscript http://tokenscript.org/2020/06/tokenscript.xsd"\n>\n  <ts:label>\n    <ts:plurals xml:lang="en">\n      <ts:string quantity="one">Ticket</ts:string>\n      <ts:string quantity="other">Tickets</ts:string>\n    </ts:plurals>\n    <ts:plurals xml:lang="es">\n      <ts:string quantity="one">Boleto de admisión</ts:string>\n      <ts:string quantity="other">Boleto de admisiónes</ts:string>\n    </ts:plurals>\n    <ts:plurals xml:lang="zh">\n      <ts:string quantity="one">入場券</ts:string>\n      <ts:string quantity="other">入場券</ts:string>\n    </ts:plurals>\n  </ts:label>\n  <ts:contract interface="erc875" name="EntryToken">\n    <ts:address network="1">0x63cCEF733a093E5Bd773b41C96D3eCE361464942</ts:address>\n    <ts:address network="3">0xFB82A5a2922A249f32222316b9D1F5cbD3838678</ts:address>\n    <ts:address network="4">0x59a7a9fd49fabd07c0f8566ae4be96fcf20be5e1</ts:address>\n    <ts:address network="42">0x2B58A9403396463404c2e397DBF37c5EcCAb43e5</ts:address>\n  </ts:contract>\n  <ts:origins>\n    \x3c!-- Define the contract which holds the token that the user will use --\x3e\n    <ts:ethereum contract="EntryToken"></ts:ethereum>\n  </ts:origins>\n    <ts:selection filter="expired=TRUE" name="expired">\n      <ts:label>\n        <ts:plurals xml:lang="en">\n          <ts:string quantity="one">Expired Ticket</ts:string>\n          <ts:string quantity="other">Expired Tickets</ts:string>\n        </ts:plurals>\n        <ts:string xml:lang="zh">已经过期的票</ts:string>\n      </ts:label>\n    </ts:selection>\n  <ts:cards>\n    <ts:card name="main" type="token">\n      <ts:item-view xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">\n        <style type="text/css">.ts-count {\n  font-family: "SourceSansPro";\n  font-weight: bolder;\n  font-size: 21px;\n  color: rgb(117, 185, 67);\n}\n.ts-category {\n  font-family: "SourceSansPro";\n  font-weight: lighter;\n  font-size: 21px;\n  color: rgb(67, 67, 67);\n}\n.ts-venue {\n  font-family: "SourceSansPro";\n  font-weight: lighter;\n  font-size: 16px;\n  color: rgb(67, 67, 67);\n}\n.ts-date {\n  font-family: "SourceSansPro";\n  font-weight: bold;\n  font-size: 14px;\n  color: rgb(112, 112, 112);\n  margin-left: 7px;\n  margin-right: 7px;\n}\n.ts-time {\n  font-family: "SourceSansPro";\n  font-weight: lighter;\n  font-size: 16px;\n  color: rgb(112, 112, 112);\n}\nhtml {\n}\n\nbody {\npadding: 0px;\nmargin: 0px;\n}\n\ndiv {\nmargin: 0px;\npadding: 0px;\n}\n\n.data-icon {\nheight:16px;\nvertical-align: middle\n}\n\n.tbml-count {  font-family: "SourceSansPro";  font-weight: bolder;  font-size: 21px;  color: rgb(117, 185, 67);}.tbml-category {  font-family: "SourceSansPro";  font-weight: lighter;  font-size: 21px;  color: rgb(67, 67, 67);}.tbml-venue {  font-family: "SourceSansPro";  font-weight: lighter;  font-size: 16px;  color: rgb(67, 67, 67);}.tbml-date {  font-family: "SourceSansPro";  font-weight: bold;  font-size: 14px;  color: rgb(112, 112, 112);  margin-left: 7px;  margin-right: 7px;}.tbml-time {  font-family: "SourceSansPro";  font-weight: lighter;  font-size: 16px;  color: rgb(112, 112, 112);}   html {   }      body {   padding: 0px;   margin: 0px;   }      div {   margin: 0px;   padding: 0px;   }   .data-icon {   height:16px;   vertical-align: middle   }\n\n\n</style>\n        <body><div>\n    \x3c!-- Iconified view displayed on the first page when clicking on token card in AlphaWallet --\x3e\n    <p>Enter Satoshi\'s villa with this special token!\n        <img alt="" src="data:image/jpeg;base64,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"></img>\n    </p>\n</div>\n</body>\n      </ts:item-view>\n      <ts:view xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">\n        <style type="text/css">.ts-count {\n  font-family: "SourceSansPro";\n  font-weight: bolder;\n  font-size: 21px;\n  color: rgb(117, 185, 67);\n}\n.ts-category {\n  font-family: "SourceSansPro";\n  font-weight: lighter;\n  font-size: 21px;\n  color: rgb(67, 67, 67);\n}\n.ts-venue {\n  font-family: "SourceSansPro";\n  font-weight: lighter;\n  font-size: 16px;\n  color: rgb(67, 67, 67);\n}\n.ts-date {\n  font-family: "SourceSansPro";\n  font-weight: bold;\n  font-size: 14px;\n  color: rgb(112, 112, 112);\n  margin-left: 7px;\n  margin-right: 7px;\n}\n.ts-time {\n  font-family: "SourceSansPro";\n  font-weight: lighter;\n  font-size: 16px;\n  color: rgb(112, 112, 112);\n}\nhtml {\n}\n\nbody {\npadding: 0px;\nmargin: 0px;\n}\n\ndiv {\nmargin: 0px;\npadding: 0px;\n}\n\n.data-icon {\nheight:16px;\nvertical-align: middle\n}\n\n.tbml-count {  font-family: "SourceSansPro";  font-weight: bolder;  font-size: 21px;  color: rgb(117, 185, 67);}.tbml-category {  font-family: "SourceSansPro";  font-weight: lighter;  font-size: 21px;  color: rgb(67, 67, 67);}.tbml-venue {  font-family: "SourceSansPro";  font-weight: lighter;  font-size: 16px;  color: rgb(67, 67, 67);}.tbml-date {  font-family: "SourceSansPro";  font-weight: bold;  font-size: 14px;  color: rgb(112, 112, 112);  margin-left: 7px;  margin-right: 7px;}.tbml-time {  font-family: "SourceSansPro";  font-weight: lighter;  font-size: 16px;  color: rgb(112, 112, 112);}   html {   }      body {   padding: 0px;   margin: 0px;   }      div {   margin: 0px;   padding: 0px;   }   .data-icon {   height:16px;   vertical-align: middle   }\n\n\n</style>\n        <script type="text/javascript">//\n    (function() {\n        \'use strict\'\n        function GeneralizedTime(generalizedTime) {\n            this.rawData = generalizedTime;\n        }\n\n        GeneralizedTime.prototype.getYear = function () {\n            return parseInt(this.rawData.substring(0, 4), 10);\n        };\n\n        GeneralizedTime.prototype.getMonth = function () {\n            return parseInt(this.rawData.substring(4, 6), 10) - 1;\n        };\n\n        GeneralizedTime.prototype.getDay = function () {\n            return parseInt(this.rawData.substring(6, 8), 10)\n        };\n\n        GeneralizedTime.prototype.getHours = function () {\n            return parseInt(this.rawData.substring(8, 10), 10)\n        };\n\n        GeneralizedTime.prototype.getMinutes = function () {\n            var minutes = parseInt(this.rawData.substring(10, 12), 10)\n            if (minutes) return minutes\n            return 0\n        };\n\n        GeneralizedTime.prototype.getSeconds = function () {\n            var seconds = parseInt(this.rawData.substring(12, 14), 10)\n            if (seconds) return seconds\n            return 0\n        };\n\n        GeneralizedTime.prototype.getMilliseconds = function () {\n            var startIdx\n            if (time.indexOf(\'.\') !== -1) {\n                startIdx = this.rawData.indexOf(\'.\') + 1\n            } else if (time.indexOf(\',\') !== -1) {\n                startIdx = this.rawData.indexOf(\',\') + 1\n            } else {\n                return 0\n            }\n\n            var stopIdx = time.length - 1\n            var fraction = \'0\' + \'.\' + time.substring(startIdx, stopIdx)\n            var ms = parseFloat(fraction) * 1000\n            return ms\n        };\n\n        GeneralizedTime.prototype.getTimeZone = function () {\n            let time = this.rawData;\n            var length = time.length\n            var symbolIdx\n            if (time.charAt(length - 1 ) === \'Z\'){\n                return 0\n            }\n            if (time.indexOf(\'+\') !== -1) {\n                symbolIdx = time.indexOf(\'+\')\n            } else if (time.indexOf(\'-\') !== -1) {\n                symbolIdx = time.indexOf(\'-\')\n            } else {\n                return NaN\n            }\n            var minutes = time.substring(symbolIdx + 2)\n            var hours = time.substring(symbolIdx + 1, symbolIdx + 2)\n            var one = (time.charAt(symbolIdx) === \'+\') ? 1 : -1\n            var intHr = one * parseInt(hours, 10) * 60 * 60 * 1000\n            var intMin = one * parseInt(minutes, 10) * 60 * 1000\n            var ms = minutes ? intHr + intMin : intHr\n            return ms\n        };\n\n        if (typeof exports === \'object\') {\n            module.exports = GeneralizedTime\n        } else if (typeof define === \'function\') {\n            define(GeneralizedTime)\n        } else {\n            window.GeneralizedTime = GeneralizedTime\n        }\n    }())\n\nclass Token {\n    constructor(tokenInstance) {\n        this.props = tokenInstance;\n    }\n\n    formatGeneralizedTimeToDate(str) {\n        const d = new GeneralizedTime(str);\n        return new Date(d.getYear(), d.getMonth(), d.getDay(), d.getHours(), d.getMinutes(), d.getSeconds()).toLocaleDateString();\n    }\n\n    formatGeneralizedTimeToTime(str) {\n        const d = new GeneralizedTime(str);\n        return new Date(d.getYear(), d.getMonth(), d.getDay(), d.getHours(), d.getMinutes(), d.getSeconds()).toLocaleTimeString([], {hour: \'2-digit\', minute:\'2-digit\'});\n    }\n\n    render() {\n        let time;\n        let date;\n        if (this.props.time == null) {\n            time = "";\n            date = "";\n        } else {\n            time = this.formatGeneralizedTimeToTime(this.props.time.generalizedTime);\n            date = this.props.time == null ? "": this.formatGeneralizedTimeToDate(this.props.time.generalizedTime);\n        }\n        return `&lt;div&gt;\n            &lt;div&gt;\n                &lt;span class="ts-count"&gt;x${this.props._count}&lt;/span&gt;  &lt;span class="ts-category"&gt;${this.props.label}&lt;/span&gt;\n            &lt;/div&gt;\n            &lt;div&gt;\n                &lt;span class="ts-venue"&gt;${this.props.building}&lt;/span&gt;\n            &lt;/div&gt;\n                &lt;div style="margin: 0px; padding:0px; clear: both; height: 6px"&gt;\n                &amp;nbsp;\n                &lt;/div&gt;\n            &lt;div&gt;\n                &lt;img src="data:image/png;base64,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" class="data-icon"/&gt;\n                &lt;span class="ts-date"&gt;${date}&lt;/span&gt;\n            &lt;/div&gt;\n            &lt;div&gt;\n                &lt;span class="ts-time"&gt;${time}, ${this.props.locality}&lt;/span&gt;\n            &lt;/div&gt;\n            &lt;/div&gt;`;\n    }\n}\n\nweb3.tokens.dataChanged = (oldTokens, updatedTokens, tokenCardId) =&gt; {\n    const currentTokenInstance = updatedTokens.currentInstance;\n    document.getElementById(tokenCardId).innerHTML = new Token(currentTokenInstance).render();\n};\n\n//\n<\/script>\n      </ts:view>\n    </ts:card>\n    <ts:card exclude="expired" name="enter" type="action">\n      \x3c!-- this action is of the model confirm-back.\n      It should be <ts:card type="action" model="confirm-back"> but Weiwu\n      shied away from specifying that due to the likely change of design causing an upgrade path issue.\n      window.onConfirm is called if user hit "confirm";\n      window.close() causes the back button to be pressed.\n      --\x3e\n      <ts:label>\n        <ts:string xml:lang="en">Enter</ts:string>\n        <ts:string xml:lang="zh">入場</ts:string>\n        <ts:string xml:lang="es">Entrar</ts:string>\n      </ts:label>\n      <ts:view xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">\n        <style type="text/css">.ts-count {\n  font-family: "SourceSansPro";\n  font-weight: bolder;\n  font-size: 21px;\n  color: rgb(117, 185, 67);\n}\n.ts-category {\n  font-family: "SourceSansPro";\n  font-weight: lighter;\n  font-size: 21px;\n  color: rgb(67, 67, 67);\n}\n.ts-venue {\n  font-family: "SourceSansPro";\n  font-weight: lighter;\n  font-size: 16px;\n  color: rgb(67, 67, 67);\n}\n.ts-date {\n  font-family: "SourceSansPro";\n  font-weight: bold;\n  font-size: 14px;\n  color: rgb(112, 112, 112);\n  margin-left: 7px;\n  margin-right: 7px;\n}\n.ts-time {\n  font-family: "SourceSansPro";\n  font-weight: lighter;\n  font-size: 16px;\n  color: rgb(112, 112, 112);\n}\nhtml {\n}\n\nbody {\npadding: 0px;\nmargin: 0px;\n}\n\ndiv {\nmargin: 0px;\npadding: 0px;\n}\n\n.data-icon {\nheight:16px;\nvertical-align: middle\n}\n\n.tbml-count {  font-family: "SourceSansPro";  font-weight: bolder;  font-size: 21px;  color: rgb(117, 185, 67);}.tbml-category {  font-family: "SourceSansPro";  font-weight: lighter;  font-size: 21px;  color: rgb(67, 67, 67);}.tbml-venue {  font-family: "SourceSansPro";  font-weight: lighter;  font-size: 16px;  color: rgb(67, 67, 67);}.tbml-date {  font-family: "SourceSansPro";  font-weight: bold;  font-size: 14px;  color: rgb(112, 112, 112);  margin-left: 7px;  margin-right: 7px;}.tbml-time {  font-family: "SourceSansPro";  font-weight: lighter;  font-size: 16px;  color: rgb(112, 112, 112);}   html {   }      body {   padding: 0px;   margin: 0px;   }      div {   margin: 0px;   padding: 0px;   }   .data-icon {   height:16px;   vertical-align: middle   }\n\n\n</style>\n        <script type="text/javascript">//\nclass Token {\n    constructor(tokenInstance) {\n        this.props = tokenInstance\n        document.getElementById("contractAddress").value = this.props.EntryToken;\n    }\n}\n\nweb3.tokens.dataChanged = (oldTokens, updatedTokens, tokenCardId) =&gt; {\n    const currentTokenInstance = updatedTokens.currentInstance;\n    document.getElementById(tokenCardId).innerHTML = new Token(currentTokenInstance).render();\n};\n\ndocument.addEventListener("DOMContentLoaded", function() {\n    window.onload = function startup() {\n        // 1. call API to fetch challenge\n        fetch(\'http://stormbird.duckdns.org:8080/api/getChallenge\')\n            .then(function (response) {\n                return response.text()\n            })\n            .then(function (response) {\n                document.getElementById(\'msg\').innerHTML = \'Challenge: \' + response\n                window.challenge = response\n            })\n    }\n\n    window.onConfirm = function onConfirm(signature) {\n        if (window.challenge === undefined || window.challenge.length == 0) return\n        const challenge = window.challenge\n        document.getElementById(\'status\').innerHTML = \'Wait for signature...\'\n        // 2. sign challenge to generate response\n        web3.personal.sign({ data: challenge }, function (error, value) {\n            if (error != null) {\n                document.getElementById(\'status\').innerHTML = error\n                window.onload();\n                return\n            }\n\n            document.getElementById(\'status\').innerHTML = \'Verifying credentials ...\'\n            // 3. open door\n            let contractAddress = document.getElementById("contractAddress").textContent;\n            fetch(`http://stormbird.duckdns.org:8080/api/checkSignature?contract=${contractAddress}&amp;challenge=${challenge}&amp;sig=${value}`)\n                .then(function (response) {\n                    return response.text()\n                })\n                .then(function (response) {\n                    if (response == "pass") {\n                        document.getElementById(\'status\').innerHTML = \'Entrance granted!\'\n                        window.close()\n                    } else {\n                        document.getElementById(\'status\').innerHTML = \'Failed with: \' + response\n                    }\n                })\n        });\n        window.challenge = \'\';\n        document.getElementById(\'msg\').innerHTML = \'\';\n    }\n});\n//\n<\/script>\n        <body><h3>Welcome to Craig Wright\'s house!</h3>\n<div id="msg">Preparing to unlock the entrance door.</div>\n<div id="contractAddress"></div>\n<div id="status"></div>\n</body>\n      </ts:view>\n    </ts:card>\n  </ts:cards>\n    <ts:attribute name="tokenId" distinct="true">\n      <ts:type>\n        <ts:syntax>1.3.6.1.4.1.1466.115.121.1.40</ts:syntax>\n      </ts:type>\n      <ts:origins>\n        <ethereum:call function="balanceOf" contract="EntryToken">\n            <ts:data>\n              <ts:uint256 ref="ownerAddress"></ts:uint256>\n            </ts:data>\n        </ethereum:call>\n      </ts:origins>\n    </ts:attribute>\n    <ts:attribute name="locality">\n        <ts:type><ts:syntax>1.3.6.1.4.1.1466.115.121.1.15</ts:syntax></ts:type>\n      <ts:origins>\n        <ethereum:call as="utf8" contract="EntryToken" function="getLocality">\n            <ts:data>\n              <ts:uint256 ref="tokenId"></ts:uint256>\n            </ts:data>\n        </ethereum:call>\n      </ts:origins>\n\n    </ts:attribute>\n    <ts:attribute name="time">\n        <ts:type><ts:syntax>1.3.6.1.4.1.1466.115.121.1.24</ts:syntax></ts:type>\n      <ts:label>\n        <ts:string xml:lang="en">Time</ts:string>\n        <ts:string xml:lang="zh">时间</ts:string>\n      </ts:label>\n      <ts:origins>\n        <ts:token-id as="utf8" bitmask="\n        0000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF0000000000000000000000\n        474d542b33000000000000000000000001075b2282f05255534b534101050002\n"></ts:token-id>\n      </ts:origins>\n    </ts:attribute>\n    <ts:attribute name="expired"> \x3c!-- boolean --\x3e\n        <ts:type><ts:syntax>1.3.6.1.4.1.1466.115.121.1.7</ts:syntax></ts:type>\n      <ts:origins>\n        <ethereum:call as="bool" contract="EntryToken" function="isExpired">\n          <ts:data>\n            <ts:uint256 ref="tokenId"></ts:uint256>\n          </ts:data>\n        </ethereum:call>\n      </ts:origins>\n    </ts:attribute>\n    <ts:attribute name="street"> \x3c!-- string --\x3e\n        <ts:type><ts:syntax>1.3.6.1.4.1.1466.115.121.1.15</ts:syntax></ts:type>\n      <ts:origins>\n        <ethereum:call as="utf8" contract="EntryToken" function="getStreet">\n          <ts:data>\n            <ts:uint256 ref="tokenId"></ts:uint256>\n          </ts:data>\n        </ethereum:call>\n      </ts:origins>\n    </ts:attribute>\n    <ts:attribute name="building"> \x3c!-- string --\x3e\n        <ts:type><ts:syntax>1.3.6.1.4.1.1466.115.121.1.15</ts:syntax></ts:type>\n      <ts:origins>\n        <ethereum:call as="utf8" contract="EntryToken" function="getBuildingName">\n          <ts:data>\n            <ts:uint256 ref="tokenId"></ts:uint256>\n          </ts:data>\n        </ethereum:call>\n      </ts:origins>\n    </ts:attribute>\n    <ts:attribute name="state"> \x3c!-- string --\x3e\n        <ts:type><ts:syntax>1.3.6.1.4.1.1466.115.121.1.15</ts:syntax></ts:type>\n      <ts:origins>\n        <ethereum:call as="utf8" contract="EntryToken" function="getState">\n          <ts:data>\n            <ts:uint256 ref="tokenId"></ts:uint256>\n          </ts:data>\n        </ethereum:call>\n      </ts:origins>\n    </ts:attribute>\n</ts:token>\n')])])]),t("p",[n._v("OnConfirm:")]),n._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v('@objc func proceed() {\n        let javaScriptToCallConfirm = """\n                                      if (window.onConfirm != null) {\n                                        onConfirm()\n                                      }\n                                      """\n        tokenScriptRendererView.inject(javaScript: javaScriptToCallConfirm)\n        let userEntryIds = action.attributes.values.compactMap { $0.userEntryId }\n        let fetchUserEntries = userEntryIds\n            .map { "document.getElementById(\\"\\($0)\\").value" }\n            .compactMap { tokenScriptRendererView.inject(javaScript: $0) }\n        guard let navigationController = navigationController else { return }\n\n        TokenScript.performTokenScriptAction(action, token: token, tokenId: tokenId, tokenHolder: tokenHolder, userEntryIds: userEntryIds, fetchUserEntries: fetchUserEntries, localRefsSource: tokenScriptRendererView, assetDefinitionStore: assetDefinitionStore, keystore: keystore, server: server, session: session, confirmTokenScriptActionTransactionDelegate: self, navigationController: navigationController)\n    }\n')])])]),t("p",[n._v("https://github.com/AlphaWallet/alpha-wallet-ios/blob/07c8ad7f6770df647525504b7d955e0f85a56b55/AlphaWallet/Tokens/ViewControllers/TokenInstanceActionViewController.swift#L154")]),n._v(" "),t("h2",{attrs:{id:"eip5169-powered-token-with-script-and-firmware-code"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#eip5169-powered-token-with-script-and-firmware-code"}},[n._v("#")]),n._v(" EIP5169 powered Token with script and firmware code")]),n._v(" "),t("p",[n._v("https://github.com/TokenScript/EIP5169TokenFactory/")]),n._v(" "),t("h2",{attrs:{id:"web3e"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#web3e"}},[n._v("#")]),n._v(" Web3E")])])}),[],!1,null,null,null);e.default=r.exports}}]);