(window.webpackJsonp=window.webpackJsonp||[]).push([[71],{271:function(n,e,r){"use strict";r.r(e);var t=r(0),s=Object(t.a)({},(function(){var n=this,e=n.$createElement,r=n._self._c||e;return r("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[r("p",[n._v("Nginx 和 Apache 各有什么优缺点？ https://www.zhihu.com/question/19571087")]),n._v(" "),r("p",[n._v("enable list files : autoindex on 注意location写法")]),n._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[n._v('server {\n        listen        80;\n        server_name  ctf.local;\n        root   "E:/workspace/WWW/ctf.local";\n        location / {\n            index index.php index.html error/index.html;\n            error_page 400 /error/400.html;\n            error_page 403 /error/403.html;\n            error_page 404 /error/404.html;\n            autoindex  off;\n        }\n        location ~ \\.php(.*)$ {\n            fastcgi_pass   127.0.0.1:9000;\n            fastcgi_index  index.php;\n            fastcgi_split_path_info  ^((?U).+\\.php)(/?.+)$;\n            fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;\n            fastcgi_param  PATH_INFO  $fastcgi_path_info;\n            fastcgi_param  PATH_TRANSLATED  $document_root$fastcgi_path_info;\n            include        fastcgi_params;\n        }\n        location ~ /.* {\n            autoindex on;\n        }\n}\n\n')])])]),r("p",[n._v("internal")]),n._v(" "),r("p",[n._v("https://www.cnblogs.com/lowmanisbusy/p/11718345.html")]),n._v(" "),r("p",[n._v("Nginx常见基本配置---upstream 使用指南")]),n._v(" "),r("p",[n._v("https://blog.csdn.net/LL845876425/article/details/97621365")]),n._v(" "),r("p",[n._v("what is the difference between proxy_request_buffering and proxy_buffering on nginx?")]),n._v(" "),r("p",[n._v("https://serverfault.com/questions/741610/what-is-the-difference-between-proxy-request-buffering-and-proxy-buffering-on-ng")]),n._v(" "),r("h4",{attrs:{id:"install-nginx"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#install-nginx"}},[n._v("#")]),n._v(" install nginx")]),n._v(" "),r("p",[n._v("https://docs.nginx.com/nginx/admin-guide/installing-nginx/installing-nginx-open-source/")]),n._v(" "),r("p",[r("a",{attrs:{href:"http://pcre.org/",target:"_blank",rel:"noopener noreferrer"}},[n._v("PCRE"),r("OutboundLink")],1),n._v(" – Supports regular expressions. Required by the NGINX "),r("a",{attrs:{href:"https://nginx.org/en/docs/ngx_core_module.html",target:"_blank",rel:"noopener noreferrer"}},[n._v("Core"),r("OutboundLink")],1),n._v(" and "),r("a",{attrs:{href:"https://nginx.org/en/docs/http/ngx_http_rewrite_module.html",target:"_blank",rel:"noopener noreferrer"}},[n._v("Rewrite"),r("OutboundLink")],1),n._v(" modules.")]),n._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[n._v("$ wget ftp://ftp.csx.cam.ac.uk/pub/software/programming/pcre/pcre-8.44.tar.gz\n$ tar -zxf pcre-8.44.tar.gz\n$ cd pcre-8.44\n$ ./configure\n$ make\n$ sudo make install\n")])])]),r("p",[r("a",{attrs:{href:"https://www.zlib.net/",target:"_blank",rel:"noopener noreferrer"}},[n._v("zlib"),r("OutboundLink")],1),n._v(" – Supports header compression. Required by the NGINX "),r("a",{attrs:{href:"https://nginx.org/en/docs/http/ngx_http_gzip_module.html",target:"_blank",rel:"noopener noreferrer"}},[n._v("Gzip"),r("OutboundLink")],1),n._v(" module.")]),n._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[n._v("$ wget http://zlib.net/zlib-1.2.11.tar.gz\n$ tar -zxf zlib-1.2.11.tar.gz\n$ cd zlib-1.2.11\n$ ./configure\n$ make\n$ sudo make install\n")])])]),r("p",[r("a",{attrs:{href:"https://www.openssl.org/",target:"_blank",rel:"noopener noreferrer"}},[n._v("OpenSSL"),r("OutboundLink")],1),n._v(" – Supports the HTTPS protocol. Required by the NGINX "),r("a",{attrs:{href:"https://nginx.org/en/docs/http/ngx_http_ssl_module.html",target:"_blank",rel:"noopener noreferrer"}},[n._v("SSL"),r("OutboundLink")],1),n._v(" module and others.")]),n._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[n._v("$ wget http://www.openssl.org/source/openssl-1.1.1g.tar.gz\n$ tar -zxf openssl-1.1.1g.tar.gz\n$ cd openssl-1.1.1g\n$ ./Configure darwin64-x86_64-cc --prefix=/usr\n$ make\n$ sudo make install\n")])])]),r("p",[n._v("nginx")]),n._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[n._v('$ wget https://nginx.org/download/nginx-1.18.0.tar.gz\n$ tar zxf nginx-1.18.0.tar.gz\n$ cd nginx-1.18.0\n\n# ./configure --with-http_ssl_module --with-openssl=/opt/openssl-1.0.0s\n# make\n# sudo make install\n\n修改配置文件nginx.conf\n# cd /usr/local/nginx/conf\n# vi nginx.conf (找到对应配置并修改成如下，备注不需要)\n\nworker_processes  8;\nevents {\n    worker_connections  1024;\n}\nhttp {\n    include       mime.types;\n    default_type  application/octet-stream;\n    sendfile        on;\n    keepalive_timeout  65;\n    upstream clearingCenter {\n        server 172.101.2.100:8080;   备注： 市场前置服务器ip地址\n        server 172.101.2.101:8080;   备注： 市场前置服务器ip地址\n    }\n\n\n\n    server {\n        listen       80;\n        server_name  localhost;\n        rewrite ^(.*)https://$server_name$1 permanent;\n        location / {\n            root   html;\n            index  index.html index.htm;\n        }\n        error_page   500 502 503 504  /50x.html;\n        location = /50x.html {\n            root   html;\n        }\n    }\n    server {\n        listen       443 ssl;\n        server_name  localhost;\n        ssl_certificate      /usr/local/nginx/conf/ssl.crt;\n        ssl_certificate_key  /usr/local/nginx/conf/ssl.key;\n        ssl_session_cache    shared:SSL:1m;\n        ssl_session_timeout  5m;\n        ssl_ciphers  HIGH:!aNULL:!MD5;\n        ssl_prefer_server_ciphers  on;\n        location ~ /clearingCenter/{\n           proxy_pass http://clearingCenter;  \n           proxy_redirect off;\n           proxy_set_header Host $host;\n           proxy_set_header X-Real-IP $remote_addr;\n           proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n           proxy_http_version 1.1;\n           proxy_set_header Upgrade $http_upgrade;\n           proxy_set_header Connection "upgrade";    \n        }\n}\n}\n\n注意：\t\t\n在172.100.3.100和172.100.3.101配置nginx时 /usr/local/nginx/conf/nginx.conf中\n上面的配置改为：   \n upstream clearingCenter {\n        server 172.100.3.100:8080;   备注： 清算中心页面服务器ip地址\n        server 172.100.3.101:8080;   备注： 清算中心页面服务器ip地址   \n }\n同时在location ~ /clearingCenter/{\tXXXXXXXXXXXXXX\n}后面添加以下内容\nlocation ~ /sso/{\n           proxy_pass http://clearingCenter;  \n           proxy_redirect off;\n           proxy_set_header Host $host;\n           proxy_set_header X-Real-IP $remote_addr;\n           proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n           proxy_http_version 1.1;\n           proxy_set_header Upgrade $http_upgrade;\n           proxy_set_header Connection "upgrade";    \n        }\n\n\n生成nginx秘钥（生产环境需要购买正版）\n1. 使用root用户登录，生成一个ssl.key，命令如下\n# openssl genrsa -des3 -out ssl.key 1024\n2.输入密码，密码输入后再删除，命令如下\n# mv ssl.key xxx.key\n# openssl rsa -in xxx.key -out ssl.key\n# rm xxx.key\n3.根据生成的ssl.key再生成证书请求文件，命令如下\n# openssl req -new -key ssl.key -out ssl.csr\n4.按提示输入信息，可随便输入\n5.根据这两个文件生成最终的crt证书文件，命令如下\n# openssl x509 -req -days 3650 -in ssl.csr -signkey ssl.key -out ssl.crt\n6.拷贝文件至/usr/local/nginx/conf目录中\n# cp ssl.key /usr/local/nginx/conf\n# cp ssl.crt /usr/local/nginx/conf\n拷贝业务前端程序至nginx\n该操作只有172.100.3.100和172.100.3.101的服务器需要。\n使用root用户登录，将页面代码clearingCenter_page和sso_page上传至/usr/local/nginx/html中\n\n启停nginx\n启动\n$ /usr/local/nginx/sbin/nginx\n停止\n$ /usr/local/nginx/sbin/nginx -s quit\n重启\n$ /usr/local/nginx/sbin/nginx -s reload\n\n')])])]),r("p",[n._v("切换 root路径 从默认的相对路径 到 绝对路径")]),n._v(" "),r("p",[n._v("出现 (13: permission denied)")]),n._v(" "),r("p",[n._v("https://stackoverflow.com/questions/25774999/nginx-stat-failed-13-permission-denied")]),n._v(" "),r("p",[n._v("方法一 更改默认用户为root")]),n._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[n._v("user  root;\nworker_processes  1;\n")])])]),r("p",[n._v("方法二 添加文件权限给这个用户nobody或者将用户加到相应group")]),n._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[n._v("user  nobody;\nworker_processes  1;\n")])])])])}),[],!1,null,null,null);e.default=s.exports}}]);