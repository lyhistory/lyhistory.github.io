<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>原理 | 计算机基础教程</title>
    <meta name="description" content="软件开发教程，白帽黑客入门教程，区块链入门教程，物联网，大数据">
    
    
    <link rel="preload" href="/docs/assets/css/0.styles.89d6372f.css" as="style"><link rel="preload" href="/docs/assets/js/app.d1e68911.js" as="script"><link rel="preload" href="/docs/assets/js/2.dc5756d7.js" as="script"><link rel="preload" href="/docs/assets/js/43.62cb7794.js" as="script"><link rel="prefetch" href="/docs/assets/js/10.fbfff6b3.js"><link rel="prefetch" href="/docs/assets/js/100.957e627d.js"><link rel="prefetch" href="/docs/assets/js/101.a02f746a.js"><link rel="prefetch" href="/docs/assets/js/102.f7e129f6.js"><link rel="prefetch" href="/docs/assets/js/103.005616c5.js"><link rel="prefetch" href="/docs/assets/js/104.14521a5f.js"><link rel="prefetch" href="/docs/assets/js/105.9248dd9f.js"><link rel="prefetch" href="/docs/assets/js/106.bf27ca16.js"><link rel="prefetch" href="/docs/assets/js/107.889b143f.js"><link rel="prefetch" href="/docs/assets/js/108.875753a0.js"><link rel="prefetch" href="/docs/assets/js/109.bb299988.js"><link rel="prefetch" href="/docs/assets/js/11.9ff4ffcb.js"><link rel="prefetch" href="/docs/assets/js/110.eb7e4243.js"><link rel="prefetch" href="/docs/assets/js/111.99914aba.js"><link rel="prefetch" href="/docs/assets/js/112.b3e1df16.js"><link rel="prefetch" href="/docs/assets/js/113.a303bfc6.js"><link rel="prefetch" href="/docs/assets/js/114.a9188a5f.js"><link rel="prefetch" href="/docs/assets/js/115.f549606b.js"><link rel="prefetch" href="/docs/assets/js/116.591fcf35.js"><link rel="prefetch" href="/docs/assets/js/117.d7dc13f0.js"><link rel="prefetch" href="/docs/assets/js/118.2baf849b.js"><link rel="prefetch" href="/docs/assets/js/119.b39ab793.js"><link rel="prefetch" href="/docs/assets/js/12.fe0a4035.js"><link rel="prefetch" href="/docs/assets/js/120.c06580df.js"><link rel="prefetch" href="/docs/assets/js/121.a6a52bd1.js"><link rel="prefetch" href="/docs/assets/js/122.a8ab0941.js"><link rel="prefetch" href="/docs/assets/js/123.46cb6c13.js"><link rel="prefetch" href="/docs/assets/js/124.f291a946.js"><link rel="prefetch" href="/docs/assets/js/125.abbc9c49.js"><link rel="prefetch" href="/docs/assets/js/126.a395c838.js"><link rel="prefetch" href="/docs/assets/js/127.ffedb1c7.js"><link rel="prefetch" href="/docs/assets/js/128.87ceb16c.js"><link rel="prefetch" href="/docs/assets/js/129.d8dd00a3.js"><link rel="prefetch" href="/docs/assets/js/13.56a0511b.js"><link rel="prefetch" href="/docs/assets/js/130.382761c0.js"><link rel="prefetch" href="/docs/assets/js/131.3697719c.js"><link rel="prefetch" href="/docs/assets/js/132.991d5df4.js"><link rel="prefetch" href="/docs/assets/js/133.3fa572be.js"><link rel="prefetch" href="/docs/assets/js/134.d8f2a5a3.js"><link rel="prefetch" href="/docs/assets/js/135.ff2e73e1.js"><link rel="prefetch" href="/docs/assets/js/136.6f68b3ee.js"><link rel="prefetch" href="/docs/assets/js/137.d03620d6.js"><link rel="prefetch" href="/docs/assets/js/138.1a7c0f48.js"><link rel="prefetch" href="/docs/assets/js/139.6dbfed28.js"><link rel="prefetch" href="/docs/assets/js/14.08b4ef8e.js"><link rel="prefetch" href="/docs/assets/js/140.6809a04a.js"><link rel="prefetch" href="/docs/assets/js/141.7a26f42c.js"><link rel="prefetch" href="/docs/assets/js/142.cf7ee7fe.js"><link rel="prefetch" href="/docs/assets/js/143.9c647e0d.js"><link rel="prefetch" href="/docs/assets/js/144.d97ac497.js"><link rel="prefetch" href="/docs/assets/js/145.cc6c22dd.js"><link rel="prefetch" href="/docs/assets/js/146.e7ce3ec6.js"><link rel="prefetch" href="/docs/assets/js/147.aeb5d697.js"><link rel="prefetch" href="/docs/assets/js/148.9f5307b7.js"><link rel="prefetch" href="/docs/assets/js/149.8cc6e0f9.js"><link rel="prefetch" href="/docs/assets/js/15.4e8a76ba.js"><link rel="prefetch" href="/docs/assets/js/150.18516aa9.js"><link rel="prefetch" href="/docs/assets/js/151.7a26fef6.js"><link rel="prefetch" href="/docs/assets/js/16.97205980.js"><link rel="prefetch" href="/docs/assets/js/17.65c13f68.js"><link rel="prefetch" href="/docs/assets/js/18.9317ad50.js"><link rel="prefetch" href="/docs/assets/js/19.3e008d6a.js"><link rel="prefetch" href="/docs/assets/js/20.9b3fea94.js"><link rel="prefetch" href="/docs/assets/js/21.dbb7d4af.js"><link rel="prefetch" href="/docs/assets/js/22.dab3faf7.js"><link rel="prefetch" href="/docs/assets/js/23.5172e04d.js"><link rel="prefetch" href="/docs/assets/js/24.f2e098a0.js"><link rel="prefetch" href="/docs/assets/js/25.303aa24e.js"><link rel="prefetch" href="/docs/assets/js/26.ba8594ab.js"><link rel="prefetch" href="/docs/assets/js/27.3c403aa1.js"><link rel="prefetch" href="/docs/assets/js/28.9667b64d.js"><link rel="prefetch" href="/docs/assets/js/29.c3ca1ed9.js"><link rel="prefetch" href="/docs/assets/js/3.bd58d59c.js"><link rel="prefetch" href="/docs/assets/js/30.33c8bcdb.js"><link rel="prefetch" href="/docs/assets/js/31.b43d6941.js"><link rel="prefetch" href="/docs/assets/js/32.9ea132c0.js"><link rel="prefetch" href="/docs/assets/js/33.38f75fb9.js"><link rel="prefetch" href="/docs/assets/js/34.3033a6c6.js"><link rel="prefetch" href="/docs/assets/js/35.dd578231.js"><link rel="prefetch" href="/docs/assets/js/36.668ecb2f.js"><link rel="prefetch" href="/docs/assets/js/37.9c5960ce.js"><link rel="prefetch" href="/docs/assets/js/38.47b4898c.js"><link rel="prefetch" href="/docs/assets/js/39.73162acf.js"><link rel="prefetch" href="/docs/assets/js/4.7d1e56e0.js"><link rel="prefetch" href="/docs/assets/js/40.592b4732.js"><link rel="prefetch" href="/docs/assets/js/41.b0703999.js"><link rel="prefetch" href="/docs/assets/js/42.cab52dd8.js"><link rel="prefetch" href="/docs/assets/js/44.b229fc1e.js"><link rel="prefetch" href="/docs/assets/js/45.3cf99085.js"><link rel="prefetch" href="/docs/assets/js/46.d2c79ed4.js"><link rel="prefetch" href="/docs/assets/js/47.815e6914.js"><link rel="prefetch" href="/docs/assets/js/48.040ac558.js"><link rel="prefetch" href="/docs/assets/js/49.cf6c5028.js"><link rel="prefetch" href="/docs/assets/js/5.540a7edc.js"><link rel="prefetch" href="/docs/assets/js/50.50da01f6.js"><link rel="prefetch" href="/docs/assets/js/51.417fb977.js"><link rel="prefetch" href="/docs/assets/js/52.b319f03d.js"><link rel="prefetch" href="/docs/assets/js/53.6dc320ba.js"><link rel="prefetch" href="/docs/assets/js/54.6605331a.js"><link rel="prefetch" href="/docs/assets/js/55.d71967d1.js"><link rel="prefetch" href="/docs/assets/js/56.06584c49.js"><link rel="prefetch" href="/docs/assets/js/57.8ff22aab.js"><link rel="prefetch" href="/docs/assets/js/58.68ba15a0.js"><link rel="prefetch" href="/docs/assets/js/59.437b718f.js"><link rel="prefetch" href="/docs/assets/js/6.9f5b550f.js"><link rel="prefetch" href="/docs/assets/js/60.f0bec885.js"><link rel="prefetch" href="/docs/assets/js/61.1ddeca3c.js"><link rel="prefetch" href="/docs/assets/js/62.e52dbbd9.js"><link rel="prefetch" href="/docs/assets/js/63.3fc139bb.js"><link rel="prefetch" href="/docs/assets/js/64.f13f3ee1.js"><link rel="prefetch" href="/docs/assets/js/65.cabe3430.js"><link rel="prefetch" href="/docs/assets/js/66.e3fc52c8.js"><link rel="prefetch" href="/docs/assets/js/67.ac811588.js"><link rel="prefetch" href="/docs/assets/js/68.99c4b139.js"><link rel="prefetch" href="/docs/assets/js/69.0f97439d.js"><link rel="prefetch" href="/docs/assets/js/7.1ac0d6b3.js"><link rel="prefetch" href="/docs/assets/js/70.fba0676b.js"><link rel="prefetch" href="/docs/assets/js/71.69a902bf.js"><link rel="prefetch" href="/docs/assets/js/72.3825ceb6.js"><link rel="prefetch" href="/docs/assets/js/73.b280e28f.js"><link rel="prefetch" href="/docs/assets/js/74.8bbed5e7.js"><link rel="prefetch" href="/docs/assets/js/75.4d018022.js"><link rel="prefetch" href="/docs/assets/js/76.4f7f3732.js"><link rel="prefetch" href="/docs/assets/js/77.30c33da6.js"><link rel="prefetch" href="/docs/assets/js/78.76daea07.js"><link rel="prefetch" href="/docs/assets/js/79.3c5c5a43.js"><link rel="prefetch" href="/docs/assets/js/8.6a6515e0.js"><link rel="prefetch" href="/docs/assets/js/80.d37b24d6.js"><link rel="prefetch" href="/docs/assets/js/81.6f391902.js"><link rel="prefetch" href="/docs/assets/js/82.1f623888.js"><link rel="prefetch" href="/docs/assets/js/83.4c9ac9c1.js"><link rel="prefetch" href="/docs/assets/js/84.97e9c9b3.js"><link rel="prefetch" href="/docs/assets/js/85.1befe7cf.js"><link rel="prefetch" href="/docs/assets/js/86.b2312282.js"><link rel="prefetch" href="/docs/assets/js/87.fde07eba.js"><link rel="prefetch" href="/docs/assets/js/88.9ad93ec5.js"><link rel="prefetch" href="/docs/assets/js/89.756e854d.js"><link rel="prefetch" href="/docs/assets/js/9.57696970.js"><link rel="prefetch" href="/docs/assets/js/90.7f34a9c9.js"><link rel="prefetch" href="/docs/assets/js/91.0731ea0d.js"><link rel="prefetch" href="/docs/assets/js/92.cbddaf8b.js"><link rel="prefetch" href="/docs/assets/js/93.9a89a1e6.js"><link rel="prefetch" href="/docs/assets/js/94.620bf9bf.js"><link rel="prefetch" href="/docs/assets/js/95.4d5dbc6c.js"><link rel="prefetch" href="/docs/assets/js/96.0d0b8b6c.js"><link rel="prefetch" href="/docs/assets/js/97.59d6d01a.js"><link rel="prefetch" href="/docs/assets/js/98.f6cede5d.js"><link rel="prefetch" href="/docs/assets/js/99.02be498d.js">
    <link rel="stylesheet" href="/docs/assets/css/0.styles.89d6372f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/docs/" class="home-link router-link-active"><!----> <span class="site-name">计算机基础教程</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/docs/" class="nav-link">机器指令</a></div><div class="nav-item"><a href="/docs/software/" class="nav-link">软件基础</a></div><div class="nav-item"><a href="/docs/coder2hacker/" class="nav-link router-link-active">白帽黑客</a></div><div class="nav-item"><a href="/docs/blockchain/" class="nav-link">区块链</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/docs/" class="nav-link">机器指令</a></div><div class="nav-item"><a href="/docs/software/" class="nav-link">软件基础</a></div><div class="nav-item"><a href="/docs/coder2hacker/" class="nav-link router-link-active">白帽黑客</a></div><div class="nav-item"><a href="/docs/blockchain/" class="nav-link">区块链</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/docs/software/" class="sidebar-link">软件基础</a></li><li><a href="/docs/coder2hacker/" class="sidebar-link">黑客入门</a></li><li><a href="/docs/blockchain/" class="sidebar-link">区块链入门</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="原理"><a href="#原理" class="header-anchor">#</a> 原理</h2> <p>你的一些DNS记录（主要是CNAME）被你开启了zone delegation：</p> <p>https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc771640(v=ws.11)?redirectedfrom=MSDN</p> <p><strong>出现的场景</strong></p> <p>假设你为一个全球企业工作，example.com 是其主域名。因为是21世纪，所以一个重要的任务就是创建和维护在线电商平台。</p> <p>有很多流行的e-commence云供应商 (e.g. Shopify, BigCommerce, Magento, Yokart, Big Kartel)，所以你也是采用了某家的服务，在上面设立了网店. 当年创建和配置好后,e-commerce供应商会分配给你类似这个域名给你的网店:</p> <p>exampleshop.someecommerceplatform.com</p> <p>在分享和推广该域名的时候,这个看起来并不太好,所以你想要它展示你自己的品牌,比如</p> <p>shop.example.com</p> <p>想要达到这个目的,你有两种配置方式:</p> <ol><li>301/302 http 跳转可以帮客户从shop.example.com跳转到exampleshop.someecommerceplatform.com .这个方法不太有吸引力,因为会彻底替换掉用户浏览器导航的url地址</li> <li>配置一个CNAME DNS记录，将DNS解析直接委托给e-commerce供应商，这种方式下，地址栏的url不会改变（当然不是所有供应商都提供这个cname方法）</li></ol> <p>既然CNAME方式比较好一些，所以你可能就选择了这种方式</p> <p>快进到一年以后，贵公司的e-commerce成果惨不忍睹，业绩未达标。运营主管指示你将e-commerce站点下线进行整顿。</p> <p>为了节省资金，你取消了公司订阅的第三方e-commerce平台提供商。所以现在就产生了潜在的子域名接管风险：你很容易忘记去更新或删除掉DNS zone文件中的CNAME记录。</p> <p>底线是，如果你不删除掉CNAME记录，任何人都去你之前那家e-ecommerce供应商上注册一个店铺，然后接管你的 shop.example.com。</p> <p>这种场景可能对你来说是未曾听说过的,实际上,子域名接管确实是刚刚出现不久的威胁, 川普的某网站被黑就是一个例子:</p> <p>http://www.networkworld.com/article/3171732/security/iraqi-hacker-took-credit-for-hijacking-subdomain-and-defacing-trump-site.html</p> <p>当然这个威胁并不限于e-commerce供应商,还包括很多大型云商产业.</p> <p>很多CNAME记录都是指向Amazon AWS或Microsoft Azure。当达到某些特定条件，子域名接管是很容易的。</p> <p>举例Amazon Cloudfront：</p> <p>https://aws.amazon.com/cloudfront/</p> <p>这个是CDN服务，主要是为了分发托管在Amazon Cloudfront Edge服务器上的静态文件：</p> <p>https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/distribution-working-with.html</p> <p>创建一个新的distribution后，AWS会生成一个随机的域名，如：</p> <p>d2erlblaho6777.cloudfront.net</p> <p>你可以通过该域名访问你分发的文件，随机生成的子域名可能看起来是很好的针对子域名接管的防御，但实际上，对于CloudFront确并非如此。</p> <p>问题在于，这并非是1对1的匹配，对于每一个distribution并非都有独立的IPV4地址。CloudFront使用m:n匹配，这意味着这些域名实际上是匹配到更小的CloudFront Edge servers集合上(想一下A记录)，所以这实际上就是一种virtual hosting，CloudFront内部使用一种mapping table来将上面的distribution 域名匹配实际的distribution 内容。如果你很熟悉virtual hosting，你可以说CNAME记录不是那么直接的，web服务器使用HTTP Host header字段来决定它需要服务那个域名。如果你想要使用</p> <p>static.example.com</p> <p>作为子域名替换上面的自动分配的子域名，需要配置一个CNAME记录指向自动分配的域名：</p> <div class="language- extra-class"><pre class="language-text"><code>static.example.com.    600  IN  CNAME  d2erlblaho6777.cloudfront.net.
</code></pre></div><p>但是，如果你直接使用</p> <p>static.example.com</p> <p>CloudFront服务器会在HTTP Host header看到它，所以CloudFront不能将其跟服务器上任何distribution匹配起来，因为这个域名并不在CloudFront内部的mapping table中！这就是为啥CloudFront需要你提供CNAME记录：</p> <p>如果关联这个CNAME的distribution删除了，攻击者可以很简单的通过生成一个新的distribution，设置CNAME，CloudFront的匹配规则会帮攻击者做剩下的事情。</p> <h2 id="升级-风险"><a href="#升级-风险" class="header-anchor">#</a> 升级/风险</h2> <p>子域名接管被认为是高级别的安全威胁，归结为被怀有恶意的他人注册域名并企图控制一个或多个子域名。这呈现出一个有意思的攻击向量，甚至会导致一些其他高级别的安全风险，比如在Arne Swinnen的bug bounty report中解释的认证绕过：</p> <p>https://hackerone.com/reports/172137</p> <h2 id="案例"><a href="#案例" class="header-anchor">#</a> 案例</h2> <p>+ Subdomain takeover report for vince.co</p> <p>http://hackerone.com/reports/32825</p> <p>+ Subdomain takeover report for greenhouse.io</p> <p>https://hackerone.com/reports/38007</p> <p>+ Subdomain takeover report for uber.com</p> <p>https://hackerone.com/reports/175070</p> <p>子域名接管-案例 USA.gov https://blog.sweepatic.com/usa-secured-by-sweepatic/</p> <p>子域名接管-案例 通过recon接管Facebook的子域名 https://sudhanshur705.medium.com/how-recon-helped-me-to-to-find-a-facebook-domain-takeover-58163de0e7d5</p> <h2 id="防御"><a href="#防御" class="header-anchor">#</a> 防御</h2> <p>企业通常在日常工作中不会审计他们的DNS配置，实际上，企业也缺乏标准的流程去添加、更改或移除他们DNS zone file的设置。甚至记录DNS记录变化都不常实施。所以你知道这里有多少空间需要改进了。</p> <p>预防子域名接管的第一步就是妥善的监控和分析DNS记录，其中很重要的就是开展 subdomain enumeration</p> <p>建立并维护你的动态digital footprint包括所有dns配置改动是预防此类问题的核心。</p> <h2 id="poc"><a href="#poc" class="header-anchor">#</a> POC</h2> <p>github上面有不少工具提供子域名接管验证：</p> <p>+ aquatone：https://github.com/michenriksen/aquatone</p> <p>+ SubOver：https://github.com/Ice3man543/SubOver</p> <p>+ subjack：https://github.com/haccer/subjack</p> <p>虽然这些工具提供了关于子域名接管很好的启发，由于很多不同云商的限制，经常还是会出现false positive的结果，下面会给每个domain都提供一个手工的验证脚本，不同类型域名的命名规范如下：</p> <div class="language- extra-class"><pre class="language-text"><code>sub.example.com.    600  IN  CNAME  anotherdomain.com.
</code></pre></div><p>sub.example.com.叫做source domain name，anotherdomain.com.叫做canonical domain name</p> <h3 id="amazon-s3"><a href="#amazon-s3" class="header-anchor">#</a> Amazon S3</h3> <p>Amazon S3 是一个基于桶子概念的存储服务，桶子是存储的逻辑单元，当你创建了桶子之后，一个独立的子域名就会为其产生，是不是听起来很熟悉？</p> <p>Amazon S3 遵循基本上跟CloudFront的virtual hosting一样的概念，你可以读一下S3的 virtual hosting：</p> <p>https://docs.aws.amazon.com/AmazonS3/latest/dev/VirtualHosting.html</p> <p>这里我只想指出一点，S3桶子也许可以配置为网站托管服务来托管静态内容，如果canonical domain名字里含有网站，S3桶子就是作为网站托管服务。我怀疑非网站和网站配置的桶子是被不同的load balancer来handle处理的，所以他们不可以互相替换，唯一的不同是在桶子创建的时候，如有必要需要设置正确的网站标志。</p> <p>验证方法：</p> <p>CNAME记录需要类似：<code>sub.example.com 60 IN CNAME sub.example.s3.amazonaws.net</code></p> <p>我使用如下正则表达式来测试正确的canonical name：</p> <div class="language- extra-class"><pre class="language-text"><code>
# {bucketname}.s3.amazonaws.com
^[a-z0-9\.\-]{0,63}\.?s3.amazonaws\.com$

# {bucketname}.s3-website(.|-){region}.amazonaws.com (+ possible China region)
^[a-z0-9\.\-]{3,63}\.s3-website[\.-](eu|ap|us|ca|sa|cn)-\w{2,14}-\d{1,2}\.amazonaws.com(\.cn)?$

# {bucketname}.s3(.|-){region}.amazonaws.com
^[a-z0-9\.\-]{3,63}\.s3[\.-](eu|ap|us|ca|sa)-\w{2,14}-\d{1,2}\.amazonaws.com$

# {bucketname}.s3.dualstack.{region}.amazonaws.com
^[a-z0-9\.\-]{3,63}\.s3.dualstack\.(eu|ap|us|ca|sa)-\w{2,14}-\d{1,2}\.amazonaws.com$
</code></pre></div><p>验证子域名接管是否存在，使用httpie执行：</p> <div class="language- extra-class"><pre class="language-text"><code>http -b GET http://{SOURCE DOMAIN NAME} | grep -E -q '&lt;Code&gt;NoSuchBucket&lt;/Code&gt;|&lt;li&gt;Code: NoSuchBucket&lt;/li&gt;' &amp;&amp; echo &quot;Subdomain takeover may be possible&quot; || echo &quot;Subdomain takeover is not possible&quot;
</code></pre></div><p>开始接管：</p> <p>（首先你要注册一个AWS账号）</p> <div class="language- extra-class"><pre class="language-text"><code>
1. 进入S3面板 https://s3.console.aws.amazon.com/s3/
2. 点击创建桶子
3. 设置桶子名字为你准备接管的目标域名
4. 多次的点击 Next 直到结束
5. 打开创建好的桶子
6. 点击是上传
7. 选择POC文件（html或txt都行），建议不要用index.html命名，可以使用不带后缀的poc
8. 在Permissions页签下选择 Grant public read access to this object(s)
9. 上传之后，选择该文件并且点击More，选择 Change metadata
10. 点击 Add metadata，选择反应该文件类型的 Content-type和value，比如如果是HTML，选择 text/html，等等。
11. (Optional) 如果桶子配置为站点
1）切换到 Properties tab
2）点击 Static website hosting
3）选择 Use this bucket to host a website
4）作为索引，选择你所上传的文件
5）点击保存
</code></pre></div><p>如果没有任何错误，恭喜，接管成功！如果你上传的是poc，那么访问链接为</p> <p>http://sub.example.com/poc</p> <h3 id="github-pages"><a href="#github-pages" class="header-anchor">#</a> GitHub Pages</h3> <p>GitHub通过GitHub Pages提供免费的托管服务，这种网站一般是作为项目文档，技术博客或开源项目的一些支持网页。除了默认的×.github.io子域名，GitHub页面支持自定义域名。</p> <p>验证方法：</p> <p>CNAME记录需要类似：<code>sub.example.com 60 IN CNAME subexamplecom.github.io</code></p> <p>我使用如下正则表达式来测试正确的canonical name：</p> <p><code>^[a-z0-9\.\-]{0,70}\.?github\.io$</code></p> <p>验证子域名接管是否存在，使用httpie执行：</p> <div class="language- extra-class"><pre class="language-text"><code>
http -b GET http://{SOURCE DOMAIN NAME} | grep -F -q &quot;&lt;strong&gt;There isn't a GitHub Pages site here.&lt;/strong&gt;&quot; &amp;&amp; echo &quot;Subdomain takeover may be possible&quot; || echo &quot;Subdomain takeover is not possible&quot;
</code></pre></div><p>开始接管：</p> <p>（首先你要注册一个GitHub账号）</p> <div class="language- extra-class"><pre class="language-text"><code>
1. 进入创建repository页面
2. 设置Repository名字为canonical域名（如 {something}.github.io）
3. 点击创建repository
4. 将内容通过git推送到这个repo
5. 切换到 Settings页签
6. 在GitHub Pages 部分选择master分支作为source
7. 保存
8. 设置自定义域名Custom domain为要接管的域名
9. 保存
</code></pre></div><h3 id="heroku"><a href="#heroku" class="header-anchor">#</a> Heroku</h3> <p>Heroku 是流行的PasS平台及服务供应商，其有类似其他云商的virtual hosting 概念：不同的 *.herokudns.com 子域名对应着相同的 A 记录集合。跟其他供应商一样，HTTP Host对正确的域名解析domain resolution很重要，还有一种方法是上传自定义域名的certificate（Github Pages不支持，所以你不能使用自定义域名的HTTPS）</p> <p>验证方法：</p> <p>CNAME记录需要类似：<code>sub.example.com 60 IN CNAME subexamplecom.herokudns.com</code></p> <p>我使用如下正则表达式来测试正确的canonical name：</p> <p><code>^[a-z0-9\.\-]{2,70}\.herokudns\.com$</code></p> <p>验证子域名接管是否存在，使用httpie执行：</p> <p><code>http -b GET http://{SOURCE DOMAIN NAME} | grep -F -q &quot;//www.herokucdn.com/error-pages/no-such-app.html&quot; &amp;&amp; echo &quot;Subdomain takeover may be possible&quot; || echo &quot;Subdomain takeover is not possible&quot;</code></p> <p>开始接管：</p> <p>（首先你要注册一个Heroku 账号）</p> <div class="language- extra-class"><pre class="language-text"><code>
1. 打开新建 Heroku app.
2. 选择name 和 region (对接管无影响).
3. 通过git推送POC应用到 Heroku，Deploy 页签有介绍步骤

4. 切换到Settings页面
5. 滚动到 Domains and certificates
6. 点击 Add domain
7. 提供你要接管的域名，点击保存，生效需要一些时间
</code></pre></div><h3 id="readme-io"><a href="#readme-io" class="header-anchor">#</a> Readme.io</h3> <p>Readme.io 是个托管文档的服务，当然跟前面一样，他们也允许custom domain。</p> <p>验证方法：</p> <p>CNAME记录需要类似：<code>sub.example.com 60 IN CNAME subexamplecom.readme.io</code></p> <p>我使用如下正则表达式来测试正确的canonical name：<code>^[a-z0-9\.\-]{2,70}\.readme\.io$</code></p> <p>验证子域名接管是否存在，使用httpie执行：</p> <div class="language- extra-class"><pre class="language-text"><code>http -b GET http://{SOURCE DOMAIN NAME} | grep -F -q &quot;Project doesnt exist... yet!&quot; &amp;&amp; echo &quot;Subdomain takeover may be possible&quot; || echo &quot;Subdomain takeover is not possible&quot;
</code></pre></div><p>开始接管：</p> <p>（首先你要注册一个Readme.io账号）</p> <div class="language- extra-class"><pre class="language-text"><code>
1. 进入dashboard.
2. 设置项目名字和子域名，这里的子域名不需要跟你要接管的域名一致
3. 在左侧边栏，选择General Settings -&gt; Custom Domain，这里设置为你要接管的子域名

4. 保存
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/docs/assets/js/app.d1e68911.js" defer></script><script src="/docs/assets/js/2.dc5756d7.js" defer></script><script src="/docs/assets/js/43.62cb7794.js" defer></script>
  </body>
</html>
