<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>计算机基础教程</title>
    <meta name="description" content="软件开发教程，渗透测试入门教程，区块链入门教程，物联网，大数据">
    
    
    <link rel="preload" href="/docs/assets/css/0.styles.89d6372f.css" as="style"><link rel="preload" href="/docs/assets/js/app.bd9456d1.js" as="script"><link rel="preload" href="/docs/assets/js/2.dc5756d7.js" as="script"><link rel="preload" href="/docs/assets/js/36.d804d8c0.js" as="script"><link rel="prefetch" href="/docs/assets/js/10.5bff35f1.js"><link rel="prefetch" href="/docs/assets/js/11.a111b7db.js"><link rel="prefetch" href="/docs/assets/js/12.97e362f9.js"><link rel="prefetch" href="/docs/assets/js/13.a5049885.js"><link rel="prefetch" href="/docs/assets/js/14.5c9d4e81.js"><link rel="prefetch" href="/docs/assets/js/15.9d4345d3.js"><link rel="prefetch" href="/docs/assets/js/16.bdfeea9e.js"><link rel="prefetch" href="/docs/assets/js/17.8b7e1a30.js"><link rel="prefetch" href="/docs/assets/js/18.76331524.js"><link rel="prefetch" href="/docs/assets/js/19.cea4acd3.js"><link rel="prefetch" href="/docs/assets/js/20.bab0cfd9.js"><link rel="prefetch" href="/docs/assets/js/21.ebaf0d8c.js"><link rel="prefetch" href="/docs/assets/js/22.ad6b7661.js"><link rel="prefetch" href="/docs/assets/js/23.9c37704e.js"><link rel="prefetch" href="/docs/assets/js/24.47e291a3.js"><link rel="prefetch" href="/docs/assets/js/25.dc7a66fe.js"><link rel="prefetch" href="/docs/assets/js/26.3fe5a458.js"><link rel="prefetch" href="/docs/assets/js/27.ffa2a1d6.js"><link rel="prefetch" href="/docs/assets/js/28.378f96e3.js"><link rel="prefetch" href="/docs/assets/js/29.03a6bffd.js"><link rel="prefetch" href="/docs/assets/js/3.e8760d78.js"><link rel="prefetch" href="/docs/assets/js/30.181eede1.js"><link rel="prefetch" href="/docs/assets/js/31.7ab0e1f6.js"><link rel="prefetch" href="/docs/assets/js/32.93606bfe.js"><link rel="prefetch" href="/docs/assets/js/33.48e36f62.js"><link rel="prefetch" href="/docs/assets/js/34.799bff10.js"><link rel="prefetch" href="/docs/assets/js/35.a328f912.js"><link rel="prefetch" href="/docs/assets/js/37.379ac0a9.js"><link rel="prefetch" href="/docs/assets/js/38.5f10c55f.js"><link rel="prefetch" href="/docs/assets/js/39.8c358b85.js"><link rel="prefetch" href="/docs/assets/js/4.7d1e56e0.js"><link rel="prefetch" href="/docs/assets/js/40.fc7f665e.js"><link rel="prefetch" href="/docs/assets/js/41.f7d80a95.js"><link rel="prefetch" href="/docs/assets/js/42.ec31042c.js"><link rel="prefetch" href="/docs/assets/js/43.43f8838e.js"><link rel="prefetch" href="/docs/assets/js/44.88d7b9d6.js"><link rel="prefetch" href="/docs/assets/js/45.29e056dc.js"><link rel="prefetch" href="/docs/assets/js/46.73b4ece8.js"><link rel="prefetch" href="/docs/assets/js/47.cf85ca88.js"><link rel="prefetch" href="/docs/assets/js/48.15e660e5.js"><link rel="prefetch" href="/docs/assets/js/49.d73fe9a7.js"><link rel="prefetch" href="/docs/assets/js/5.540a7edc.js"><link rel="prefetch" href="/docs/assets/js/50.e906cf67.js"><link rel="prefetch" href="/docs/assets/js/51.73d5d894.js"><link rel="prefetch" href="/docs/assets/js/52.6a26c67e.js"><link rel="prefetch" href="/docs/assets/js/53.c45d22c0.js"><link rel="prefetch" href="/docs/assets/js/54.0a0b3240.js"><link rel="prefetch" href="/docs/assets/js/6.3d95153c.js"><link rel="prefetch" href="/docs/assets/js/7.61c08027.js"><link rel="prefetch" href="/docs/assets/js/8.be53284b.js"><link rel="prefetch" href="/docs/assets/js/9.e4f2ada1.js">
    <link rel="stylesheet" href="/docs/assets/css/0.styles.89d6372f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/docs/" class="home-link router-link-active"><!----> <span class="site-name">计算机基础教程</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/docs/" class="nav-link">机器指令</a></div><div class="nav-item"><a href="/docs/software/" class="nav-link router-link-active">软件基础</a></div><div class="nav-item"><a href="/docs/coder2hacker/" class="nav-link">渗透测试</a></div><div class="nav-item"><a href="/docs/blockchain/" class="nav-link">区块链</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/docs/" class="nav-link">机器指令</a></div><div class="nav-item"><a href="/docs/software/" class="nav-link router-link-active">软件基础</a></div><div class="nav-item"><a href="/docs/coder2hacker/" class="nav-link">渗透测试</a></div><div class="nav-item"><a href="/docs/blockchain/" class="nav-link">区块链</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/docs/software/" class="sidebar-link">软件基础</a></li><li><a href="/docs/coder2hacker/" class="sidebar-link">黑客入门</a></li><li><a href="/docs/blockchain/" class="sidebar-link">区块链入门</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p><img src="/docs/docs_image/software/kafka/kafka01.png" alt=""> <img src="/docs/docs_image/software/kafka/kafka02.png" alt=""> <img src="/docs/docs_image/software/kafka/kafka03.png" alt=""> <img src="/docs/docs_image/software/kafka/kafka04.png" alt=""> <img src="/docs/docs_image/software/kafka/kafka05.png" alt=""></p> <p>1.Basic Concepts
What’s Kafka
Why use Kafka
How it works
2.Exactly once Semantics</p> <p>What’s Kafka</p> <p>Apache Kafka is a community distributed streaming platform capable of handling trillions of events a day.
Initially conceived as a messaging queue, Kafka is based on an abstraction of a distributed commit log.
Since being created and open sourced by LinkedIn in 2011,
Kafka has quickly evolved from messaging queue to a full-fledged event streaming platform.</p> <p>Why use Kafka</p> <p>Microservice and kafka already became a de-facto industry standard</p> <div class="language- extra-class"><pre class="language-text"><code>1.
basicaly kafka is a messaging system, compare to other messaging middleware like the one I used before called rabbit mq, with rabbit mq you can only process once,
after consuming the message, it's removed from the queue.
kafka provides durable storage of messages, sometimes kafka is used as a kind of database.
and now kafka has evolved from messaging queue to full-fleged event streaming platform, we're not using the streaming feature, so today the topic only cover messaging queue.

2.
why do we use kafka
Let's have a look at architecuture diagram next slides microservices approach vs traditional approach, 
in traditional approach, application stack multiple layers and compononets together as a single unit.
we can see microservice segregates functionalities into a set of autonamous services,so the circle connecting microservices is message queue system.
there are some advantages for microservice approach,
there is no single point of failure, one service broke down doesn't impact other services;
its easier to scale up, all these services are deployed independently, esier to identify the bottle neck and scale up;
from developer standpoint, it can save a lot of time troubleshooting the microservices compared to debug into the traditional application,
micorservice is designed based on single reponsiblity principle, you can find the paticular service responsible for the cause straightforward.

3.
kafka works like this:
producers publish message to the topics on brokers, the consumers subscribe to the topic will continously poll from the brokers.
in the middle is the brokers, we have 4 brokers, each broker represents one instance of the kafka server, we have 2 topics allocated on the brokers:
topic 1 and topic 2, topic 1 have 2 paritions, topic 2 have 1 parition, each topic has two replications, to publish a message, the producers has to specify 3 params:
the topic name, which partition and the message itself, the messsage will be published on to leader partition, and the followers will replicate from leader,

consumers can join in the same group by config the same application id,
each one partition can be consumed by consumers from different consumer group, but one partition can only be consumed by one consumer in the same consumer group, 
in another word, consumers in the same consumer group load balance the topic partitions, consumers from different consumer group are idenpendent from each other.

4.
one critical concerns is how do we achieve exactly once semantics, how do we guarantee there is no missing or duplicated messages, there is a misconception that 
develop using kafka API will inherently has the capbility to achieve exactly once senmantics, truth is we have to design properly.
to discuss this concern, let's look at a typical application.
we post a message to APP-1, APP-1 extract the data,transform and produce the message to kafka, APP-2 will consume the message.
very simple but it can go wrong from many aspects.
first, the http call, when we make a http post, it may happen that APP-1 recevied the post data and processed, 
but somehow failed to return the reposonse back to the http client due to may be network issue, so the http client side will be timeout, 
normally the http client library will retry for this secnario, if the network recovered, APP-1 will recevie duplicated message, 
in this case from my own experience, what we would do is that we use redis on APP-1 to check duplication. 
the same may happen when APP-1 publish message to kafka, good news is that in the latest kafka version, 
it already help us handled this secnario, all we need to do is simply config enable idempotence to be ture.
go on the consumer side, unfortunately, consumer side is too much complicated, there is no easy way to solve it, 
before further discuss, let me clarify the verb 'processing', there are mainly two types of processing: in-memory processing, the other type is data persist(for example 
store into database, write to kafka), if it's purly in-memory processing there is nothing to worry about, whenever it's broken, so I'm talking about type 2,
, let's assume processing here means write to kafka.
Transactional delivery allows producers to send data to multiple partitions such that either all messages are successfully delivered, or none of them are.
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/docs/assets/js/app.bd9456d1.js" defer></script><script src="/docs/assets/js/2.dc5756d7.js" defer></script><script src="/docs/assets/js/36.d804d8c0.js" defer></script>
  </body>
</html>
