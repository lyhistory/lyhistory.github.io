<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>计算机基础教程</title>
    <meta name="generator" content="VuePress 1.9.7">
    <script async="true" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9742852210287449" crossorigin="anonymous"></script>
    <script async="true" src="https://www.googletagmanager.com/gtag/js?id=AW-748196294"></script>
    <script>
          window.dataLayer = window.dataLayer || [];
		  function gtag(){dataLayer.push(arguments);}
		  gtag('js', new Date());
		  
		  gtag('config', 'AW-748196294');
        </script>
    <script>
			(function() { // DON'T EDIT BELOW THIS LINE
			
			})();
		 </script>
    <meta name="description" content="软件开发教程，白帽黑客入门教程，区块链入门教程，物联网，大数据">
    
    <link rel="preload" href="/docs/assets/css/0.styles.d4eb5ad8.css" as="style"><link rel="preload" href="/docs/assets/js/app.f3b5d2d6.js" as="script"><link rel="preload" href="/docs/assets/js/2.d450803a.js" as="script"><link rel="preload" href="/docs/assets/js/211.4fca6eef.js" as="script"><link rel="prefetch" href="/docs/assets/js/10.6280ea0f.js"><link rel="prefetch" href="/docs/assets/js/100.dd7b2eaf.js"><link rel="prefetch" href="/docs/assets/js/101.120a98da.js"><link rel="prefetch" href="/docs/assets/js/102.1651235e.js"><link rel="prefetch" href="/docs/assets/js/103.d597125d.js"><link rel="prefetch" href="/docs/assets/js/104.ff56395e.js"><link rel="prefetch" href="/docs/assets/js/105.560d6962.js"><link rel="prefetch" href="/docs/assets/js/106.f13a7d16.js"><link rel="prefetch" href="/docs/assets/js/107.045ca855.js"><link rel="prefetch" href="/docs/assets/js/108.87efcedf.js"><link rel="prefetch" href="/docs/assets/js/109.aa3e7576.js"><link rel="prefetch" href="/docs/assets/js/11.68ab8c41.js"><link rel="prefetch" href="/docs/assets/js/110.c91e11ed.js"><link rel="prefetch" href="/docs/assets/js/111.3f0ac95e.js"><link rel="prefetch" href="/docs/assets/js/112.605bdc23.js"><link rel="prefetch" href="/docs/assets/js/113.4be855c2.js"><link rel="prefetch" href="/docs/assets/js/114.7dd886cd.js"><link rel="prefetch" href="/docs/assets/js/115.3174bf56.js"><link rel="prefetch" href="/docs/assets/js/116.c5bbe50c.js"><link rel="prefetch" href="/docs/assets/js/117.caeddc4a.js"><link rel="prefetch" href="/docs/assets/js/118.3c6e58d6.js"><link rel="prefetch" href="/docs/assets/js/119.0d6f1c81.js"><link rel="prefetch" href="/docs/assets/js/12.42639e7a.js"><link rel="prefetch" href="/docs/assets/js/120.d4501723.js"><link rel="prefetch" href="/docs/assets/js/121.1c102c4f.js"><link rel="prefetch" href="/docs/assets/js/122.d59d35bf.js"><link rel="prefetch" href="/docs/assets/js/123.29688b75.js"><link rel="prefetch" href="/docs/assets/js/124.09f5746a.js"><link rel="prefetch" href="/docs/assets/js/125.efea9bcc.js"><link rel="prefetch" href="/docs/assets/js/126.78bb787e.js"><link rel="prefetch" href="/docs/assets/js/127.ece9e615.js"><link rel="prefetch" href="/docs/assets/js/128.c0f197d8.js"><link rel="prefetch" href="/docs/assets/js/129.3ac4512a.js"><link rel="prefetch" href="/docs/assets/js/13.4f960cca.js"><link rel="prefetch" href="/docs/assets/js/130.dd2a1e2a.js"><link rel="prefetch" href="/docs/assets/js/131.6bd8f4d8.js"><link rel="prefetch" href="/docs/assets/js/132.df88ea23.js"><link rel="prefetch" href="/docs/assets/js/133.a3b5fe0a.js"><link rel="prefetch" href="/docs/assets/js/134.ad499f1b.js"><link rel="prefetch" href="/docs/assets/js/135.e27d6df5.js"><link rel="prefetch" href="/docs/assets/js/136.db1b386f.js"><link rel="prefetch" href="/docs/assets/js/137.b076086e.js"><link rel="prefetch" href="/docs/assets/js/138.6edd42b3.js"><link rel="prefetch" href="/docs/assets/js/139.594db60d.js"><link rel="prefetch" href="/docs/assets/js/14.707b2351.js"><link rel="prefetch" href="/docs/assets/js/140.529f22b1.js"><link rel="prefetch" href="/docs/assets/js/141.25bf61d8.js"><link rel="prefetch" href="/docs/assets/js/142.b9b9be79.js"><link rel="prefetch" href="/docs/assets/js/143.2ad03972.js"><link rel="prefetch" href="/docs/assets/js/144.4b7a00a3.js"><link rel="prefetch" href="/docs/assets/js/145.6a3ef15e.js"><link rel="prefetch" href="/docs/assets/js/146.71f24f49.js"><link rel="prefetch" href="/docs/assets/js/147.a435857d.js"><link rel="prefetch" href="/docs/assets/js/148.8cd0636b.js"><link rel="prefetch" href="/docs/assets/js/149.59500037.js"><link rel="prefetch" href="/docs/assets/js/15.234d315c.js"><link rel="prefetch" href="/docs/assets/js/150.49caeee8.js"><link rel="prefetch" href="/docs/assets/js/151.fddc5e98.js"><link rel="prefetch" href="/docs/assets/js/152.38a198ce.js"><link rel="prefetch" href="/docs/assets/js/153.1a9f7c90.js"><link rel="prefetch" href="/docs/assets/js/154.bd050107.js"><link rel="prefetch" href="/docs/assets/js/155.1159a78e.js"><link rel="prefetch" href="/docs/assets/js/156.1f5f9e09.js"><link rel="prefetch" href="/docs/assets/js/157.a3f38260.js"><link rel="prefetch" href="/docs/assets/js/158.1e91a361.js"><link rel="prefetch" href="/docs/assets/js/159.e7aa7e41.js"><link rel="prefetch" href="/docs/assets/js/16.4a51c985.js"><link rel="prefetch" href="/docs/assets/js/160.a14306aa.js"><link rel="prefetch" href="/docs/assets/js/161.b6e6822d.js"><link rel="prefetch" href="/docs/assets/js/162.d830fa56.js"><link rel="prefetch" href="/docs/assets/js/163.036b22f1.js"><link rel="prefetch" href="/docs/assets/js/164.5857fdbc.js"><link rel="prefetch" href="/docs/assets/js/165.50947da1.js"><link rel="prefetch" href="/docs/assets/js/166.714b3640.js"><link rel="prefetch" href="/docs/assets/js/167.b2cff198.js"><link rel="prefetch" href="/docs/assets/js/168.34e075cb.js"><link rel="prefetch" href="/docs/assets/js/169.76549873.js"><link rel="prefetch" href="/docs/assets/js/17.006a54ef.js"><link rel="prefetch" href="/docs/assets/js/170.d251807d.js"><link rel="prefetch" href="/docs/assets/js/171.bd487667.js"><link rel="prefetch" href="/docs/assets/js/172.e3a9e812.js"><link rel="prefetch" href="/docs/assets/js/173.80869caa.js"><link rel="prefetch" href="/docs/assets/js/174.7827131f.js"><link rel="prefetch" href="/docs/assets/js/175.6ee7d79a.js"><link rel="prefetch" href="/docs/assets/js/176.a4fecc5a.js"><link rel="prefetch" href="/docs/assets/js/177.ad2c0780.js"><link rel="prefetch" href="/docs/assets/js/178.f67c11cc.js"><link rel="prefetch" href="/docs/assets/js/179.885cef6f.js"><link rel="prefetch" href="/docs/assets/js/18.f05e0591.js"><link rel="prefetch" href="/docs/assets/js/180.8ae8692d.js"><link rel="prefetch" href="/docs/assets/js/181.697b1f75.js"><link rel="prefetch" href="/docs/assets/js/182.11476875.js"><link rel="prefetch" href="/docs/assets/js/183.cd8aab0f.js"><link rel="prefetch" href="/docs/assets/js/184.a6c0fbe9.js"><link rel="prefetch" href="/docs/assets/js/185.4601014d.js"><link rel="prefetch" href="/docs/assets/js/186.7ab19c26.js"><link rel="prefetch" href="/docs/assets/js/187.f67b4f96.js"><link rel="prefetch" href="/docs/assets/js/188.477a5835.js"><link rel="prefetch" href="/docs/assets/js/189.1a5ad809.js"><link rel="prefetch" href="/docs/assets/js/19.0be4353a.js"><link rel="prefetch" href="/docs/assets/js/190.c0f18fde.js"><link rel="prefetch" href="/docs/assets/js/191.8ca4812a.js"><link rel="prefetch" href="/docs/assets/js/192.dde11235.js"><link rel="prefetch" href="/docs/assets/js/193.88669354.js"><link rel="prefetch" href="/docs/assets/js/194.8ae5c728.js"><link rel="prefetch" href="/docs/assets/js/195.a463164e.js"><link rel="prefetch" href="/docs/assets/js/196.47f3c9fc.js"><link rel="prefetch" href="/docs/assets/js/197.0065d329.js"><link rel="prefetch" href="/docs/assets/js/198.658385f3.js"><link rel="prefetch" href="/docs/assets/js/199.71dc01ef.js"><link rel="prefetch" href="/docs/assets/js/20.3b79ab50.js"><link rel="prefetch" href="/docs/assets/js/200.17d68cc2.js"><link rel="prefetch" href="/docs/assets/js/201.b2b8b8a4.js"><link rel="prefetch" href="/docs/assets/js/202.95d11e68.js"><link rel="prefetch" href="/docs/assets/js/203.960d31ec.js"><link rel="prefetch" href="/docs/assets/js/204.66a3ddbb.js"><link rel="prefetch" href="/docs/assets/js/205.472c9cbc.js"><link rel="prefetch" href="/docs/assets/js/206.dd9df3d0.js"><link rel="prefetch" href="/docs/assets/js/207.b180755c.js"><link rel="prefetch" href="/docs/assets/js/208.952ccdc4.js"><link rel="prefetch" href="/docs/assets/js/209.e30442b0.js"><link rel="prefetch" href="/docs/assets/js/21.9312e011.js"><link rel="prefetch" href="/docs/assets/js/210.c71f633e.js"><link rel="prefetch" href="/docs/assets/js/212.8537f88b.js"><link rel="prefetch" href="/docs/assets/js/213.594847b7.js"><link rel="prefetch" href="/docs/assets/js/214.463a1959.js"><link rel="prefetch" href="/docs/assets/js/215.6971ffc8.js"><link rel="prefetch" href="/docs/assets/js/216.3e1b7339.js"><link rel="prefetch" href="/docs/assets/js/217.05645c53.js"><link rel="prefetch" href="/docs/assets/js/218.8754bb3b.js"><link rel="prefetch" href="/docs/assets/js/219.aa6527a4.js"><link rel="prefetch" href="/docs/assets/js/22.840bab1f.js"><link rel="prefetch" href="/docs/assets/js/220.111da57f.js"><link rel="prefetch" href="/docs/assets/js/221.6a59a9e0.js"><link rel="prefetch" href="/docs/assets/js/222.3ac8bdb5.js"><link rel="prefetch" href="/docs/assets/js/223.1a16a1c2.js"><link rel="prefetch" href="/docs/assets/js/224.dd5faaeb.js"><link rel="prefetch" href="/docs/assets/js/225.23e55812.js"><link rel="prefetch" href="/docs/assets/js/226.800c79e9.js"><link rel="prefetch" href="/docs/assets/js/227.5084e9c9.js"><link rel="prefetch" href="/docs/assets/js/228.f5966dad.js"><link rel="prefetch" href="/docs/assets/js/229.2d0c31fc.js"><link rel="prefetch" href="/docs/assets/js/23.eb14ea0a.js"><link rel="prefetch" href="/docs/assets/js/230.300148d6.js"><link rel="prefetch" href="/docs/assets/js/231.b1e26be6.js"><link rel="prefetch" href="/docs/assets/js/232.059c505d.js"><link rel="prefetch" href="/docs/assets/js/233.df9280b4.js"><link rel="prefetch" href="/docs/assets/js/234.d21644c2.js"><link rel="prefetch" href="/docs/assets/js/235.d4460d3b.js"><link rel="prefetch" href="/docs/assets/js/236.8bb49f02.js"><link rel="prefetch" href="/docs/assets/js/237.f7140b42.js"><link rel="prefetch" href="/docs/assets/js/238.95430d39.js"><link rel="prefetch" href="/docs/assets/js/239.261712eb.js"><link rel="prefetch" href="/docs/assets/js/24.6a3523bd.js"><link rel="prefetch" href="/docs/assets/js/240.38ee337d.js"><link rel="prefetch" href="/docs/assets/js/241.f40397f5.js"><link rel="prefetch" href="/docs/assets/js/242.64630cb9.js"><link rel="prefetch" href="/docs/assets/js/243.ebe87ecb.js"><link rel="prefetch" href="/docs/assets/js/244.59373918.js"><link rel="prefetch" href="/docs/assets/js/245.06410403.js"><link rel="prefetch" href="/docs/assets/js/246.5af5410e.js"><link rel="prefetch" href="/docs/assets/js/247.df4f4f02.js"><link rel="prefetch" href="/docs/assets/js/248.3cdd6d9c.js"><link rel="prefetch" href="/docs/assets/js/249.77ca8aaa.js"><link rel="prefetch" href="/docs/assets/js/25.0d5a5353.js"><link rel="prefetch" href="/docs/assets/js/250.8c75088c.js"><link rel="prefetch" href="/docs/assets/js/251.d6e181e4.js"><link rel="prefetch" href="/docs/assets/js/252.35a42de2.js"><link rel="prefetch" href="/docs/assets/js/253.a3a2519d.js"><link rel="prefetch" href="/docs/assets/js/254.46ac4f4b.js"><link rel="prefetch" href="/docs/assets/js/255.7d9d3285.js"><link rel="prefetch" href="/docs/assets/js/256.264318b3.js"><link rel="prefetch" href="/docs/assets/js/257.73a18588.js"><link rel="prefetch" href="/docs/assets/js/258.db91946d.js"><link rel="prefetch" href="/docs/assets/js/259.ed217b03.js"><link rel="prefetch" href="/docs/assets/js/26.3a5a1001.js"><link rel="prefetch" href="/docs/assets/js/260.2098ed49.js"><link rel="prefetch" href="/docs/assets/js/261.f7ecfd2a.js"><link rel="prefetch" href="/docs/assets/js/262.8200335d.js"><link rel="prefetch" href="/docs/assets/js/263.5e98ca21.js"><link rel="prefetch" href="/docs/assets/js/264.af46e3d4.js"><link rel="prefetch" href="/docs/assets/js/265.8f9770a9.js"><link rel="prefetch" href="/docs/assets/js/266.fdc35c2c.js"><link rel="prefetch" href="/docs/assets/js/267.45256123.js"><link rel="prefetch" href="/docs/assets/js/268.0db74a41.js"><link rel="prefetch" href="/docs/assets/js/269.96bf5145.js"><link rel="prefetch" href="/docs/assets/js/27.2fd17597.js"><link rel="prefetch" href="/docs/assets/js/270.a2a8d685.js"><link rel="prefetch" href="/docs/assets/js/271.80c618b8.js"><link rel="prefetch" href="/docs/assets/js/272.1af647eb.js"><link rel="prefetch" href="/docs/assets/js/273.86894be5.js"><link rel="prefetch" href="/docs/assets/js/274.65f4bed7.js"><link rel="prefetch" href="/docs/assets/js/275.31ce2614.js"><link rel="prefetch" href="/docs/assets/js/276.6e464a86.js"><link rel="prefetch" href="/docs/assets/js/277.9583139c.js"><link rel="prefetch" href="/docs/assets/js/278.6384aaeb.js"><link rel="prefetch" href="/docs/assets/js/279.68947328.js"><link rel="prefetch" href="/docs/assets/js/28.c8f68f87.js"><link rel="prefetch" href="/docs/assets/js/280.6941e4c0.js"><link rel="prefetch" href="/docs/assets/js/281.216abc76.js"><link rel="prefetch" href="/docs/assets/js/282.e1c9392b.js"><link rel="prefetch" href="/docs/assets/js/283.156aa1e0.js"><link rel="prefetch" href="/docs/assets/js/284.9aaabb45.js"><link rel="prefetch" href="/docs/assets/js/285.d3e30f81.js"><link rel="prefetch" href="/docs/assets/js/286.e78c0e38.js"><link rel="prefetch" href="/docs/assets/js/287.1c326756.js"><link rel="prefetch" href="/docs/assets/js/288.64dd2607.js"><link rel="prefetch" href="/docs/assets/js/289.33c8dd2f.js"><link rel="prefetch" href="/docs/assets/js/29.4ca7de48.js"><link rel="prefetch" href="/docs/assets/js/290.2cfaa9e0.js"><link rel="prefetch" href="/docs/assets/js/291.9612fd2e.js"><link rel="prefetch" href="/docs/assets/js/292.39a45f0f.js"><link rel="prefetch" href="/docs/assets/js/293.c2910cee.js"><link rel="prefetch" href="/docs/assets/js/294.1a7d8bdf.js"><link rel="prefetch" href="/docs/assets/js/295.429492e3.js"><link rel="prefetch" href="/docs/assets/js/296.5850d321.js"><link rel="prefetch" href="/docs/assets/js/297.ee526ea1.js"><link rel="prefetch" href="/docs/assets/js/298.4ad8b9fb.js"><link rel="prefetch" href="/docs/assets/js/299.0fa4a4c3.js"><link rel="prefetch" href="/docs/assets/js/3.d8468ba9.js"><link rel="prefetch" href="/docs/assets/js/30.88f734f4.js"><link rel="prefetch" href="/docs/assets/js/300.967725d5.js"><link rel="prefetch" href="/docs/assets/js/301.6fba530e.js"><link rel="prefetch" href="/docs/assets/js/302.c7b19d9b.js"><link rel="prefetch" href="/docs/assets/js/303.c9c22407.js"><link rel="prefetch" href="/docs/assets/js/304.55b24672.js"><link rel="prefetch" href="/docs/assets/js/305.ee18239f.js"><link rel="prefetch" href="/docs/assets/js/306.1394394d.js"><link rel="prefetch" href="/docs/assets/js/307.874736fb.js"><link rel="prefetch" href="/docs/assets/js/308.08e05281.js"><link rel="prefetch" href="/docs/assets/js/309.ab1320d3.js"><link rel="prefetch" href="/docs/assets/js/31.812febfc.js"><link rel="prefetch" href="/docs/assets/js/310.2917c730.js"><link rel="prefetch" href="/docs/assets/js/311.2250928b.js"><link rel="prefetch" href="/docs/assets/js/312.dc9ed218.js"><link rel="prefetch" href="/docs/assets/js/313.5f7354dc.js"><link rel="prefetch" href="/docs/assets/js/314.a2c3822b.js"><link rel="prefetch" href="/docs/assets/js/315.f4ebf138.js"><link rel="prefetch" href="/docs/assets/js/316.0fe20027.js"><link rel="prefetch" href="/docs/assets/js/317.338d1286.js"><link rel="prefetch" href="/docs/assets/js/318.96d07074.js"><link rel="prefetch" href="/docs/assets/js/319.67375a13.js"><link rel="prefetch" href="/docs/assets/js/32.efb9fa2b.js"><link rel="prefetch" href="/docs/assets/js/320.65d4cb05.js"><link rel="prefetch" href="/docs/assets/js/321.62007294.js"><link rel="prefetch" href="/docs/assets/js/322.de6904eb.js"><link rel="prefetch" href="/docs/assets/js/323.6dd9cbd0.js"><link rel="prefetch" href="/docs/assets/js/324.44b75b17.js"><link rel="prefetch" href="/docs/assets/js/325.6ff6abb7.js"><link rel="prefetch" href="/docs/assets/js/326.af03122c.js"><link rel="prefetch" href="/docs/assets/js/327.b9a1294a.js"><link rel="prefetch" href="/docs/assets/js/328.7141ca86.js"><link rel="prefetch" href="/docs/assets/js/329.6f043d29.js"><link rel="prefetch" href="/docs/assets/js/33.e8d002e6.js"><link rel="prefetch" href="/docs/assets/js/330.5339ae91.js"><link rel="prefetch" href="/docs/assets/js/331.f3a0ae22.js"><link rel="prefetch" href="/docs/assets/js/332.89b57255.js"><link rel="prefetch" href="/docs/assets/js/333.2065e258.js"><link rel="prefetch" href="/docs/assets/js/334.912b1efb.js"><link rel="prefetch" href="/docs/assets/js/335.b9e12774.js"><link rel="prefetch" href="/docs/assets/js/336.badc35e4.js"><link rel="prefetch" href="/docs/assets/js/337.7b9cd2de.js"><link rel="prefetch" href="/docs/assets/js/338.31a13056.js"><link rel="prefetch" href="/docs/assets/js/339.59056abd.js"><link rel="prefetch" href="/docs/assets/js/34.7debaff4.js"><link rel="prefetch" href="/docs/assets/js/340.3e0ef988.js"><link rel="prefetch" href="/docs/assets/js/341.79b60e7a.js"><link rel="prefetch" href="/docs/assets/js/342.1ca133c5.js"><link rel="prefetch" href="/docs/assets/js/343.e7176e20.js"><link rel="prefetch" href="/docs/assets/js/344.542e0141.js"><link rel="prefetch" href="/docs/assets/js/345.09658144.js"><link rel="prefetch" href="/docs/assets/js/346.2b048854.js"><link rel="prefetch" href="/docs/assets/js/347.cba5e80b.js"><link rel="prefetch" href="/docs/assets/js/348.21f3c6a5.js"><link rel="prefetch" href="/docs/assets/js/349.575c8e38.js"><link rel="prefetch" href="/docs/assets/js/35.419ae8aa.js"><link rel="prefetch" href="/docs/assets/js/350.9318f172.js"><link rel="prefetch" href="/docs/assets/js/351.9a633e72.js"><link rel="prefetch" href="/docs/assets/js/352.1c9c2c54.js"><link rel="prefetch" href="/docs/assets/js/353.4abd03cf.js"><link rel="prefetch" href="/docs/assets/js/354.82cb73b3.js"><link rel="prefetch" href="/docs/assets/js/355.554f84a2.js"><link rel="prefetch" href="/docs/assets/js/356.70b03c38.js"><link rel="prefetch" href="/docs/assets/js/357.10181c54.js"><link rel="prefetch" href="/docs/assets/js/358.111240b0.js"><link rel="prefetch" href="/docs/assets/js/359.7b0a105d.js"><link rel="prefetch" href="/docs/assets/js/36.144c0c9d.js"><link rel="prefetch" href="/docs/assets/js/360.7b0aaa32.js"><link rel="prefetch" href="/docs/assets/js/361.0fc63c1c.js"><link rel="prefetch" href="/docs/assets/js/362.aea2daa8.js"><link rel="prefetch" href="/docs/assets/js/363.c3b5f161.js"><link rel="prefetch" href="/docs/assets/js/364.69520334.js"><link rel="prefetch" href="/docs/assets/js/365.7a2c02e5.js"><link rel="prefetch" href="/docs/assets/js/366.9ec8c8b0.js"><link rel="prefetch" href="/docs/assets/js/367.8d7ffc0a.js"><link rel="prefetch" href="/docs/assets/js/368.f7a9a256.js"><link rel="prefetch" href="/docs/assets/js/369.b5c1335d.js"><link rel="prefetch" href="/docs/assets/js/37.14945475.js"><link rel="prefetch" href="/docs/assets/js/370.b5f6396b.js"><link rel="prefetch" href="/docs/assets/js/371.7470a948.js"><link rel="prefetch" href="/docs/assets/js/372.8a1ecb6c.js"><link rel="prefetch" href="/docs/assets/js/38.86e1cb4f.js"><link rel="prefetch" href="/docs/assets/js/39.351f0ffc.js"><link rel="prefetch" href="/docs/assets/js/4.6d27a4d7.js"><link rel="prefetch" href="/docs/assets/js/40.edec7486.js"><link rel="prefetch" href="/docs/assets/js/41.e086c257.js"><link rel="prefetch" href="/docs/assets/js/42.be094b47.js"><link rel="prefetch" href="/docs/assets/js/43.5e89fd04.js"><link rel="prefetch" href="/docs/assets/js/44.90a633ec.js"><link rel="prefetch" href="/docs/assets/js/45.f6c9f171.js"><link rel="prefetch" href="/docs/assets/js/46.26056234.js"><link rel="prefetch" href="/docs/assets/js/47.60a0ffb3.js"><link rel="prefetch" href="/docs/assets/js/48.cb7836d7.js"><link rel="prefetch" href="/docs/assets/js/49.e02b00fd.js"><link rel="prefetch" href="/docs/assets/js/5.3f8add54.js"><link rel="prefetch" href="/docs/assets/js/50.085679f8.js"><link rel="prefetch" href="/docs/assets/js/51.1711c0b5.js"><link rel="prefetch" href="/docs/assets/js/52.316fca4c.js"><link rel="prefetch" href="/docs/assets/js/53.304208d7.js"><link rel="prefetch" href="/docs/assets/js/54.23dbc7f7.js"><link rel="prefetch" href="/docs/assets/js/55.38293be8.js"><link rel="prefetch" href="/docs/assets/js/56.a9114d19.js"><link rel="prefetch" href="/docs/assets/js/57.a160db01.js"><link rel="prefetch" href="/docs/assets/js/58.edb10a0c.js"><link rel="prefetch" href="/docs/assets/js/59.881f3b69.js"><link rel="prefetch" href="/docs/assets/js/6.46c18dae.js"><link rel="prefetch" href="/docs/assets/js/60.a73250e3.js"><link rel="prefetch" href="/docs/assets/js/61.7a3ec1d5.js"><link rel="prefetch" href="/docs/assets/js/62.e528d9c3.js"><link rel="prefetch" href="/docs/assets/js/63.f35a521c.js"><link rel="prefetch" href="/docs/assets/js/64.2b24d5e0.js"><link rel="prefetch" href="/docs/assets/js/65.dabf4313.js"><link rel="prefetch" href="/docs/assets/js/66.9ce31f6b.js"><link rel="prefetch" href="/docs/assets/js/67.43831855.js"><link rel="prefetch" href="/docs/assets/js/68.1541268f.js"><link rel="prefetch" href="/docs/assets/js/69.988f4492.js"><link rel="prefetch" href="/docs/assets/js/7.be017326.js"><link rel="prefetch" href="/docs/assets/js/70.a8bf1434.js"><link rel="prefetch" href="/docs/assets/js/71.f925cfec.js"><link rel="prefetch" href="/docs/assets/js/72.4cc4b709.js"><link rel="prefetch" href="/docs/assets/js/73.91da6b8a.js"><link rel="prefetch" href="/docs/assets/js/74.9c4d392c.js"><link rel="prefetch" href="/docs/assets/js/75.b7358cb3.js"><link rel="prefetch" href="/docs/assets/js/76.2369e6c7.js"><link rel="prefetch" href="/docs/assets/js/77.2619c27d.js"><link rel="prefetch" href="/docs/assets/js/78.8c6fe860.js"><link rel="prefetch" href="/docs/assets/js/79.a677a882.js"><link rel="prefetch" href="/docs/assets/js/8.ee4d56b4.js"><link rel="prefetch" href="/docs/assets/js/80.0f780c8a.js"><link rel="prefetch" href="/docs/assets/js/81.6b0e1e78.js"><link rel="prefetch" href="/docs/assets/js/82.d175d70f.js"><link rel="prefetch" href="/docs/assets/js/83.56b2ed24.js"><link rel="prefetch" href="/docs/assets/js/84.bf73bf5b.js"><link rel="prefetch" href="/docs/assets/js/85.3350db79.js"><link rel="prefetch" href="/docs/assets/js/86.a6715be6.js"><link rel="prefetch" href="/docs/assets/js/87.6dda8387.js"><link rel="prefetch" href="/docs/assets/js/88.f0f32c09.js"><link rel="prefetch" href="/docs/assets/js/89.3d6e839c.js"><link rel="prefetch" href="/docs/assets/js/9.a5996d1e.js"><link rel="prefetch" href="/docs/assets/js/90.3a2f84ba.js"><link rel="prefetch" href="/docs/assets/js/91.b7120088.js"><link rel="prefetch" href="/docs/assets/js/92.758bd9dc.js"><link rel="prefetch" href="/docs/assets/js/93.6d78b268.js"><link rel="prefetch" href="/docs/assets/js/94.79ab27dd.js"><link rel="prefetch" href="/docs/assets/js/95.3000b404.js"><link rel="prefetch" href="/docs/assets/js/96.21cd94f2.js"><link rel="prefetch" href="/docs/assets/js/97.ec77883f.js"><link rel="prefetch" href="/docs/assets/js/98.7e4dd49d.js"><link rel="prefetch" href="/docs/assets/js/99.41131ae1.js">
    <link rel="stylesheet" href="/docs/assets/css/0.styles.d4eb5ad8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/docs/" class="home-link router-link-active"><!----> <span class="site-name">计算机基础教程</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/docs/" class="nav-link">
  机器指令
</a></div><div class="nav-item"><a href="/docs/software/" class="nav-link router-link-active">
  软件基础
</a></div><div class="nav-item"><a href="/docs/coder2hacker/" class="nav-link">
  白帽黑客
</a></div><div class="nav-item"><a href="/docs/blockchain/" class="nav-link">
  区块链
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/docs/" class="nav-link">
  机器指令
</a></div><div class="nav-item"><a href="/docs/software/" class="nav-link router-link-active">
  软件基础
</a></div><div class="nav-item"><a href="/docs/coder2hacker/" class="nav-link">
  白帽黑客
</a></div><div class="nav-item"><a href="/docs/blockchain/" class="nav-link">
  区块链
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span></span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/software/database/postgresql_pgpool.html#_1-knowledge-base" class="sidebar-link">1.Knowledge base</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/software/database/postgresql_pgpool.html#_1-1-what-is" class="sidebar-link">1.1 What is</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/postgresql_pgpool.html#_1-2-restrictions" class="sidebar-link">1.2 Restrictions</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/postgresql_pgpool.html#_1-3-installation-of-pgpool-ii" class="sidebar-link">1.3 Installation of Pgpool-II</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/postgresql_pgpool.html#_1-4-configuration-server-setup-and-operation" class="sidebar-link">1.4 Configuration(Server Setup and Operation)</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/postgresql_pgpool.html#_1-5-watchdog" class="sidebar-link">1.5 Watchdog</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/postgresql_pgpool.html#architecure-of-the-watchdog" class="sidebar-link" style="padding-left:3rem;">Architecure of the watchdog</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/postgresql_pgpool.html#restrictions" class="sidebar-link" style="padding-left:3rem;">Restrictions</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/postgresql_pgpool.html#starting-stopping-watchdog" class="sidebar-link" style="padding-left:3rem;">Starting/stopping watchdog</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/postgresql_pgpool.html#integrating-external-lifecheck-with-watchdog" class="sidebar-link" style="padding-left:3rem;">Integrating external lifecheck with watchdog</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/postgresql_pgpool.html#_1-6-server-configuration" class="sidebar-link">1.6 Server Configuration</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/postgresql_pgpool.html#_1-6-client-authentication" class="sidebar-link">1.6 Client Authentication</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/postgresql_pgpool.html#_1-7-performance-considerations" class="sidebar-link">1.7 Performance Considerations</a></li></ul></li><li><a href="/docs/software/database/postgresql_pgpool.html#_2-pgpool-ii-watchdog-setup-example" class="sidebar-link">2. Pgpool-II + Watchdog Setup Example</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/software/database/postgresql_pgpool.html#_2-1-simple-two-nodes-replication" class="sidebar-link">2.1 Simple two Nodes Replication</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/postgresql_pgpool.html#_2-1-1-installing-pgpool-ii" class="sidebar-link" style="padding-left:3rem;">2.1.1 Installing Pgpool-II</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/postgresql_pgpool.html#_2-1-2-configuration" class="sidebar-link" style="padding-left:3rem;">2.1.2 Configuration</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/postgresql_pgpool.html#_2-1-3-starting-stopping-pgpool-ii" class="sidebar-link" style="padding-left:3rem;">2.1.3 Starting/Stopping Pgpool-II</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/postgresql_pgpool.html#_2-1-4-configuring-replication" class="sidebar-link" style="padding-left:3rem;">2.1.4 Configuring Replication</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/postgresql_pgpool.html#_2-1-5-watchdog-configuration-example" class="sidebar-link" style="padding-left:3rem;">2.1.5 Watchdog Configuration Example</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/postgresql_pgpool.html#_2-2-pgpool-ii-watchdog-setup-streaming-replication-mode" class="sidebar-link">2.2 Pgpool-II+ Watchdog Setup (Streaming replication mode)</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/postgresql_pgpool.html#_2-2-1-stepup-postgresql-server-data-nodes" class="sidebar-link" style="padding-left:3rem;">2.2.1 Stepup postgresql server (data nodes)</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/postgresql_pgpool.html#_2-2-1-1-install-postgresql-by-using-postgresql-yum-repository" class="sidebar-link" style="padding-left:4rem;">2.2.1.1 Install PostgreSQL by using PostgreSQL YUM repository.</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/postgresql_pgpool.html#_2-2-1-2-set-up-postgresql-streaming-replication-on-the-primary-server" class="sidebar-link" style="padding-left:4rem;">2.2.1.2 Set up PostgreSQL streaming replication on the primary server.</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/postgresql_pgpool.html#_2-2-1-4-create-users" class="sidebar-link" style="padding-left:4rem;">2.2.1.4 create users</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/postgresql_pgpool.html#_2-2-1-5-enable-scram-sha-256-authentication-method" class="sidebar-link" style="padding-left:4rem;">2.2.1.5 enable scram-sha-256 authentication method</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/postgresql_pgpool.html#_2-2-1-6-passwordless-ssh" class="sidebar-link" style="padding-left:4rem;">2.2.1.6 passwordless SSH</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/postgresql_pgpool.html#_2-2-1-7-allow-repl-user-without-specifying-password-for-streaming-replication-and-online-recovery" class="sidebar-link" style="padding-left:4rem;">2.2.1.7 allow repl user without specifying password for streaming replication and online recovery</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/postgresql_pgpool.html#_2-2-1-8-firewall-for-postgres" class="sidebar-link" style="padding-left:4rem;">2.2.1.8 firewall for postgres</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/postgresql_pgpool.html#_2-2-1-9-summary" class="sidebar-link" style="padding-left:4rem;">2.2.1.9 Summary</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/postgresql_pgpool.html#_2-2-2-setup-pgpool-ii-watchdog" class="sidebar-link" style="padding-left:3rem;">2.2.2 Setup Pgpool-II+Watchdog</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/postgresql_pgpool.html#_2-2-2-1-install-pgpool-ii" class="sidebar-link" style="padding-left:4rem;">2.2.2.1 Install Pgpool-II</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/postgresql_pgpool.html#_2-2-2-2-pgpool-ii-configuration-common-settings" class="sidebar-link" style="padding-left:4rem;">2.2.2.2 Pgpool-II Configuration - Common Settings</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/postgresql_pgpool.html#_2-2-2-3-pgpool-ii-configuration-failover-configuration" class="sidebar-link" style="padding-left:4rem;">2.2.2.3 Pgpool-II Configuration - Failover configuration</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/postgresql_pgpool.html#_2-2-2-4-pgpool-ii-configuration-online-recovery-configurations" class="sidebar-link" style="padding-left:4rem;">2.2.2.4 Pgpool-II Configuration - Online Recovery Configurations</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/postgresql_pgpool.html#_2-2-2-5-pgpool-ii-configuration-client-authentication-configuration" class="sidebar-link" style="padding-left:4rem;">2.2.2.5 Pgpool-II Configuration - Client Authentication Configuration</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/postgresql_pgpool.html#_2-2-2-6-pgpool-ii-configuration-watchdog-configuration" class="sidebar-link" style="padding-left:4rem;">2.2.2.6 Pgpool-II Configuration - Watchdog Configuration</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/postgresql_pgpool.html#_2-2-2-7-pgpool-ii-configuration-etc-sysconfig-pgpool-configuration" class="sidebar-link" style="padding-left:4rem;">2.2.2.7 Pgpool-II Configuration - /etc/sysconfig/pgpool Configuration</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/postgresql_pgpool.html#_2-2-2-8-pgpool-ii-configuration-logging" class="sidebar-link" style="padding-left:4rem;">2.2.2.8 Pgpool-II Configuration - Logging</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/postgresql_pgpool.html#_2-2-2-9-pgpool-ii-configuration-pcp-command-configuration" class="sidebar-link" style="padding-left:4rem;">2.2.2.9 Pgpool-II Configuration - PCP Command Configuration</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/postgresql_pgpool.html#_2-2-2-10-pgpool-ii-configuration-pcppass" class="sidebar-link" style="padding-left:4rem;">2.2.2.10 Pgpool-II Configuration - .pcppass</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/postgresql_pgpool.html#_2-2-2-11-firewall-for-pgpool-ii" class="sidebar-link" style="padding-left:4rem;">2.2.2.11 firewall for Pgpool-II</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/postgresql_pgpool.html#_2-2-2-12-summary" class="sidebar-link" style="padding-left:4rem;">2.2.2.12 Summary</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/postgresql_pgpool.html#_2-2-3-assign-permission-and-set-env-path" class="sidebar-link" style="padding-left:3rem;">2.2.3 Assign Permission and set env path</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/postgresql_pgpool.html#_2-2-4-starting-stopping-pgpool-ii" class="sidebar-link" style="padding-left:3rem;">2.2.4 Starting/Stopping Pgpool-II</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/postgresql_pgpool.html#_2-2-5-set-up-postgresql-standby-server" class="sidebar-link" style="padding-left:3rem;">2.2.5 Set up PostgreSQL standby server</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/postgresql_pgpool.html#_2-2-6-switching-active-standby-watchdog" class="sidebar-link" style="padding-left:3rem;">2.2.6 Switching active/standby watchdog</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/postgresql_pgpool.html#_2-2-7-test-failover" class="sidebar-link" style="padding-left:3rem;">2.2.7 test Failover</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/postgresql_pgpool.html#_2-2-8-test-online-recovery" class="sidebar-link" style="padding-left:3rem;">2.2.8 test Online Recovery</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/postgresql_pgpool.html#_2-2-9-test-replication" class="sidebar-link" style="padding-left:3rem;">2.2.9 test replication</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/postgresql_pgpool.html#_2-2-10-test-loadbalance" class="sidebar-link" style="padding-left:3rem;">2.2.10 test loadbalance</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/postgresql_pgpool.html#_2-2-11-reset" class="sidebar-link" style="padding-left:3rem;">2.2.11 reset</a></li></ul></li><li><a href="/docs/software/database/postgresql_pgpool.html#manage-pgpool-ii" class="sidebar-link">Manage PgPool-II</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/software/database/postgresql_pgpool.html#pgpool-cluster-workflow-summary" class="sidebar-link">Pgpool cluster WorkFlow Summary</a></li></ul></li><li><a href="/docs/software/database/postgresql_pgpool.html#troubleshooting" class="sidebar-link">Troubleshooting</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/software/database/postgresql_pgpool.html#pcp-recovery-node-error" class="sidebar-link">pcprecoverynode error</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/postgresql_pgpool.html#error-executing-recovery" class="sidebar-link" style="padding-left:3rem;">ERROR: executing recovery</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/postgresql_pgpool.html#error-invalid-character" class="sidebar-link" style="padding-left:3rem;">ERROR: invalid character</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/postgresql_pgpool.html#stuck-in-printing-password" class="sidebar-link" style="padding-left:3rem;">stuck in printing 'Password:'</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/postgresql_pgpool.html#error-sed-no-input-files" class="sidebar-link" style="padding-left:3rem;">ERROR: sed no input files</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/postgresql_pgpool.html#error-executing-remote-start-failed-with-error-error-pgpool-remote-start-failed" class="sidebar-link" style="padding-left:3rem;">ERROR:  executing remote start failed with error: &quot;ERROR:  pgpoolremotestart failed</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/postgresql_pgpool.html#failover-failed" class="sidebar-link">Failover failed</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p>https://www.pgpool.net/docs/pgpool-II-4.1.0/en/html/index.html</p> <p>Pgpool-II</p> <h2 id="_1-knowledge-base"><a href="#_1-knowledge-base" class="header-anchor">#</a> 1.Knowledge base</h2> <h3 id="_1-1-what-is"><a href="#_1-1-what-is" class="header-anchor">#</a> 1.1 What is</h3> <p>Pgpool-II is a proxy server sitting between clients and PostgreSQL. Pgpool-II understands the wire level protocol used by PostgreSQL called &quot;frontend and backend protocol&quot;. For more details of the protocol, see the PostgreSQL manual. No modified PostgreSQL is required to use Pgpool-II (more precisely, you will need a few extensions to use full functions of Pgpool-II). So Pgpool-II can cope with variety of PostgreSQL versions. In theory, even the earliest version of PostgreSQL can be used with Pgpool-II. Same thing can be said to client side. As long as it follows the protocol, Pgpool-II happily accept connections from it, no matter what kind of languages or drivers it uses.</p> <p>Pgpool-II consists of multiple process. There is a <strong>main process</strong>, which is the parent process of all other process. It is responsible for forking child process each of which accepts connections from clients. There are some <strong>worker process</strong> those are forked from the main process as well, which is responsible for detecting streaming replication delay. There is also a special process called <strong>&quot;pcp process&quot;</strong>, which is solely used for management of Pgpool-II itself. Pgpool-II has a built-in high availability function called <strong>&quot;watchdog&quot;</strong>. Watchdog consists of some process.</p> <p><img src="/docs/docs_image/software/postgresql/pgpool-ii_architect.gif" alt="https://www.pgpool.net/docs/42/en/html/tutorial-arch.html">
https://www.pgpool.net/docs/pgpool-II-4.1.0/en/html/tutorial-arch.html</p> <p>It provides the following features:</p> <ul><li><p>Connection Pooling
Pgpool-II maintains established connections to the PostgreSQL servers, and reuses them whenever a new connection with the same properties (i.e. user name, database, protocol version, and other connection parameters if any) comes in. It reduces the connection overhead, and improves system's overall throughput.</p></li> <li><p>Load Balancing
If a database is replicated (because running in either replication mode or master/slave mode), performing a SELECT query on any server will return the same result. Pgpool-II takes advantage of the replication feature in order to reduce the load on each PostgreSQL server. It does that by distributing SELECT queries among available servers, improving the system's overall throughput. In an ideal scenario, read performance could improve proportionally to the number of PostgreSQL servers. Load balancing works best in a scenario where there are a lot of users executing many read-only queries at the same time.</p></li> <li><p>Automated fail over
If one of the database servers goes down or becomes unreachable, Pgpool-II will detach it and will continue operations by using the rest of database servers. There are some sophisticated features that help the automated failover including timeouts and retries.</p></li> <li><p>Online Recovery
Pgpool-II can perform online recovery of database node by executing one command. When the online recovery is used with the automated fail over, a detached node by fail over is possible to attach as standby node automatically. It is possible to synchronize and attach new PostgreSQL server too.</p></li> <li><p>Replication
Pgpool-II can manage multiple PostgreSQL servers. Activating the replication feature makes it possible to create a real time backup on 2 or more PostgreSQL clusters, so that the service can continue without interruption if one of those clusters fails. Pgpool-II has built-in replication (native replication). However user can use external replication features including streaming replication of PostgreSQL.</p></li> <li><p>Limiting Exceeding Connections
There is a limit on the maximum number of concurrent connections with PostgreSQL, and new connections are rejected when this number is reached. Raising this maximum number of connections, however, increases resource consumption and has a negative impact on overall system performance. Pgpool-II also has a limit on the maximum number of connections, but extra connections will be queued instead of returning an error immediately. However, you can configure to return an error when the connection limit is exceeded (4.1 or later).</p></li> <li><p>Watchdog
Watchdog can coordinate multiple Pgpool-II, create a robust cluster system and avoid the single point of failure or split brain. Watchdog can perform lifecheck against other pgpool-II nodes, to detect a fault of Pgpoll-II. If active Pgpool-II goes down, standby Pgpool-II can be promoted to active, and take over Virtual IP.</p></li> <li><p>In Memory Query Cache
In memory query cache allows to save a pair of SELECT statement and its result. If an identical SELECTs comes in, Pgpool-II returns the value from cache. Since no SQL parsing nor access to PostgreSQL are involved, using in memory cache is extremely fast. On the other hand, it might be slower than the normal path in some cases, because it adds some overhead of storing cache data.</p></li></ul> <h3 id="_1-2-restrictions"><a href="#_1-2-restrictions" class="header-anchor">#</a> 1.2 Restrictions</h3> <p>https://www.pgpool.net/docs/pgpool-II-4.1.0/en/html/restrictions.html</p> <p>https://www.pgpool.net/docs/pgpool-II-4.1.0/en/html/admin.html</p> <h3 id="_1-3-installation-of-pgpool-ii"><a href="#_1-3-installation-of-pgpool-ii" class="header-anchor">#</a> 1.3 Installation of Pgpool-II</h3> <p><strong>install from source or rpm</strong></p> <p>build from source: https://www.pgpool.net/docs/pgpool-II-4.1.0/en/html/install-requirements.html</p> <p>install from rpm:</p> <div class="language- extra-class"><pre class="language-text"><code>yum install http://www.pgpool.net/yum/rpms/4.0/redhat/rhel-7-x86_64/pgpool-II-release-4.0-1.noarch.rpm
yum install pgpool-II-pg11

rpm direct download: https://yum.postgresql.org/rpmchart/

pg11 means PostgreSQL 11. Pgpool-II needs PostgreSQL's library and extensions directory. Since the directory paths are different in the particular PostgreSQL versions, You must choose appropriate RPM for your PostgreSQL rpm installation. We also assume you are using PostgreSQL community rpms. Optionally you can install:
yum install pgpool-II-pg11-debuginfo
which makes it easier to retrieve debugging symbols from the core or the backtrace. We recommend to install it. There is an optional package for developers.
yum install pgpool-II-pg11-devel
This installs header files which developers are interested in

On all the PostgreSQL servers you need to install:
yum install pgpool-II-pg11-extensions

systemctl enable pgpool.service
systemctl start pgpool.service 
systemctl stop pgpool.service 
</code></pre></div><p><strong>firewall</strong></p> <div class="language- extra-class"><pre class="language-text"><code>#allow to access port that Pgpool-II use.
firewall-cmd --permanent --zone=public --add-port=9999/tcp --add-port=9898/tcp --add-port=9000/tcp  --add-port=9694/tcp
firewall-cmd --permanent --zone=public --add-port=9999/udp --add-port=9898/udp --add-port=9000/udp  --add-port=9694/udp
firewall-cmd --reload

#access to PostgreSQL
firewall-cmd --permanent --zone=public --add-service=postgresql
firewall-cmd --reload
</code></pre></div><p><strong>(optional) online recovery</strong>
https://www.pgpool.net/docs/pgpool-II-4.1.0/en/html/install-pgpool-recovery.html</p> <p><strong>(optional) native replication mode</strong>
https://www.pgpool.net/docs/pgpool-II-4.1.0/en/html/create-installlock-table.html</p> <p><strong>(optional) Compiling and installing documents</strong>
https://www.pgpool.net/docs/pgpool-II-4.1.0/en/html/install-docs.html</p> <h3 id="_1-4-configuration-server-setup-and-operation"><a href="#_1-4-configuration-server-setup-and-operation" class="header-anchor">#</a> 1.4 Configuration(Server Setup and Operation)</h3> <ul><li>if installed from rpm: all the Pgpool-II configuration files live in <strong>/etc/pgpool-II</strong></li> <li>if installed from source code: <strong>$prefix/etc/pgpool.conf by default</strong> (/usr/local/etc )</li></ul> <p><strong>create The Pgpool-II User Account</strong>
As with any server daemon that is accessible to the outside world, it is advisable to run Pgpool-II under a separate user account. This user account should only own the data that is managed by the server, and should not be shared with other daemons. (For example, using the user nobody is a bad idea.) It is not advisable to install executables owned by this user because compromised systems could then modify their own binaries.</p> <div class="language- extra-class"><pre class="language-text"><code>useradd -m -d /home/pgpool pgpool

</code></pre></div><p><strong>Configuring pcp.conf</strong></p> <p>Pgpool-II provides a interface for administrators to perform management operation, such as getting Pgpool-II status or terminating Pgpool-II processes remotely. pcp.conf is the user/password file used for authentication by this interface.</p> <div class="language- extra-class"><pre class="language-text"><code> $ pg_md5 your_password
 $ cp /etc/pgpool-II/pcp.conf.sample /etc/pgpool-II/pcp.conf
 username:[md5 encrypted password]

</code></pre></div><p><strong>Configuring Pgpool-II</strong></p> <p>pgpool.conf is the main configuration file of Pgpool-II. You need to specify the path to the file when starting Pgpool-II using -f option.</p> <p>There are four different running modes in Pgpool-II: streaming replication mode, logical replication mode, master slave mode (slony mode), native replication mode and raw mode. In any mode, Pgpool-II provides connection pooling, automatic fail over and online recovery.</p> <p>pgpool.conf samples:</p> <table><thead><tr><th>Operation mode</th> <th>Configuration file name</th></tr></thead> <tbody><tr><td>Streaming replication mode</td> <td>-</td></tr> <tr><td>Replication mode</td> <td>pgpool.conf.sample-replication</td></tr> <tr><td>Master slave mode</td> <td>-</td></tr> <tr><td>Raw mode</td> <td>pgpool.conf.sample</td></tr> <tr><td>Logical replication mode</td> <td>pgpool.conf.sample-logical</td></tr></tbody></table> <div class="language- extra-class"><pre class="language-text"><code>cp /etc/pgpool-II/pgpool.conf.sample-stream /etc/pgpool-II/pgpool.conf
</code></pre></div><p>https://www.pgpool.net/docs/pgpool-II-4.1.1/en/html/configuring-pgpool.html</p> <p><strong>Configuring backend information</strong>
For Pgpool-II to recognize PostgreSQL backend servers, you need to configure backend* in pgpool.conf. For starters, at least backend_hostname and backend_port parameters are required to be set up to start Pgpool-II server.</p> <p>/etc/pgpool-II/pgpool.conf</p> <p>https://www.pgpool.net/docs/pgpool-II-4.1.1/en/html/runtime-config-backend-settings.html</p> <h3 id="_1-5-watchdog"><a href="#_1-5-watchdog" class="header-anchor">#</a> 1.5 Watchdog</h3> <p>Watchdog is a sub process of Pgpool-II to add high availability. Watchdog is used to resolve the single point of failure by coordinating multiple pgpool-II nodes.
To ensure the quorum mechanism properly works, the number of pgpool-II nodes must be odd in number and greater than or equal to 3.</p> <h4 id="architecure-of-the-watchdog"><a href="#architecure-of-the-watchdog" class="header-anchor">#</a> Architecure of the watchdog</h4> <p>https://www.pgpool.net/docs/pgpool-II-4.1.1/en/html/tutorial-advanced-arch.html</p> <ul><li>Coordinating multiple Pgpool-II nodes
At the startup, if the watchdog is enabled, Pgpool-II node sync the status of all configured backend nodes from the master watchdog node. And if the node goes on to become a master node itself it initializes the backend status locally. When a backend node status changes by failover etc.., watchdog notifies the information to other Pgpool-II nodes and synchronizes them. When online recovery occurs, watchdog restricts client connections to other Pgpool-II nodes for avoiding inconsistency between backends.</li></ul> <p>Watchdog also coordinates with all connected Pgpool-II nodes to ensure that failback, failover and follow_master commands must be executed only on one pgpool-II node.</p> <ul><li><p>Life checking of other Pgpool-II nodes
Watchdog lifecheck is the sub-component of watchdog to monitor the health of Pgpool-II nodes participating in the watchdog cluster to provide the high availability. Traditionally Pgpool-II watchdog provides two methods of remote node health checking. &quot;heartbeat&quot; and &quot;query&quot; mode.
Apart from remote node health checking watchdog lifecheck can also check the health of node it is installed on by monitoring the connection to upstream servers. If the monitoring fails, watchdog treats it as the local Pgpool-II node failure.</p> <ul><li><p>In heartbeat mode, watchdog monitors other Pgpool-II processes by using heartbeat signal. Watchdog receives heartbeat signals sent by other Pgpool-II periodically. If there is no signal for a certain period, watchdog regards this as the failure of the Pgpool-II. For redundancy you can use multiple network connections for heartbeat exchange between Pgpool-II nodes. This is the default and recommended mode to be used for health checking.</p></li> <li><p>In query mode, watchdog monitors Pgpool-II service rather than process. In this mode watchdog sends queries to other Pgpool-II and checks the response.</p></li> <li><p>external mode is introduced by Pgpool-II V3.5. This mode basically disables the built in lifecheck of Pgpool-II watchdog and expects that the external system will inform the watchdog about health of local and all remote nodes participating in the watchdog cluster.</p></li></ul></li> <li><p>Consistency of configuration parameters on all Pgpool-II nodes
At startup watchdog verifies the Pgpool-II configuration of the local node for the consistency with the configurations on the master watchdog node and warns the user of any differences.</p></li> <li><p>Changing active/standby state when certain fault is detected
When a fault of Pgpool-II is detected, watchdog notifies the other watchdogs of it. If this is the active Pgpool-II, watchdogs decide the new active Pgpool-II by voting and change active/standby state.</p></li> <li><p>Automatic virtual IP switching
When a standby Pgpool-II server promotes to active, the new active server brings up virtual IP interface. Meanwhile, the previous active server brings down the virtual IP interface.</p></li> <li><p>Automatic registration of a server as a standby in recovery
When the broken server recovers or new server is attached, the watchdog process notifies this to the other watchdogs in the cluster along with the information of the new server, and the watchdog process receives information on the active server and other servers. Then, the attached server is registered as a standby.</p></li></ul> <h4 id="restrictions"><a href="#restrictions" class="header-anchor">#</a> Restrictions</h4> <p>https://www.pgpool.net/docs/pgpool-II-4.1.1/en/html/tutorial-watchdog-restrictions.html</p> <h4 id="starting-stopping-watchdog"><a href="#starting-stopping-watchdog" class="header-anchor">#</a> Starting/stopping watchdog</h4> <p>The watchdog process starts and stops automatically as sub-processes of the Pgpool-II, therefore there is no dedicated command to start and stop watchdog.</p> <p>Watchdog controls the virtual IP interface, the commands executed by the watchdog for bringing up and bringing down the VIP require the root privileges. Pgpool-II requires the user running Pgpool-II to have root privileges when the watchdog is enabled along with virtual IP. This is however not good security practice to run the Pgpool-II as root user, the alternative and preferred way is to run the Pgpool-II as normal user and use either the custom commands for if_up_cmd, if_down_cmd, and arping_cmd using sudo or use setuid (&quot;set user ID upon execution&quot;) on if_* commands</p> <p>Lifecheck process is a sub-component of watchdog, its job is to monitor the health of Pgpool-II nodes participating in the watchdog cluster. The Lifecheck process is started automatically when the watchdog is configured to use the built-in life-checking, it starts after the watchdog main process initialization is complete. However lifecheck process only kicks in when all configured watchdog nodes join the cluster and becomes active. If some remote node fails before the Lifecheck become active that failure will not get caught by the lifecheck.</p> <h4 id="integrating-external-lifecheck-with-watchdog"><a href="#integrating-external-lifecheck-with-watchdog" class="header-anchor">#</a> Integrating external lifecheck with watchdog</h4> <p>https://www.pgpool.net/docs/pgpool-II-4.1.1/en/html/tutorial-watchdog-integrating-external-lifecheck.html</p> <h3 id="_1-6-server-configuration"><a href="#_1-6-server-configuration" class="header-anchor">#</a> 1.6 Server Configuration</h3> <p>https://www.pgpool.net/docs/pgpool-II-4.1.1/en/html/runtime-config.html</p> <p><strong>Setting Parameters</strong></p> <p>Connections and Authentication</p> <p>Running mode</p> <p>Backend Settings</p> <p>Connection Pooling</p> <p>Error Reporting and Logging</p> <p>Load Balancing</p> <p>Health Check</p> <p>Failover and Failback</p> <p>Online Recovery</p> <p>Streaming Replication Check</p> <p>In Memory Query Cache</p> <p>Secure Sockect Layer (SSL)</p> <p>Watchdog</p> <p>Misc Configuration Parameters</p> <h3 id="_1-6-client-authentication"><a href="#_1-6-client-authentication" class="header-anchor">#</a> 1.6 Client Authentication</h3> <p>https://www.pgpool.net/docs/pgpool-II-4.1.0/en/html/client-authentication.html</p> <p>The pool_hba.conf File</p> <p>Authentication Methods</p> <p>Using different methods for frontend and backend authentication</p> <p>Using AES256 encrypted passwords in pool_passwd</p> <h3 id="_1-7-performance-considerations"><a href="#_1-7-performance-considerations" class="header-anchor">#</a> 1.7 Performance Considerations</h3> <p>https://www.pgpool.net/docs/pgpool-II-4.1.0/en/html/performance.html</p> <h2 id="_2-pgpool-ii-watchdog-setup-example"><a href="#_2-pgpool-ii-watchdog-setup-example" class="header-anchor">#</a> 2. Pgpool-II + Watchdog Setup Example</h2> <p>https://www.pgpool.net/docs/pgpool-II-4.1.0/en/html/example-configs.html</p> <h3 id="_2-1-simple-two-nodes-replication"><a href="#_2-1-simple-two-nodes-replication" class="header-anchor">#</a> 2.1 Simple two Nodes Replication</h3> <p>https://www.pgpool.net/docs/pgpool-II-4.1.0/en/html/example-basic.html
https://www.pgpool.net/docs/pgpool-II-4.1.0/en/html/example-watchdog.html</p> <h4 id="_2-1-1-installing-pgpool-ii"><a href="#_2-1-1-installing-pgpool-ii" class="header-anchor">#</a> 2.1.1 Installing Pgpool-II</h4> <div class="language- extra-class"><pre class="language-text"><code>$ ./configure
$ make
$ make install
</code></pre></div><p>configure script collects your system information and use it for the compilation procedure. You can pass command line arguments to configure script to change the default behavior, such as the installation directory. Pgpool-II will be installed to <strong>/usr/local(if installed from rpm default path: /etc/pgpool-II/)</strong> directory by default.</p> <p>make command compiles the source code, and make install will install the executables. You must have write permission on the installation directory.</p> <h4 id="_2-1-2-configuration"><a href="#_2-1-2-configuration" class="header-anchor">#</a> 2.1.2 Configuration</h4> <div class="language- extra-class"><pre class="language-text"><code>//Configuration Files
$ cp /usr/local/etc/pgpool.conf.sample /usr/local/etc/pgpool.conf
    listen_addresses = '*'
    port = 9999

//Configuring PCP Commands
$ /usr/local/bin/pg_md5 postgres
    e8a48653851e28c69d0506508fb27fc5
$ cp /usr/local/etc/pcp.conf.sample /usr/local/etc/pcp.conf
    postgres:e8a48653851e28c69d0506508fb27fc5
    

//Preparing Database Nodes
$ vim /etc/pgpool-II/pgpool.conf
    pcp_port = 9898
    backend_hostname0 = 'localhost'
    backend_port0 = 5432
    backend_weight0 = 1
    backend_hostname1 = 'localhost'
    backend_port1 = 5433
    backend_weight1 = 1
    backend_hostname2 = 'localhost'
    backend_port2 = 5434
    backend_weight2 = 1

</code></pre></div><h4 id="_2-1-3-starting-stopping-pgpool-ii"><a href="#_2-1-3-starting-stopping-pgpool-ii" class="header-anchor">#</a> 2.1.3 Starting/Stopping Pgpool-II</h4> <div class="language- extra-class"><pre class="language-text"><code>$ pgpool
The above command, however, prints no log messages because Pgpool-II detaches the terminal. If you want to show Pgpool-II log messages, you pass -n option to pgpool command so Pgpool-II is executed as non-daemon process, and the terminal will not be detached.
$ pgpool -n &amp;
The log messages are printed on the terminal, so it is recommended to use the following options.
$ pgpool -n -d &gt; /tmp/pgpool.log 2&gt;&amp;1 &amp;
to rotate log files:
$ pgpool -n 2&gt;&amp;1 | /usr/local/apache2/bin/rotatelogs \
     -l -f /var/log/pgpool/pgpool.log.%A 86400 &amp;
To delete old log files before rotation, you could use cron:
55 23 * * * /usr/bin/find /var/log/pgpool -type f -mtime +5 -exec /bin/rm -f '{}' \;
Please note that rotatelogs may exist as /usr/sbin/rotatelogs2 in some distributions. -f option generates a log file as soon as rotatelogs starts and is available in apache2 2.2.9 or greater. Also cronolog can be used.
$ pgpool -n 2&gt;&amp;1 | /usr/sbin/cronolog \
     --hardlink=/var/log/pgsql/pgpool.log \
     '/var/log/pgsql/%Y-%m-%d-pgpool.log' &amp;


$ pgpool stop
If any client is still connected, Pgpool-II waits for it to disconnect, and then terminates itself. Run the following command instead if you want to shutdown Pgpool-II forcibly.
$ pgpool -m fast stop

</code></pre></div><h4 id="_2-1-4-configuring-replication"><a href="#_2-1-4-configuring-replication" class="header-anchor">#</a> 2.1.4 Configuring Replication</h4> <p>we'll use three database nodes,</p> <div class="language- extra-class"><pre class="language-text"><code>$ vim /usr/local/etc/pgpool.conf
//When replication_mode is on, Pgpool-II will send a copy of a received query to all the database nodes.
replication_mode = true
//when load_balance_mode is set to true, Pgpool-II will distribute SELECT queries among the database nodes.
load_balance_mode = true

//restart pgpool

//create a database to be replicated,
//Use the createdb commands through Pgpool-II, and the database will be created on all the nodes.
$ createdb -p 9999 bench_replication
//initializes the database with pre-defined tables and data
$ pgbench -i -p 9999 bench_replication

//If, on all the nodes, the tables and data are created, replication is working correctly.
$ for port in 5432 5433 5434; do
     &gt;     echo $port
     &gt;     for table_name in pgbench_branches pgbench_tellers pgbench_accounts pgbench_history; do
     &gt;         echo $table_name
     &gt;         psql -c &quot;SELECT count(*) FROM $table_name&quot; -p $port bench_replication
     &gt;     done
     &gt; done
</code></pre></div><h4 id="_2-1-5-watchdog-configuration-example"><a href="#_2-1-5-watchdog-configuration-example" class="header-anchor">#</a> 2.1.5 Watchdog Configuration Example</h4> <p>What you need is 2 Linux boxes on which Pgpool-II is installed and a PostgreSQL on the same machine or in the other one. It is enough that 1 node for backend exists. You can use watchdog with Pgpool-II in any mode: replication mode, master/slave mode and raw mode.
This example uses use &quot;osspc16&quot; as an Active node and &quot;osspc20&quot; as a Standby node. &quot;Someserver&quot; means one of them.</p> <p><strong>Common Config for all Pgpool-II</strong></p> <div class="language- extra-class"><pre class="language-text"><code>$ vim /usr/local/etc/pgpool.conf

//Enabling watchdog
use_watchdog = on

//Configure Up stream servers
trusted_servers = ''
# trusted server list which are used
# to confirm network connection
# (hostA,hostB,hostC,...)
      
//Watchdog Communication
wd_port = 9000

//Specify the IP address to be used as a virtual IP address in the delegate_IP
delegate_IP = '133.137.177.143'
</code></pre></div><p><strong>Individual Configurations for each Pgpool-II</strong></p> <div class="language- extra-class"><pre class="language-text"><code>//FOR Active (osspc16) Server configurations
other_pgpool_hostname0 = 'osspc20'
# Host name or IP address to connect to for other pgpool 0
other_pgpool_port0 = 9999
# Port number for other pgpool 0
other_wd_port0 = 9000
# Port number for other watchdog 0

//FOR Standby (osspc20) Server configurations
other_pgpool_hostname0 = 'osspc16'
# Host name or IP address to connect to for other pgpool 0
other_pgpool_port0 = 9999
# Port number for other pgpool 0
other_wd_port0 = 9000
# Port number for other watchdog 0

</code></pre></div><p><strong>First start the Pgpool-II on Active server.</strong></p> <div class="language- extra-class"><pre class="language-text"><code>[user@osspc16]$ su -
[root@osspc16]# {installed_dir}/bin/pgpool -n -f {installed_dir}/etc/pgpool.conf &gt; pgpool.log 2&gt;&amp;1

Log messages will show that Pgpool-II has the virtual IP address and starts watchdog process:
    LOG:  I am announcing my self as master/coordinator watchdog node
     LOG:  I am the cluster leader node
     DETAIL:  our declare coordinator message is accepted by all nodes
     LOG:  I am the cluster leader node. Starting escalation process
     LOG:  escalation process started with PID:59449
     LOG:  watchdog process is initialized
      LOG:  watchdog: escalation started
      LOG:  I am the master watchdog node
     DETAIL:  using the local backend node status

</code></pre></div><p><strong>Starting pgpool in Standby server (osspc20)</strong></p> <div class="language- extra-class"><pre class="language-text"><code>[user@osspc20]$ su -
[root@osspc20]# {installed_dir}/bin/pgpool -n -f {installed_dir}/etc/pgpool.conf &gt; pgpool.log 2&gt;&amp;1

Log messages will show that Pgpool-II has joind the watchdog cluster as standby watchdog.
    LOG:  watchdog cluster configured with 1 remote nodes
     LOG:  watchdog remote node:0 on Linux_osspc16_9000:9000
     LOG:  interface monitoring is disabled in watchdog
     LOG:  IPC socket path: &quot;/tmp/.s.PGPOOLWD_CMD.9000&quot;
     LOG:  watchdog node state changed from [DEAD] to [LOADING]
     LOG:  new outbound connection to Linux_osspc16_9000:9000
     LOG:  watchdog node state changed from [LOADING] to [INITIALIZING]
     LOG:  watchdog node state changed from [INITIALIZING] to [STANDBY]
           LOG:  successfully joined the watchdog cluster as standby node
      DETAIL:  our join coordinator request is accepted by cluster leader node &quot;Linux_osspc16_9000&quot;
      LOG:  watchdog process is initialized
</code></pre></div><p><strong>Try it out</strong></p> <div class="language- extra-class"><pre class="language-text"><code>//Confirm to ping to the virtual IP address.
[user@someserver]$ ping 133.137.177.142

//Confirm if the Active server which started at first has the virtual IP address.
[root@osspc16]# ifconfig

//Confirm if the Standby server which started not at first doesn't have the virtual IP address.
[root@osspc20]# ifconfig

//Try to connect PostgreSQL by &quot;psql -h delegate_IP -p port&quot;.
[user@someserver]$ psql -h 133.137.177.142 -p 9999 -l

</code></pre></div><p><strong>Switching virtual IP</strong></p> <div class="language- extra-class"><pre class="language-text"><code>//Confirm how the Standby server works when the Active server can't provide its service. Stop Pgpool-II on the Active server.
[root@osspc16]# {installed_dir}/bin/pgpool stop
Then, the Standby server starts to use the virtual IP address

</code></pre></div><p><strong>More: Lifecheck</strong></p> <div class="language- extra-class"><pre class="language-text"><code>There are the parameters about watchdog's monitoring. Specify the interval to check wd_interval and the type of lifecheck wd_lifecheck_method. The hearbeat method specify the time to detect a fault wd_heartbeat_deadtime, the port number to receive wd_heartbeat_port, the interval to send wd_heartbeat_keepalive, the IP address or hostname of destination heartbeat_destination&lt;emphasis&gt;0&lt;/emphasis&gt; and finally the destination port number heartbeat_destination_port&lt;emphasis&gt;0&lt;/emphasis&gt;.

wd_lifecheck_method = 'heartbeat'
# Method of watchdog lifecheck ('heartbeat' or 'query' or 'external')
# (change requires restart)
wd_interval = 10
# lifecheck interval (sec) &gt; 0
wd_heartbeat_port = 9694
# Port number for receiving heartbeat signal
# (change requires restart)
wd_heartbeat_keepalive = 2
# Interval time of sending heartbeat signal (sec)
# (change requires restart)
wd_heartbeat_deadtime = 30
# Deadtime interval for heartbeat signal (sec)
# (change requires restart)
heartbeat_destination0 = 'host0_ip1'
# Host name or IP address of destination 0
# for sending heartbeat signal.
# (change requires restart)
heartbeat_destination_port0 = 9694
# Port number of destination 0 for sending
# heartbeat signal. Usually this is the
# same as wd_heartbeat_port.
# (change requires restart)

</code></pre></div><p><strong>More: Switching virtual IP address</strong></p> <div class="language- extra-class"><pre class="language-text"><code>There are the parameters for switching the virtual IP address. Specify switching commands if_up_cmd, if_down_cmd, the path to them if_cmd_path, the command executed after switching to send ARP request arping_cmd and the path to it arping_path.

if_cmd_path = '/sbin'
# path to the directory where if_up/down_cmd exists
if_up_cmd = 'ip addr add $_IP_$/24 dev eth0 label eth0:0'
# startup delegate IP command
if_down_cmd = 'ip addr del $_IP_$/24 dev eth0'
# shutdown delegate IP command

arping_path = '/usr/sbin'           # arping command path

arping_cmd = 'arping -U $_IP_$ -w 1'
</code></pre></div><h3 id="_2-2-pgpool-ii-watchdog-setup-streaming-replication-mode"><a href="#_2-2-pgpool-ii-watchdog-setup-streaming-replication-mode" class="header-anchor">#</a> 2.2 Pgpool-II+ Watchdog Setup (Streaming replication mode)</h3> <ul><li>Method 1:
built in sample:
https://www.pgpool.net/docs/pgpool-II-4.1.0/en/html/tutorial.html</li></ul> <div class="language- extra-class"><pre class="language-text"><code>pgpool_setup

</code></pre></div><ul><li>Method 2:
In this example, we use 3 Pgpool-II servers to manage PostgreSQL servers to create a robust cluster system and avoid the single point of failure or split brain.</li></ul> <p><img src="/docs/docs_image/software/postgresql/pgpool-ii+watchdog_cluster_example.gif" alt=""></p> <p><strong>REQUIREMENT:</strong>
We assume that all the Pgpool-II servers and the PostgreSQL servers are in the same subnet.
We use 3 servers with CentOS 7.4. Let these servers be server1, server2, server3. We install PostgreSQL and Pgpool-II on each server.</p> <h4 id="_2-2-1-stepup-postgresql-server-data-nodes"><a href="#_2-2-1-stepup-postgresql-server-data-nodes" class="header-anchor">#</a> 2.2.1 Stepup postgresql server (data nodes)</h4> <h5 id="_2-2-1-1-install-postgresql-by-using-postgresql-yum-repository"><a href="#_2-2-1-1-install-postgresql-by-using-postgresql-yum-repository" class="header-anchor">#</a> 2.2.1.1 Install PostgreSQL by using PostgreSQL YUM repository.</h5> <div class="language- extra-class"><pre class="language-text"><code># yum install https://download.postgresql.org/pub/repos/yum/11/redhat/rhel-7-x86_64/pgdg-centos11-11-2.noarch.rpm
# yum install postgresql11 postgresql11-libs postgresql11-devel postgresql11-server

mkdir -p /lyhistory/workspace/postgres
chown -R postgres:postgres /lyhistory/workspace/postgres
chmod 750 /lyhistory/workspace/postgres

vi /lib/systemd/system/postgresql-12.service
	Environment=PGDATA=/lyhistory/workspace/postgres/data
(default: /var/lib/pgsql/12/data/)

cd /lyhistory/workspace/postgres
/usr/pgsql-12/bin/postgresql-12-setup initdb

systemctl enable postgresql-12

vi /lyhistory/workspace/postgres/data/pg_hba.conf 
# TYPE  DATABASE        USER            ADDRESS                 METHOD

# &quot;local&quot; is for Unix domain socket connections only
local   all             all                                     peer
# IPv4 local connections:
host    all             all             127.0.0.1/32            ident
# IPv6 local connections:
host    all             all             ::1/128                 ident
# Allow replication connections from localhost, by a user with the
# replication privilege.
local   replication     all                                     peer
host    replication     all             127.0.0.1/32            ident
host    replication     all             ::1/128                 ident
host    all             all             172.16.0.0/16           md5
host    all             all             10.36.100.0/24          md5
host    all             all             192.168.0.0/16          md5

vi data/postgresql.conf 
	listen_addresses = '*' 
	
systemctl start postgresql-12
vi data/log/postgresql-Fri.log 

su - postgres 
</code></pre></div><h5 id="_2-2-1-2-set-up-postgresql-streaming-replication-on-the-primary-server"><a href="#_2-2-1-2-set-up-postgresql-streaming-replication-on-the-primary-server" class="header-anchor">#</a> 2.2.1.2 Set up PostgreSQL streaming replication on the primary server.</h5> <div class="language- extra-class"><pre class="language-text"><code>//First, we create the directory /var/lib/pgsql/archivedir to store WAL segments on all servers. In this example, only Primary node archives WAL locally.
[all servers]# su - postgres
[all servers]$ mkdir /var/lib/pgsql/archivedir

//Then we edit the configuration file $PGDATA/postgresql.conf on ~~server1 (primary)~~ all servers as follows. Enable wal_log_hints to use pg_rewind. Since the Primary may become a Standby later, we set hot_standby = on.

listen_addresses = '*'
archive_mode = on
archive_command = 'cp &quot;%p&quot; &quot;/var/lib/pgsql/archivedir/%f&quot;'
max_wal_senders = 10
max_replication_slots = 10
wal_level = replica
hot_standby = on
wal_log_hints = on

</code></pre></div><p>We use the online recovery functionality of Pgpool-II to setup standby server after the primary server is started.</p> <h5 id="_2-2-1-4-create-users"><a href="#_2-2-1-4-create-users" class="header-anchor">#</a> 2.2.1.4 create users</h5> <p>Because of the security reasons, we create a user repl solely used for replication purpose, and a user pgpool for streaming replication delay check and health check of Pgpool-II.</p> <div class="language- extra-class"><pre class="language-text"><code>[server1]# psql -U postgres -p 5432
postgres=# SET password_encryption = 'scram-sha-256';
postgres=# CREATE ROLE pgpool WITH LOGIN;
postgres=# CREATE ROLE repl WITH REPLICATION LOGIN;
postgres=# \password pgpool
postgres=# \password repl
postgres=# \password postgres

//If you want to show &quot;replication_state&quot; and &quot;replication_sync_state&quot; column in SHOW POOL NODES command result, role pgpool needs to be PostgreSQL super user or or in pg_monitor group (Pgpool-II 4.1 or later). Grant pg_monitor to pgpool:
GRANT pg_monitor TO pgpool;
</code></pre></div><h5 id="_2-2-1-5-enable-scram-sha-256-authentication-method"><a href="#_2-2-1-5-enable-scram-sha-256-authentication-method" class="header-anchor">#</a> 2.2.1.5 enable scram-sha-256 authentication method</h5> <p>Assuming that all the Pgpool-II servers and the PostgreSQL servers are in the same subnet and edit pg_hba.conf to enable scram-sha-256 authentication method.</p> <div class="language- extra-class"><pre class="language-text"><code>vi /lyhistory/workspace/postgres/data/pg_hba.conf 
host    all             all             samenet                 scram-sha-256
     host    replication     all             samenet                 scram-sha-256
</code></pre></div><h5 id="_2-2-1-6-passwordless-ssh"><a href="#_2-2-1-6-passwordless-ssh" class="header-anchor">#</a> 2.2.1.6 passwordless SSH</h5> <p>To use the automated failover and online recovery of Pgpool-II, the settings that allow passwordless SSH to all backend servers between Pgpool-II execution user (default root user) and postgres user and between postgres user and postgres user are necessary. Execute the following command on all servers to set up passwordless SSH. The generated key file name is id_rsa_pgpool.</p> <div class="language- extra-class"><pre class="language-text"><code>[all servers]# cd ~/.ssh
[all servers]# ssh-keygen -t rsa -f id_rsa_pgpool
[all servers]# ssh-copy-id -i id_rsa_pgpool.pub postgres@server1
[all servers]# ssh-copy-id -i id_rsa_pgpool.pub postgres@server2
[all servers]# ssh-copy-id -i id_rsa_pgpool.pub postgres@server3

[all servers]# su - postgres
[all servers]$ cd ~/.ssh
[all servers]$ ssh-keygen -t rsa -f id_rsa_pgpool
[all servers]$ ssh-copy-id -i id_rsa_pgpool.pub postgres@server1
[all servers]$ ssh-copy-id -i id_rsa_pgpool.pub postgres@server2
[all servers]$ ssh-copy-id -i id_rsa_pgpool.pub postgres@server3

test:
ssh postgres@serverX -i ~/.ssh/id_rsa_pgpool
</code></pre></div><h5 id="_2-2-1-7-allow-repl-user-without-specifying-password-for-streaming-replication-and-online-recovery"><a href="#_2-2-1-7-allow-repl-user-without-specifying-password-for-streaming-replication-and-online-recovery" class="header-anchor">#</a> 2.2.1.7 allow repl user without specifying password for streaming replication and online recovery</h5> <div class="language- extra-class"><pre class="language-text"><code>[all servers]# su - postgres
[all servers]$ vi /var/lib/pgsql/.pgpass
server1:5432:replication:repl:&lt;repl user password&gt;
server2:5432:replication:repl:&lt;repl user passowrd&gt;
server3:5432:replication:repl:&lt;repl user passowrd&gt;
server1:5432:postgres:postgres:&lt;postgres user passowrd&gt;
server2:5432:postgres:postgres:&lt;postgres user passowrd&gt;
server3:5432:postgres:postgres:&lt;postgres user passowrd&gt;
[all servers]$ chmod 600  /var/lib/pgsql/.pgpass
    
</code></pre></div><h5 id="_2-2-1-8-firewall-for-postgres"><a href="#_2-2-1-8-firewall-for-postgres" class="header-anchor">#</a> 2.2.1.8 firewall for postgres</h5> <div class="language- extra-class"><pre class="language-text"><code>[all servers]# firewall-cmd --permanent --zone=public --add-service=postgresql
[all servers]# firewall-cmd --reload
</code></pre></div><h5 id="_2-2-1-9-summary"><a href="#_2-2-1-9-summary" class="header-anchor">#</a> 2.2.1.9 Summary</h5> <table><thead><tr><th><strong>Item</strong></th> <th><strong>Value</strong></th> <th><strong>Detail</strong></th></tr></thead> <tbody><tr><td>PostgreSQL  Version</td> <td>12.7</td> <td>-</td></tr> <tr><td>port</td> <td>5432</td> <td>-</td></tr> <tr><td>$PGDATA</td> <td>/lyhistory/workspace/postgres/data</td> <td>-</td></tr> <tr><td>Archive  mode</td> <td>on</td> <td>/var/lib/pgsql/archivedir</td></tr> <tr><td>Replication  Slots</td> <td>Enable ?</td> <td>-</td></tr> <tr><td>Start  automatically</td> <td>Disable</td> <td>-</td></tr></tbody></table> <h4 id="_2-2-2-setup-pgpool-ii-watchdog"><a href="#_2-2-2-setup-pgpool-ii-watchdog" class="header-anchor">#</a> 2.2.2 Setup Pgpool-II+Watchdog</h4> <h5 id="_2-2-2-1-install-pgpool-ii"><a href="#_2-2-2-1-install-pgpool-ii" class="header-anchor">#</a> 2.2.2.1 Install Pgpool-II</h5> <div class="language- extra-class"><pre class="language-text"><code># yum install http://www.pgpool.net/yum/rpms/4.1/redhat/rhel-7-x86_64/pgpool-II-release-4.1-1.noarch.rpm
# yum install pgpool-II-pg11-*
</code></pre></div><h5 id="_2-2-2-2-pgpool-ii-configuration-common-settings"><a href="#_2-2-2-2-pgpool-ii-configuration-common-settings" class="header-anchor">#</a> 2.2.2.2 Pgpool-II Configuration - Common Settings</h5> <div class="language- extra-class"><pre class="language-text"><code>$ cp -p /etc/pgpool-II/pgpool.conf.sample-stream /etc/pgpool-II/pgpool.conf

listen_addresses = '*'
#Specify replication delay check user and password
sr_check_user = 'pgpool'
sr_check_password = ''

#Enable health check so that Pgpool-II performs failover
health_check_period = 5
# Health check period
# Disabled (0) by default
health_check_timeout = 30
# Health check timeout
# 0 means no timeout
health_check_user = 'pgpool'
health_check_password = ''

health_check_max_retries = 3

#Specify the PostgreSQL backend informations
# - Backend Connection Settings -

backend_hostname0 = 'server1'
# Host name or IP address to connect to for backend 0
backend_port0 = 5432
# Port number for backend 0
backend_weight0 = 1
# Weight for backend 0 (only in load balancing mode)
backend_data_directory0 = '/var/lib/pgsql/11/data'
# Data directory for backend 0
backend_flag0 = 'ALLOW_TO_FAILOVER'
# Controls various backend behavior
# ALLOW_TO_FAILOVER or DISALLOW_TO_FAILOVER
backend_hostname1 = 'server2'
backend_port1 = 5432
backend_weight1 = 1
backend_data_directory1 = '/var/lib/pgsql/11/data'
backend_flag1 = 'ALLOW_TO_FAILOVER'

backend_hostname2 = 'server3'
backend_port2 = 5432
backend_weight2 = 1
backend_data_directory2 = '/var/lib/pgsql/11/data'
backend_flag2 = 'ALLOW_TO_FAILOVER'

//To show &quot;replication_state&quot; and &quot;replication_sync_state&quot; column in SHOW POOL NODES command result, backend_application_name parameter is required
backend_application_name0 = 'server1'
...
backend_application_name1 = 'server2'
...
backend_application_name2 = 'server3'
</code></pre></div><h5 id="_2-2-2-3-pgpool-ii-configuration-failover-configuration"><a href="#_2-2-2-3-pgpool-ii-configuration-failover-configuration" class="header-anchor">#</a> 2.2.2.3 Pgpool-II Configuration - Failover configuration</h5> <div class="language- extra-class"><pre class="language-text"><code>failover_command = '/etc/pgpool-II/failover.sh %d %h %p %D %m %H %M %P %r %R %N %S'
follow_master_command = '/etc/pgpool-II/follow_master.sh %d %h %p %D %m %M %H %P %r %R'


$ cp /etc/pgpool-II/failover.sh.sample /etc/pgpool-II/failover.sh
$ vi /etc/pgpool-II/follow_master.sh.sample  /etc/pgpool-II/follow_master.sh
$ chmod +x /etc/pgpool-II/{failover.sh,follow_master.sh}
</code></pre></div><p>Note: modify path in the scripts if needed: PGHOME=/usr/pgsql-12</p> <h5 id="_2-2-2-4-pgpool-ii-configuration-online-recovery-configurations"><a href="#_2-2-2-4-pgpool-ii-configuration-online-recovery-configurations" class="header-anchor">#</a> 2.2.2.4 Pgpool-II Configuration - Online Recovery Configurations</h5> <div class="language- extra-class"><pre class="language-text"><code>$vim /etc/pgpool-II/pgpool.conf

recovery_user = 'postgres'
# Online recovery user
recovery_password = ''
# Online recovery password

recovery_1st_stage_command = 'recovery_1st_stage'

[server1]# su - postgres
[server1]$ vi /var/lib/pgsql/11/data/recovery_1st_stage
[server1]$ vi /var/lib/pgsql/11/data/pgpool_remote_start
[server1]$ chmod +x /var/lib/pgsql/11/data/{recovery_1st_stage,pgpool_remote_start}

</code></pre></div><p>In order to use the online recovery functionality, the functions of pgpool_recovery, pgpool_remote_start, pgpool_switch_xlog are required, so we need install pgpool_recovery on template1 of PostgreSQL server server1.</p> <div class="language- extra-class"><pre class="language-text"><code>[server1]# su - postgres
[server1]$ psql template1 -c &quot;CREATE EXTENSION pgpool_recovery&quot;
</code></pre></div><h5 id="_2-2-2-5-pgpool-ii-configuration-client-authentication-configuration"><a href="#_2-2-2-5-pgpool-ii-configuration-client-authentication-configuration" class="header-anchor">#</a> 2.2.2.5 Pgpool-II Configuration - Client Authentication Configuration</h5> <p>Because in the section Before Starting, we already set PostgreSQL authentication method to scram-sha-256, it is necessary to set a client authentication by Pgpool-II to connect to backend nodes</p> <div class="language- extra-class"><pre class="language-text"><code>vim /etc/pgpool-II/pool_hba.conf
enable_pool_hba = on
host    all         pgpool           0.0.0.0/0          scram-sha-256
host    all         postgres         0.0.0.0/0          scram-sha-256

//The default password file name for authentication is pool_passwd. To use scram-sha-256 authentication, the decryption key to decrypt the passwords is required. We create the .pgpoolkey file in root user's home directory.
[all servers]# echo 'some string' &gt; ~/.pgpoolkey 
[all servers]# chmod 600 ~/.pgpoolkey

//Execute command pg_enc -m -k /path/to/.pgpoolkey -u username -p to regist user name and AES encrypted password in file pool_passwd.
[all servers]# pg_enc -m -k /root/.pgpoolkey -u pgpool -p
db password: [pgpool user's password]
[all servers]# pg_enc -m -k /root/.pgpoolkey -u postgres -p
db password: [postgres user's passowrd]

# cat /etc/pgpool-II/pool_passwd 
pgpool:AESheq2ZMZjynddMWk5sKP/Rw==
postgres:AESHs/pWL5rtXy2IwuzroHfqg==
</code></pre></div><h5 id="_2-2-2-6-pgpool-ii-configuration-watchdog-configuration"><a href="#_2-2-2-6-pgpool-ii-configuration-watchdog-configuration" class="header-anchor">#</a> 2.2.2.6 Pgpool-II Configuration - Watchdog Configuration</h5> <div class="language- extra-class"><pre class="language-text"><code>//Enable watchdog functionality on server1, server2, server3.
   use_watchdog = on
//Specify virtual IP address that accepts connections from clients on server1, server2, server3
   delegate_IP = '192.168.137.150'
//To bring up/down the virtual IP and send the ARP requests, we set if_up_cmd, if_down_cmd and arping_cmd. The network interface used in this example is &quot;enp0s8&quot;. Since root privilege is required to execute if_up/down_cmd or arping_cmd command, use setuid on these command or allow Pgpool-II startup user, postgres user (Pgpool-II 4.1 or later) to run sudo command without a password. If installed from RPM, the postgres user has been configured to run ip/arping via sudo without a password.
if_up_cmd = '/usr/bin/sudo /sbin/ip addr add $_IP_$/24 dev enp0s8 label enp0s8:0'
if_down_cmd = '/usr/bin/sudo /sbin/ip addr del $_IP_$/24 dev enp0s8'
arping_cmd = '/usr/bin/sudo /usr/sbin/arping -U $_IP_$ -w 1 -I enp0s8'

//Set if_cmd_path and arping_path according to the command path. If if_up/down_cmd or arping_cmd starts with &quot;/&quot;, these parameters will be ignored.
if_cmd_path = '/sbin'
arping_path = '/usr/sbin'
   
//Specify the hostname and port number of each Pgpool-II server.
server1

      wd_hostname = 'server1'
      wd_port = 9000
     
server2

      wd_hostname = 'server2'
      wd_port = 9000
     
server3

      wd_hostname = 'server3'
      wd_port = 9000

//Specify the hostname, Pgpool-II port number, and watchdog port number of monitored Pgpool-II servers on each Pgpool-II server.

server1

      # - Other pgpool Connection Settings -

      other_pgpool_hostname0 = 'server2'
      # Host name or IP address to connect to for other pgpool 0
      # (change requires restart)
      other_pgpool_port0 = 9999
      # Port number for other pgpool 0
      # (change requires restart)
      other_wd_port0 = 9000
      # Port number for other watchdog 0
      # (change requires restart)
      other_pgpool_hostname1 = 'server3'
      other_pgpool_port1 = 9999
      other_wd_port1 = 9000
     
server2

      # - Other pgpool Connection Settings -

      other_pgpool_hostname0 = 'server1'
      # Host name or IP address to connect to for other pgpool 0
      # (change requires restart)
      other_pgpool_port0 = 9999
      # Port number for other pgpool 0
      # (change requires restart)
      other_wd_port0 = 9000
      # Port number for other watchdog 0
      # (change requires restart)
      other_pgpool_hostname1 = 'server3'
      other_pgpool_port1 = 9999
      other_wd_port1 = 9000
     
server3

      # - Other pgpool Connection Settings -

      other_pgpool_hostname0 = 'server1'
      # Host name or IP address to connect to for other pgpool 0
      # (change requires restart)
      other_pgpool_port0 = 9999
      # Port number for other pgpool 0
      # (change requires restart)
      other_wd_port0 = 9000
      # Port number for other watchdog 0
      # (change requires restart)
      other_pgpool_hostname1 = 'server2'
      other_pgpool_port1 = 9999
      other_wd_port1 = 9000

//Specify the hostname and port number of destination for sending heartbeat signal on server1, server2, server3.
server1

      heartbeat_destination0 = 'server2'
      # Host name or IP address of destination 0
      # for sending heartbeat signal.
      # (change requires restart)
      heartbeat_destination_port0 = 9694
      # Port number of destination 0 for sending
      # heartbeat signal. Usually this is the
      # same as wd_heartbeat_port.
      # (change requires restart)
      heartbeat_device0 = ''
      # Name of NIC device (such like 'eth0')
      # used for sending/receiving heartbeat
      # signal to/from destination 0.
      # This works only when this is not empty
      # and pgpool has root privilege.
      # (change requires restart)

      heartbeat_destination1 = 'server3'
      heartbeat_destination_port1 = 9694
      heartbeat_device1 = ''
     
server2

      heartbeat_destination0 = 'server1'
      # Host name or IP address of destination 0
      # for sending heartbeat signal.
      # (change requires restart)
      heartbeat_destination_port0 = 9694
      # Port number of destination 0 for sending
      # heartbeat signal. Usually this is the
      # same as wd_heartbeat_port.
      # (change requires restart)
      heartbeat_device0 = ''
      # Name of NIC device (such like 'eth0')
      # used for sending/receiving heartbeat
      # signal to/from destination 0.
      # This works only when this is not empty
      # and pgpool has root privilege.
      # (change requires restart)

      heartbeat_destination1 = 'server3'
      heartbeat_destination_port1 = 9694
      heartbeat_device1 = ''
     
server3

      heartbeat_destination0 = 'server1'
      # Host name or IP address of destination 0
      # for sending heartbeat signal.
      # (change requires restart)
      heartbeat_destination_port0 = 9694
      # Port number of destination 0 for sending
      # heartbeat signal. Usually this is the
      # same as wd_heartbeat_port.
      # (change requires restart)
      heartbeat_device0 = ''
      # Name of NIC device (such like 'eth0')
      # used for sending/receiving heartbeat
      # signal to/from destination 0.
      # This works only when this is not empty
      # and pgpool has root privilege.
      # (change requires restart)

      heartbeat_destination1 = 'server2'
      heartbeat_destination_port1 = 9694
      heartbeat_device1 = ''
     
</code></pre></div><h5 id="_2-2-2-7-pgpool-ii-configuration-etc-sysconfig-pgpool-configuration"><a href="#_2-2-2-7-pgpool-ii-configuration-etc-sysconfig-pgpool-configuration" class="header-anchor">#</a> 2.2.2.7 Pgpool-II Configuration - /etc/sysconfig/pgpool Configuration</h5> <div class="language- extra-class"><pre class="language-text"><code>//If you want to ignore the pgpool_status file at startup of Pgpool-II, add &quot;- D&quot; to the start option OPTS to /etc/sysconfig/pgpool.
[all servers]# vi /etc/sysconfig/pgpool 
    ...
    OPTS=&quot; -D -n&quot;
</code></pre></div><h5 id="_2-2-2-8-pgpool-ii-configuration-logging"><a href="#_2-2-2-8-pgpool-ii-configuration-logging" class="header-anchor">#</a> 2.2.2.8 Pgpool-II Configuration - Logging</h5> <div class="language- extra-class"><pre class="language-text"><code>log_destination = 'syslog'
    # Where to log
    # Valid values are combinations of stderr,
    # and syslog. Default to stderr.

    syslog_facility = 'LOCAL1'
    # Syslog local facility. Default to LOCAL0
   
[all servers]# mkdir /var/log/pgpool-II
    [all servers]# touch /var/log/pgpool-II/pgpool.log
   
[all servers]# vi /etc/rsyslog.conf
    ...
    *.info;mail.none;authpriv.none;cron.none;LOCAL1.none    /var/log/messages
    LOCAL1.*                                                /var/log/pgpool-II/pgpool.log
[all servers]# vi /etc/logrotate.d/syslog
    ...
    /var/log/messages
    /var/log/pgpool-II/pgpool.log
    /var/log/secure
   
[all servers]# systemctl restart rsyslog
</code></pre></div><h5 id="_2-2-2-9-pgpool-ii-configuration-pcp-command-configuration"><a href="#_2-2-2-9-pgpool-ii-configuration-pcp-command-configuration" class="header-anchor">#</a> 2.2.2.9 Pgpool-II Configuration - PCP Command Configuration</h5> <div class="language- extra-class"><pre class="language-text"><code>//Since user authentication is required to use the PCP command, specify user name and md5 encrypted password in pcp.conf. Here we create the encrypted password for pgpool user, and add &quot;username:encrypted password&quot; in /etc/pgpool-II/pcp.conf.
[all servers]# echo 'pgpool:'`pg_md5 PCP passowrd` &gt;&gt; /etc/pgpool-II/pcp.conf
</code></pre></div><h5 id="_2-2-2-10-pgpool-ii-configuration-pcppass"><a href="#_2-2-2-10-pgpool-ii-configuration-pcppass" class="header-anchor">#</a> 2.2.2.10 Pgpool-II Configuration - .pcppass</h5> <div class="language- extra-class"><pre class="language-text"><code>//Since follow_master_command script has to execute PCP command without entering the password, we create .pcppass in the home directory of Pgpool-II startup user (root user). If doesn’t have root access, repeated same step under postgres user home directory (/var/lib/pgsql), make sure the permission is 600.

[all servers]# echo 'localhost:9898:pgpool:pgpool' &gt; ~/.pcppass
[all servers]# chmod 600 ~/.pcppass
</code></pre></div><h5 id="_2-2-2-11-firewall-for-pgpool-ii"><a href="#_2-2-2-11-firewall-for-pgpool-ii" class="header-anchor">#</a> 2.2.2.11 firewall for Pgpool-II</h5> <div class="language- extra-class"><pre class="language-text"><code>[all servers]# firewall-cmd --permanent --zone=public --add-port=9999/tcp --add-port=9898/tcp --add-port=9000/tcp  --add-port=9694/udp
[all servers]# firewall-cmd --reload
</code></pre></div><h5 id="_2-2-2-12-summary"><a href="#_2-2-2-12-summary" class="header-anchor">#</a> 2.2.2.12 Summary</h5> <table><thead><tr><th><strong>Item</strong></th> <th><strong>Value</strong></th> <th><strong>Detail</strong></th></tr></thead> <tbody><tr><td>Pgpool-II  Version</td> <td>4.1.1</td> <td>-</td></tr> <tr><td>port</td> <td>9999</td> <td>Pgpool-II  accepts connections</td></tr> <tr><td>9898</td> <td>PCP  process accepts connections</td> <td></td></tr> <tr><td>9000</td> <td>watchdog  accepts connections</td> <td></td></tr> <tr><td>9694</td> <td>UDP  port for receiving Watchdog's heartbeat signal</td> <td></td></tr> <tr><td>Config  file</td> <td>/etc/pgpool-II/pgpool.conf</td> <td>Pgpool-II  config file</td></tr> <tr><td>Pgpool-II  start user</td> <td>postgres  (Pgpool-II 4.1 or later)</td> <td>Pgpool-II  4.0 or before, the default startup user is root</td></tr> <tr><td>Running  mode</td> <td>streaming  replication mode</td> <td>-</td></tr> <tr><td>Watchdog</td> <td>on</td> <td>Life  check method: heartbeat</td></tr> <tr><td>Start  automatically</td> <td>Disable</td> <td>-</td></tr></tbody></table> <h4 id="_2-2-3-assign-permission-and-set-env-path"><a href="#_2-2-3-assign-permission-and-set-env-path" class="header-anchor">#</a> 2.2.3 Assign Permission and set env path</h4> <p>chown –R postgres:postgres /var/lib/pgsql/12，</p> <p>vim /var/lib/pgsql/.bash_profile
PATH=$PATH:/usr/pgsql-12/bin
export PATH</p> <h4 id="_2-2-4-starting-stopping-pgpool-ii"><a href="#_2-2-4-starting-stopping-pgpool-ii" class="header-anchor">#</a> 2.2.4 Starting/Stopping Pgpool-II</h4> <p>Before starting Pgpool-II, please start PostgreSQL servers first. Also, when stopping PostgreSQL, it is necessary to stop Pgpool-II first</p> <div class="language- extra-class"><pre class="language-text"><code>//let's start Pgpool-II on server1, server2, server3
 # systemctl start pgpool.service
</code></pre></div><h4 id="_2-2-5-set-up-postgresql-standby-server"><a href="#_2-2-5-set-up-postgresql-standby-server" class="header-anchor">#</a> 2.2.5 Set up PostgreSQL standby server</h4> <p>First, we should set up PostgreSQL standby server by using Pgpool-II online recovery functionality. Ensure that recovery_1st_stage and pgpool_remote_start scripts used by pcp_recovery_node command are in database cluster directory of PostgreSQL primary server (server1).</p> <div class="language- extra-class"><pre class="language-text"><code># pcp_recovery_node -h 192.168.137.150 -p 9898 -U pgpool -n 1
    Password: 
    pcp_recovery_node -- Command Successful

    # pcp_recovery_node -h 192.168.137.150 -p 9898 -U pgpool -n 2
    Password: 
    pcp_recovery_node -- Command Successful

# pg_ctl -D /lyhistory/workspace/postgres/data status

//After executing pcp_recovery_node command, vertify that server2 and server3 are started as PostgreSQL standby server.
# psql -h 192.168.137.150 -p 9999 -U pgpool postgres -c &quot;show pool_nodes&quot;
    Password for user pgpool
    node_id | hostname | port | status | lb_weight |  role   | select_cnt | load_balance_node | replication_delay | replication_state | replication_sync_state | last_status_change  
    ---------+----------+------+--------+-----------+---------+------------+-------------------+-------------------+-------------------+------------------------+---------------------
    0       | server1  | 5432 | up     | 0.333333  | primary | 0          | false             | 0                 |                   |                        | 2019-08-06 11:13:17
    1       | server2  | 5432 | up     | 0.333333  | standby | 0          | true              | 0                 | streaming         | async                  | 2019-08-06 11:13:25
    2       | server3  | 5432 | up     | 0.333333  | standby | 0          | false             | 0                 | streaming         | async                  | 2019-08-06 11:14:20
    (3 rows)
</code></pre></div><h4 id="_2-2-6-switching-active-standby-watchdog"><a href="#_2-2-6-switching-active-standby-watchdog" class="header-anchor">#</a> 2.2.6 Switching active/standby watchdog</h4> <div class="language- extra-class"><pre class="language-text"><code>//Confirm the watchdog status by using pcp_watchdog_info. The Pgpool-II server which is started first run as MASTER.
  # pcp_watchdog_info -h 192.168.137.150 -p 9898 -U pgpool
    Password: 
    3 YES server1:9999 Linux server1 server1

    server1:9999 Linux server1 server1 9999 9000 4 MASTER  #The Pgpool-II server started first becames &quot;MASTER&quot;.
    server2:9999 Linux server2 server2 9999 9000 7 STANDBY #run as standby
    server3:9999 Linux server3 server3 9999 9000 7 STANDBY #run as standby

//Stop active server server1, then server2 or server3 will be promoted to active server. To stop server1, we can stop Pgpool-II service or shutdown the whole system. Here, we stop Pgpool-II service.
[server1]# systemctl stop pgpool.service

    # pcp_watchdog_info -p 9898 -h 192.168.137.150 -U pgpool
    Password: 
    3 YES server2:9999 Linux server2 server2

    server2:9999 Linux server2 server2 9999 9000 4 MASTER     #server2 is promoted to MASTER
    server1:9999 Linux server1 server1 9999 9000 10 SHUTDOWN  #server1 is stopped
    server3:9999 Linux server3 server3 9999 9000 7 STANDBY    #server3 runs as STANDBY
//Start Pgpool-II (server1) which we have stopped again, and vertify that server1 runs as a standby.
[server1]# systemctl start pgpool.service

    [server1]# pcp_watchdog_info -p 9898 -h 192.168.137.150 -U pgpool
    Password: 
    3 YES server2:9999 Linux server2 server2

    server2:9999 Linux server2 server2 9999 9000 4 MASTER
    server1:9999 Linux server1 server1 9999 9000 7 STANDBY
    server3:9999 Linux server3 server3 9999 9000 7 STANDBY

</code></pre></div><h4 id="_2-2-7-test-failover"><a href="#_2-2-7-test-failover" class="header-anchor">#</a> 2.2.7 test Failover</h4> <p>https://www.pgpool.net/docs/pgpool-II-4.1.0/en/html/tutorial-testing-failover.html</p> <div class="language- extra-class"><pre class="language-text"><code>//First, use psql to connect to PostgreSQL via virtual IP, and verify the backend informations.
# psql -h 192.168.137.150 -p 9999 -U pgpool postgres -c &quot;show pool_nodes&quot;
    Password for user pgpool:
    node_id | hostname | port | status | lb_weight |  role   | select_cnt | load_balance_node | replication_delay | replication_state | replication_sync_state | last_status_change  
    ---------+----------+------+--------+-----------+---------+------------+-------------------+-------------------+-------------------+------------------------+---------------------
    0       | server1  | 5432 | up     | 0.333333  | primary | 0          | false             | 0                 |                   |                        | 2019-08-06 11:13:17
    1       | server2  | 5432 | up     | 0.333333  | standby | 0          | true              | 0                 | streaming         | async                  | 2019-08-06 11:13:25
    2       | server3  | 5432 | up     | 0.333333  | standby | 0          | false             | 0                 | streaming         | async                  | 2019-08-06 11:14:20
    (3 rows)

//Next, stop primary PostgreSQL server server1, and verify automatic failover.

    [server1]$ pg_ctl -D /var/lib/pgsql/11/data -m immediate stop
//After stopping PostgreSQL on server1, failover occurs and PostgreSQL on server2 becomes new primary DB.

    # psql -h 192.168.137.150 -p 9999 -U pgpool postgres -c &quot;show pool_nodes&quot;
    Password for user pgpool:
    node_id | hostname | port | status | lb_weight |  role   | select_cnt | load_balance_node | replication_delay | replication_state | replication_sync_state | last_status_change  
    ---------+----------+------+--------+-----------+---------+------------+-------------------+-------------------+-------------------+------------------------+---------------------
    0       | server1  | 5432 | down   | 0.333333  | standby | 0          | false             | 0                 |                   |                        | 2019-08-06 11:36:03
    1       | server2  | 5432 | up     | 0.333333  | primary | 0          | true              | 0                 |                   |                        | 2019-08-06 11:36:03
    2       | server3  | 5432 | up     | 0.333333  | standby | 0          | false             | 0                 | streaming         | async                  | 2019-08-06 11:36:15
    (3 rows)
//server3 is running as standby of new primary server2.

    [server3]# psql -h server3 -p 5432 -U pgpool postgres -c &quot;select pg_is_in_recovery()&quot;
    pg_is_in_recovery 
    -------------------
    t

    [server2]# psql -h server2 -p 5432 -U pgpool postgres -c &quot;select pg_is_in_recovery()&quot;
    pg_is_in_recovery 
    -------------------
    f

    [server2]# psql -h server2 -p 5432 -U pgpool postgres -c &quot;select * from pg_stat_replication&quot; -x
    -[ RECORD 1 ]----+------------------------------
    pid              | 11059
    usesysid         | 16392
    usename          | repl
    application_name | server3
    client_addr      | 192.168.137.103
    client_hostname  | 
    client_port      | 48694
    backend_start    | 2019-08-06 11:36:07.479161+09
    backend_xmin     | 
    state            | streaming
    sent_lsn         | 0/75000148
    write_lsn        | 0/75000148
    flush_lsn        | 0/75000148
    replay_lsn       | 0/75000148
    write_lag        | 
    flush_lag        | 
    replay_lag       | 
    sync_priority    | 0
    sync_state       | async
    reply_time       | 2019-08-06 11:42:59.823961+09
</code></pre></div><h4 id="_2-2-8-test-online-recovery"><a href="#_2-2-8-test-online-recovery" class="header-anchor">#</a> 2.2.8 test Online Recovery</h4> <p>https://www.pgpool.net/docs/pgpool-II-4.1.0/en/html/tutorial-testing-online-recovery.html</p> <div class="language- extra-class"><pre class="language-text"><code>//Here, we use Pgpool-II online recovery functionality to restore server1 (old primary server) as a standby. Before restoring the old primary server, please ensure that recovery_1st_stage and pgpool_remote_start scripts exist in database cluster directory of current primary server server2.
  # pcp_recovery_node -h 192.168.137.150 -p 9898 -U pgpool -n 0
    Password: 
    pcp_recovery_node -- Command Successful
//Then verify that server1 is started as a standby.

    # psql -h 192.168.137.150 -p 9999 -U pgpool postgres -c &quot;show pool_nodes&quot;
    Password for user pgpool:
    node_id | hostname | port | status | lb_weight |  role   | select_cnt | load_balance_node | replication_delay | replication_state | replication_sync_state | last_status_change  
    ---------+----------+------+--------+-----------+---------+------------+-------------------+-------------------+-------------------+------------------------+---------------------
    0       | server1  | 5432 | up     | 0.333333  | standby | 0          | false             | 0                 | streaming         | async                  | 2019-08-06 11:48:05
    1       | server2  | 5432 | up     | 0.333333  | primary | 0          | false             | 0                 |                   |                        | 2019-08-06 11:36:03
    2       | server3  | 5432 | up     | 0.333333  | standby | 0          | true              | 0                 | streaming         | async                  | 2019-08-06 11:36:15
    (3 rows)
</code></pre></div><h4 id="_2-2-9-test-replication"><a href="#_2-2-9-test-replication" class="header-anchor">#</a> 2.2.9 test replication</h4> <p>https://www.pgpool.net/docs/pgpool-II-4.1.0/en/html/tutorial-testing-replication.html
$ pgbench -i -p 11000 test</p> <h4 id="_2-2-10-test-loadbalance"><a href="#_2-2-10-test-loadbalance" class="header-anchor">#</a> 2.2.10 test loadbalance</h4> <p>https://www.pgpool.net/docs/pgpool-II-4.1.0/en/html/tutorial-testing-load-balance.html</p> <h4 id="_2-2-11-reset"><a href="#_2-2-11-reset" class="header-anchor">#</a> 2.2.11 reset</h4> <div class="language- extra-class"><pre class="language-text"><code>0. backup db
pgdumpall

1. Stop all the postgres 
su - postgres
pg_ctl -D /lyhistory/workspace/postgres/data -m immediate stop

2. Stop all the pgpool services
CHANGE TO ROOT USER:
systemctl stop pgpool.service

3. clean up replication servers
[replication servers only] rename or delete the postgres data directory (/lyhistory/workspace/postgres/data)

4. start primary postgres server and clean up replication slots on primary server
[primary server only] start postgres: pg_ctl -D /lyhistory/workspace/postgres/data -m immediate start
remove all the replication slots
su - postgres
psql
select * from pg_replication_slots;
 
select pg_drop_replication_slot('hostname') # replace the replication hostname

select * from pg_activity; (terminate active connection 查看是否有活跃的连接)
drop db;

5. init db on replication servers
[replication servers only] init db, and start postgres
# as root
/usr/pgsql-12/bin/postgresql-12-setup initdb

6. bring up replication postgres(can skip)
systemctl start postgres-12.service 
or
su - postgres
pg_ctl -D /lyhistory/workspace/postgres/data -m immediate start

实验发现，不管是使用systemctl还是pg_ctl启动，最终都会变成pg_ctl管理，原因是，下一步 pcp_recovery_node
都会调用pg_ctl启动replicaiton服务器上的postgres，所以这一步貌似是多余的

7. start pgpool
[all servers] start pgpool
systemctl start pgpool.service

recover nodes from 1 → 5
pcp_recovery_node -h 192.168.137.150 -p 9898 -U pgpool -n 1

8 import db:
psql# create database &quot;dbname&quot;
gzip -dc /tmp/testdb.sql.gz | psql -U postgres -d &quot;dbname&quot;

</code></pre></div><h2 id="manage-pgpool-ii"><a href="#manage-pgpool-ii" class="header-anchor">#</a> Manage PgPool-II</h2> <h3 id="pgpool-cluster-workflow-summary"><a href="#pgpool-cluster-workflow-summary" class="header-anchor">#</a> Pgpool cluster WorkFlow Summary</h3> <ul><li><p>Pgpool cluster (master standby)
pcp 免密访问 localhost:9898 /var/lib/pgsql/.pcppass</p> <div class="language- extra-class"><pre class="language-text"><code>pcp_watchdog_info -p 9898 -h &lt;Virtual IP&gt; -U pgpool
</code></pre></div></li> <li><p>Pgpool通过pcp将postgres服务加入到池子中</p> <div class="language- extra-class"><pre class="language-text"><code>pcp_recovery_node -h 192.168.137.150 -p 9898 -U pgpool -n &lt;node id&gt;
psql -h &lt;VirtualIP&gt; -p 9999 -U pgpool postgres -c &quot;show pool_nodes&quot;
</code></pre></div></li> <li><p>Postgres nodes(stream replication)
postgres standby replicate from master passwordless免密访问:
/var/lib/pgsql/.pgpass (content: hostname:port:database:username:password)</p> <div class="language- extra-class"><pre class="language-text"><code>pg_ctl -D /var/lib/pgsql/12/data -m immediate stop

psql -h server3 -p 5432 -U pgpool postgres -c &quot;select pg_is_in_recovery()&quot;
psql -h server2 -p 5432 -U pgpool postgres -c &quot;select * from pg_stat_replication&quot; -x
</code></pre></div></li></ul> <h2 id="troubleshooting"><a href="#troubleshooting" class="header-anchor">#</a> Troubleshooting</h2> <h3 id="pcp-recovery-node-error"><a href="#pcp-recovery-node-error" class="header-anchor">#</a> pcp_recovery_node error</h3> <h4 id="error-executing-recovery"><a href="#error-executing-recovery" class="header-anchor">#</a> ERROR: executing recovery</h4> <div class="language- extra-class"><pre class="language-text"><code>pcp_recovery_node 

ERROR: executing recovery, execution of command failed at &quot;1st stage&quot;
DETAIL: command:&quot;recovery_1st_stage&quot;

vi /lyhistory/workspace/postgres/data/log/postgresql-Mon.log

2022-06-27 12:00:21.267 +08 [9557] LOG:  database system is ready to accept connections
sh: /lyhistory/workspace/postgres/data/recovery_1st_stage: /bin/bash^M: bad interpreter: No such file or directory
2022-06-27 12:02:53.154 +08 [9825] ERROR:  pgpool_recovery failed
2022-06-27 12:02:53.154 +08 [9825] STATEMENT:  SELECT pgpool_recovery('recovery_1st_stage', 'vm_v02', '/lyhistory/workspace/postgres/data', '5432', 1, '5432')
sh: /lyhistory/workspace/postgres/data/recovery_1st_stage: /bin/bash^M: bad interpreter: No such file or directory


dos2unix recovery_1st_stage
</code></pre></div><h4 id="error-invalid-character"><a href="#error-invalid-character" class="header-anchor">#</a> ERROR: invalid character</h4> <p>hostname invalid，只能包含下划线小写字母和数字</p> <p>ERROR:  replication slot name &quot;vm_v02.novalocal&quot; contains invalid character
HINT:  Replication slot names may only contain lower case letters, numbers, and the underscore character.</p> <h4 id="stuck-in-printing-password"><a href="#stuck-in-printing-password" class="header-anchor">#</a> stuck in printing 'Password:'</h4> <p>不断打印 'Password:'</p> <p>调查：</p> <p>SELECT pgpool_recovery('recovery_1st_stage', 'vm_v02', '/lyhistory/workspace/postgres/data', '5432', 1, '5432')</p> <div class="language- extra-class"><pre class="language-text"><code>PRIMARY_NODE_PGDATA=&quot;$1&quot;
DEST_NODE_HOST=&quot;$2&quot; vm_v02
DEST_NODE_PGDATA=&quot;$3&quot; /lyhistory/workspace/postgres/data
PRIMARY_NODE_PORT=&quot;$4&quot; 5432
DEST_NODE_ID=&quot;$5&quot; 1
DEST_NODE_PORT=&quot;$6&quot; 5432

PRIMARY_NODE_HOST=$(hostname) vm_v01
PGHOME=/usr/pgsql-11
ARCHIVEDIR=/var/lib/pgsql/archivedir
REPLUSER=repl

..............................
## Execute pg_basebackup to recovery Standby node

ssh -T -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null postgres@$DEST_NODE_HOST -i ~/.ssh/id_rsa_pgpool &quot;
    set -o errexit
    rm -rf $DEST_NODE_PGDATA

    rm -rf $ARCHIVEDIR/*

    ${PGHOME}/bin/pg_basebackup -h $PRIMARY_NODE_HOST -U $REPLUSER -p $PRIMARY_NODE_PORT -D $DEST_NODE_PGDATA -X stream

    if [ ${PGVERSION} -ge 12 ]; then

        sed -i -e \&quot;\\\$ainclude_if_exists = '$(echo ${RECOVERYCONF} | sed -e 's/\//\\\//g')'\&quot; \

               -e \&quot;/^include_if_exists = '$(echo ${RECOVERYCONF} | sed -e 's/\//\\\//g')'/d\&quot; ${DEST_NODE_PGDATA}/postgresql.conf

    fi

    cat &gt; ${RECOVERYCONF} &lt;&lt; EOT

primary_conninfo = 'host=${PRIMARY_NODE_HOST} port=${PRIMARY_NODE_PORT} user=${REPLUSER} application_name=${DEST_NODE_HOST} passfile=''/var/lib/pgsql/.pgpass'''

recovery_target_timeline = 'latest'

restore_command = 'scp ${PRIMARY_NODE_HOST}:${ARCHIVEDIR}/%f %p'

primary_slot_name = '${DEST_NODE_HOST}'

EOT
    if [ ${PGVERSION} -ge 12 ]; then
            touch ${DEST_NODE_PGDATA}/standby.signal
    else

            echo \&quot;standby_mode = 'on'\&quot; &gt;&gt; ${RECOVERYCONF}

    fi

    sed -i \&quot;s/#*port = .*/port = ${DEST_NODE_PORT}/\&quot; ${DEST_NODE_PGDATA}/postgresql.conf

&quot;


if [ $? -ne 0 ]; then
    ${PGHOME}/bin/psql -p ${PRIMARY_NODE_PORT} &lt;&lt; EOQ

SELECT pg_drop_replication_slot('${DEST_NODE_HOST}');

EOQ
    logger -i -p local1.error recovery_1st_stage: end: pg_basebackup failed. online recovery failed

    exit 1

fi
</code></pre></div><p>定位到
${PGHOME}/bin/pg_basebackup -h $PRIMARY_NODE_HOST -U $REPLUSER -p $PRIMARY_NODE_PORT -D $DEST_NODE_PGDATA -X stream
按照日志中的参数在pcp_recovery_node n 1 即node 1（第二台机器）上手动执行：
su - postgres
/usr/pgsql-12/bin/pg_basebackup -h vm_v01.novalocal -U repl -p 5432 -D /lyhistory/workspace/postgres/data -X stream
发现要提供密码，而实际上我们配置了 /var/lib/pgsql/.pgpass,
原因就在于配置的.pgpass 的hostname不是vm_v01.novalocal，而是vm_v01</p> <h4 id="error-sed-no-input-files"><a href="#error-sed-no-input-files" class="header-anchor">#</a> ERROR: sed no input files</h4> <p>recovery_1st_stage脚本是从外部copy进来，可能是换行符的原因，其中的一些sed指令不识别参数
解决方法，使用/etc/pgpool-II/recovery_1st_stage.sample</p> <h4 id="error-executing-remote-start-failed-with-error-error-pgpool-remote-start-failed"><a href="#error-executing-remote-start-failed-with-error-error-pgpool-remote-start-failed" class="header-anchor">#</a> ERROR:  executing remote start failed with error: &quot;ERROR:  pgpool_remote_start failed</h4> <p>奇怪，再试一次就可以成功 just retry one more time</p> <h3 id="failover-failed"><a href="#failover-failed" class="header-anchor">#</a> Failover failed</h3> <p>vm1 master vm2&amp;vm3 是slave
杀掉vm1的postgres，vm2成为master，但是vm3也down掉（但是5432仍然在监听，systemctl status是dead状态）</p> <p>https://stackoverflow.com/questions/72259918/pgpool-failover</p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/docs/assets/js/app.f3b5d2d6.js" defer></script><script src="/docs/assets/js/2.d450803a.js" defer></script><script src="/docs/assets/js/211.4fca6eef.js" defer></script>
  </body>
</html>
