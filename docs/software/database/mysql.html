<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>计算机基础教程</title>
    <meta name="description" content="软件开发教程，白帽黑客入门教程，区块链入门教程，物联网，大数据">
    
    
    <link rel="preload" href="/docs/assets/css/0.styles.89d6372f.css" as="style"><link rel="preload" href="/docs/assets/js/app.b015bf24.js" as="script"><link rel="preload" href="/docs/assets/js/2.dc5756d7.js" as="script"><link rel="preload" href="/docs/assets/js/86.617cb2f5.js" as="script"><link rel="prefetch" href="/docs/assets/js/10.009358ac.js"><link rel="prefetch" href="/docs/assets/js/100.9585055b.js"><link rel="prefetch" href="/docs/assets/js/101.1c1bc510.js"><link rel="prefetch" href="/docs/assets/js/102.b8240a49.js"><link rel="prefetch" href="/docs/assets/js/103.4b36d126.js"><link rel="prefetch" href="/docs/assets/js/104.3a37e431.js"><link rel="prefetch" href="/docs/assets/js/105.d5d23d9f.js"><link rel="prefetch" href="/docs/assets/js/106.0f1f8bf0.js"><link rel="prefetch" href="/docs/assets/js/107.8c97de85.js"><link rel="prefetch" href="/docs/assets/js/108.9c1768b2.js"><link rel="prefetch" href="/docs/assets/js/109.11326621.js"><link rel="prefetch" href="/docs/assets/js/11.aedd1336.js"><link rel="prefetch" href="/docs/assets/js/110.65fe6c72.js"><link rel="prefetch" href="/docs/assets/js/111.7b2582ee.js"><link rel="prefetch" href="/docs/assets/js/112.73a0265f.js"><link rel="prefetch" href="/docs/assets/js/113.128b6917.js"><link rel="prefetch" href="/docs/assets/js/114.9c4e4fb6.js"><link rel="prefetch" href="/docs/assets/js/115.b61a5404.js"><link rel="prefetch" href="/docs/assets/js/116.b73acd2a.js"><link rel="prefetch" href="/docs/assets/js/117.de0fdf8c.js"><link rel="prefetch" href="/docs/assets/js/118.98a87af7.js"><link rel="prefetch" href="/docs/assets/js/119.8a2a68e3.js"><link rel="prefetch" href="/docs/assets/js/12.1acfc2a7.js"><link rel="prefetch" href="/docs/assets/js/120.0b793af4.js"><link rel="prefetch" href="/docs/assets/js/121.c1467d65.js"><link rel="prefetch" href="/docs/assets/js/122.c30b674b.js"><link rel="prefetch" href="/docs/assets/js/123.0fb3d28b.js"><link rel="prefetch" href="/docs/assets/js/124.87f55def.js"><link rel="prefetch" href="/docs/assets/js/125.5695c798.js"><link rel="prefetch" href="/docs/assets/js/126.eebc070a.js"><link rel="prefetch" href="/docs/assets/js/127.d122ce1b.js"><link rel="prefetch" href="/docs/assets/js/128.8411af45.js"><link rel="prefetch" href="/docs/assets/js/129.8ddcd9fb.js"><link rel="prefetch" href="/docs/assets/js/13.cb6bbe4a.js"><link rel="prefetch" href="/docs/assets/js/130.ff8444f6.js"><link rel="prefetch" href="/docs/assets/js/131.c3e7c7b5.js"><link rel="prefetch" href="/docs/assets/js/132.8ad4b670.js"><link rel="prefetch" href="/docs/assets/js/133.eb72cfd7.js"><link rel="prefetch" href="/docs/assets/js/134.a65d7a7e.js"><link rel="prefetch" href="/docs/assets/js/135.2e314eab.js"><link rel="prefetch" href="/docs/assets/js/136.6e93f12e.js"><link rel="prefetch" href="/docs/assets/js/137.b6dd1b5c.js"><link rel="prefetch" href="/docs/assets/js/138.00726996.js"><link rel="prefetch" href="/docs/assets/js/139.c48e0d89.js"><link rel="prefetch" href="/docs/assets/js/14.e95de8d7.js"><link rel="prefetch" href="/docs/assets/js/140.fb69fe10.js"><link rel="prefetch" href="/docs/assets/js/141.2e69969d.js"><link rel="prefetch" href="/docs/assets/js/142.e83b3e4d.js"><link rel="prefetch" href="/docs/assets/js/143.732981ff.js"><link rel="prefetch" href="/docs/assets/js/144.1ba969e8.js"><link rel="prefetch" href="/docs/assets/js/145.ea094c09.js"><link rel="prefetch" href="/docs/assets/js/146.3536e36d.js"><link rel="prefetch" href="/docs/assets/js/147.cbb48373.js"><link rel="prefetch" href="/docs/assets/js/148.50f40ae8.js"><link rel="prefetch" href="/docs/assets/js/149.90401971.js"><link rel="prefetch" href="/docs/assets/js/15.8ab2e168.js"><link rel="prefetch" href="/docs/assets/js/150.cf236173.js"><link rel="prefetch" href="/docs/assets/js/151.31e094c3.js"><link rel="prefetch" href="/docs/assets/js/152.a80761eb.js"><link rel="prefetch" href="/docs/assets/js/153.dba317ec.js"><link rel="prefetch" href="/docs/assets/js/154.28ef6e3c.js"><link rel="prefetch" href="/docs/assets/js/155.d55404a5.js"><link rel="prefetch" href="/docs/assets/js/156.ac5aa13d.js"><link rel="prefetch" href="/docs/assets/js/157.70af4df0.js"><link rel="prefetch" href="/docs/assets/js/158.cec2e687.js"><link rel="prefetch" href="/docs/assets/js/159.37210793.js"><link rel="prefetch" href="/docs/assets/js/16.8e3e454a.js"><link rel="prefetch" href="/docs/assets/js/160.2afc659e.js"><link rel="prefetch" href="/docs/assets/js/161.a5a36115.js"><link rel="prefetch" href="/docs/assets/js/162.e628a1c3.js"><link rel="prefetch" href="/docs/assets/js/163.7280ab68.js"><link rel="prefetch" href="/docs/assets/js/164.b045caad.js"><link rel="prefetch" href="/docs/assets/js/17.5603d183.js"><link rel="prefetch" href="/docs/assets/js/18.52d217c9.js"><link rel="prefetch" href="/docs/assets/js/19.cb7475da.js"><link rel="prefetch" href="/docs/assets/js/20.1501e782.js"><link rel="prefetch" href="/docs/assets/js/21.e09e4c61.js"><link rel="prefetch" href="/docs/assets/js/22.b16c67d9.js"><link rel="prefetch" href="/docs/assets/js/23.c2d14225.js"><link rel="prefetch" href="/docs/assets/js/24.909ce09b.js"><link rel="prefetch" href="/docs/assets/js/25.73971747.js"><link rel="prefetch" href="/docs/assets/js/26.74705119.js"><link rel="prefetch" href="/docs/assets/js/27.0fa8e1df.js"><link rel="prefetch" href="/docs/assets/js/28.f6fe18b4.js"><link rel="prefetch" href="/docs/assets/js/29.bf7f861e.js"><link rel="prefetch" href="/docs/assets/js/3.4a66f3ee.js"><link rel="prefetch" href="/docs/assets/js/30.81f03a3a.js"><link rel="prefetch" href="/docs/assets/js/31.7ff7f647.js"><link rel="prefetch" href="/docs/assets/js/32.b541ab54.js"><link rel="prefetch" href="/docs/assets/js/33.f373eba0.js"><link rel="prefetch" href="/docs/assets/js/34.0677801f.js"><link rel="prefetch" href="/docs/assets/js/35.4bb56847.js"><link rel="prefetch" href="/docs/assets/js/36.0aaa44ea.js"><link rel="prefetch" href="/docs/assets/js/37.597e00eb.js"><link rel="prefetch" href="/docs/assets/js/38.ecfe6a0b.js"><link rel="prefetch" href="/docs/assets/js/39.ac58eab3.js"><link rel="prefetch" href="/docs/assets/js/4.7d1e56e0.js"><link rel="prefetch" href="/docs/assets/js/40.f41d6ab2.js"><link rel="prefetch" href="/docs/assets/js/41.62d54f13.js"><link rel="prefetch" href="/docs/assets/js/42.f49db8d6.js"><link rel="prefetch" href="/docs/assets/js/43.d85f34fe.js"><link rel="prefetch" href="/docs/assets/js/44.0f754825.js"><link rel="prefetch" href="/docs/assets/js/45.392c5a0f.js"><link rel="prefetch" href="/docs/assets/js/46.d6d8f8ba.js"><link rel="prefetch" href="/docs/assets/js/47.b7a4c531.js"><link rel="prefetch" href="/docs/assets/js/48.ad5fa17b.js"><link rel="prefetch" href="/docs/assets/js/49.28728853.js"><link rel="prefetch" href="/docs/assets/js/5.540a7edc.js"><link rel="prefetch" href="/docs/assets/js/50.15c5b177.js"><link rel="prefetch" href="/docs/assets/js/51.69d32edb.js"><link rel="prefetch" href="/docs/assets/js/52.d3e83486.js"><link rel="prefetch" href="/docs/assets/js/53.0008ea69.js"><link rel="prefetch" href="/docs/assets/js/54.3aef4500.js"><link rel="prefetch" href="/docs/assets/js/55.fa31ca9c.js"><link rel="prefetch" href="/docs/assets/js/56.5e610ccb.js"><link rel="prefetch" href="/docs/assets/js/57.58bfc714.js"><link rel="prefetch" href="/docs/assets/js/58.30bce98c.js"><link rel="prefetch" href="/docs/assets/js/59.0b2a7cab.js"><link rel="prefetch" href="/docs/assets/js/6.e1b5eb00.js"><link rel="prefetch" href="/docs/assets/js/60.c716b08b.js"><link rel="prefetch" href="/docs/assets/js/61.9bdd4eb7.js"><link rel="prefetch" href="/docs/assets/js/62.a8465fbc.js"><link rel="prefetch" href="/docs/assets/js/63.6acfe33c.js"><link rel="prefetch" href="/docs/assets/js/64.8919994b.js"><link rel="prefetch" href="/docs/assets/js/65.baa9d6c1.js"><link rel="prefetch" href="/docs/assets/js/66.82611c2f.js"><link rel="prefetch" href="/docs/assets/js/67.1f706253.js"><link rel="prefetch" href="/docs/assets/js/68.22d0d616.js"><link rel="prefetch" href="/docs/assets/js/69.6c04fdc7.js"><link rel="prefetch" href="/docs/assets/js/7.0c0e690a.js"><link rel="prefetch" href="/docs/assets/js/70.6febe695.js"><link rel="prefetch" href="/docs/assets/js/71.84d036f3.js"><link rel="prefetch" href="/docs/assets/js/72.4f92b87e.js"><link rel="prefetch" href="/docs/assets/js/73.5f8725f1.js"><link rel="prefetch" href="/docs/assets/js/74.bc2be1c7.js"><link rel="prefetch" href="/docs/assets/js/75.54093e24.js"><link rel="prefetch" href="/docs/assets/js/76.27e343b4.js"><link rel="prefetch" href="/docs/assets/js/77.834fb22e.js"><link rel="prefetch" href="/docs/assets/js/78.68919345.js"><link rel="prefetch" href="/docs/assets/js/79.780e3bb0.js"><link rel="prefetch" href="/docs/assets/js/8.00e2d31b.js"><link rel="prefetch" href="/docs/assets/js/80.62b937b4.js"><link rel="prefetch" href="/docs/assets/js/81.fc50104d.js"><link rel="prefetch" href="/docs/assets/js/82.0bd33387.js"><link rel="prefetch" href="/docs/assets/js/83.08774d9f.js"><link rel="prefetch" href="/docs/assets/js/84.62d407aa.js"><link rel="prefetch" href="/docs/assets/js/85.10905711.js"><link rel="prefetch" href="/docs/assets/js/87.bd131ebc.js"><link rel="prefetch" href="/docs/assets/js/88.59963def.js"><link rel="prefetch" href="/docs/assets/js/89.235c17e4.js"><link rel="prefetch" href="/docs/assets/js/9.72fee2d0.js"><link rel="prefetch" href="/docs/assets/js/90.867fca8f.js"><link rel="prefetch" href="/docs/assets/js/91.9b32a48e.js"><link rel="prefetch" href="/docs/assets/js/92.ec8ea2e8.js"><link rel="prefetch" href="/docs/assets/js/93.d2a082a6.js"><link rel="prefetch" href="/docs/assets/js/94.dcfe033a.js"><link rel="prefetch" href="/docs/assets/js/95.27d02378.js"><link rel="prefetch" href="/docs/assets/js/96.4283f1e6.js"><link rel="prefetch" href="/docs/assets/js/97.50a130b0.js"><link rel="prefetch" href="/docs/assets/js/98.ec0bebcd.js"><link rel="prefetch" href="/docs/assets/js/99.9813c7d2.js">
    <link rel="stylesheet" href="/docs/assets/css/0.styles.89d6372f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/docs/" class="home-link router-link-active"><!----> <span class="site-name">计算机基础教程</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/docs/" class="nav-link">机器指令</a></div><div class="nav-item"><a href="/docs/software/" class="nav-link router-link-active">软件基础</a></div><div class="nav-item"><a href="/docs/coder2hacker/" class="nav-link">白帽黑客</a></div><div class="nav-item"><a href="/docs/blockchain/" class="nav-link">区块链</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/docs/" class="nav-link">机器指令</a></div><div class="nav-item"><a href="/docs/software/" class="nav-link router-link-active">软件基础</a></div><div class="nav-item"><a href="/docs/coder2hacker/" class="nav-link">白帽黑客</a></div><div class="nav-item"><a href="/docs/blockchain/" class="nav-link">区块链</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span></span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/software/database/mysql.html#_1-setup" class="sidebar-link">1.Setup</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/software/database/mysql.html#_1-1-install-on-centos" class="sidebar-link">1.1 Install on centos</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/mysql.html#_1-2-install-on-windows" class="sidebar-link">1.2 Install on windows</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/mysql.html#_1-3-client-tools" class="sidebar-link">1.3 Client Tools</a></li></ul></li><li><a href="/docs/software/database/mysql.html#_2-db-management" class="sidebar-link">2. DB Management</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/software/database/mysql.html#_2-1-mysql-cli" class="sidebar-link">2.1 mysql-cli</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/mysql.html#_2-2-database-management" class="sidebar-link">2.2 database management</a></li></ul></li><li><a href="/docs/software/database/mysql.html#_3-troubleshooting" class="sidebar-link">3.Troubleshooting</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/docs/software/database/mysql.html#_4-sql" class="sidebar-link">4. SQL</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/software/database/mysql.html#basic" class="sidebar-link">Basic</a></li><li class="sidebar-sub-header"><a href="/docs/software/database/mysql.html#advance" class="sidebar-link">Advance</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p><a href="/docs/software">回目录</a>  《mysql实用基础》</p> <h2 id="_1-setup"><a href="#_1-setup" class="header-anchor">#</a> 1.Setup</h2> <h3 id="_1-1-install-on-centos"><a href="#_1-1-install-on-centos" class="header-anchor">#</a> 1.1 Install on centos</h3> <p><strong>Method 1: Using rpm</strong></p> <p><strong>Method 2: Using tar</strong></p> <div class="language- extra-class"><pre class="language-text"><code>tar -xvf mysql-5.7.26-1.el7.x86_64.rpm-bundle.tar
yum install mysql-community-{server,client,common,libs}-* mysql-5.*­

?#Install error
https://princetonits.com/centos7-mysql-install-fails-due-conflict-libmysqlclient/
yum list installed mariadb\*
yum remove mariadb-libs.x86_64

vim /etc/my.cnf
Bind-address:0.0.0.0
service mysqld stop/start
</code></pre></div><p>Mysql默认密码：
/var/log/mysqld.log
A temporary password
https://www.techietown.info/2017/08/mysql-default-root-password-on-centos7/</p> <p>password policy:</p> <div class="language- extra-class"><pre class="language-text"><code>mysql -uroot -p
SET PASSWORD = PASSWORD(‘1qaz#EDC’);
SHOW VARIABLES LIKE 'validate_password%';
SET GLOBAL validate_password_length = 6;
SET GLOBAL validate_password_number_count = 0;
SET PASSWORD = PASSWORD(‘123456’);
</code></pre></div><p>create database:</p> <div class="language- extra-class"><pre class="language-text"><code>CREATE USER 'newuser'@'%' IDENTIFIED BY 'password';
GRANT ALL PRIVILEGES ON dbname.* TO 'newuser'@'%' identified by 'password';
#GRANT ALL PRIVILEGES ON *.* TO 'newuser'@'localhost';
FLUSH PRIVILEGES;

SHOW GRANTS FOR 'root'@'localhost';
SELECT user, host FROM mysql.user;
DROP USER ''@'localhost';

create database dbname;

</code></pre></div><h3 id="_1-2-install-on-windows"><a href="#_1-2-install-on-windows" class="header-anchor">#</a> 1.2 Install on windows</h3> <p><img src="/docs/docs_image/software/mysql/mysql01.png" alt=""></p> <p>Setup replication
https://lyhistory.com/mysql_replication/#</p> <h3 id="_1-3-client-tools"><a href="#_1-3-client-tools" class="header-anchor">#</a> 1.3 Client Tools</h3> <p>http://sqlfiddle.com/</p> <p>Dbeaver export mysql
Export without data https://github.com/dbeaver/dbeaver/issues/2176</p> <p>mysql workbench</p> <h2 id="_2-db-management"><a href="#_2-db-management" class="header-anchor">#</a> 2. DB Management</h2> <h3 id="_2-1-mysql-cli"><a href="#_2-1-mysql-cli" class="header-anchor">#</a> 2.1 mysql-cli</h3> <p>千万不要用双引号，尤其是password，所有的-u -p -e等等后面不要加空格！</p> <div class="language- extra-class"><pre class="language-text"><code>mysql -uroot -pCappuccin0!
mysql --login-path=sgkc2-devclr-v01

mysql_config_editor/login-path
mysql_config_editor print --all
</code></pre></div><p>grep:</p> <div class="language- extra-class"><pre class="language-text"><code>pager grep ***
\n
https://stackoverflow.com/questions/10177465/grep-in-mysql-cli-interpretter
</code></pre></div><h3 id="_2-2-database-management"><a href="#_2-2-database-management" class="header-anchor">#</a> 2.2 database management</h3> <p><strong>upgrade 5.7.18 5.7.26</strong></p> <div class="language- extra-class"><pre class="language-text"><code>SHOW VARIABLES WHERE Variable_name LIKE &quot;version&quot;;

https://dev.mysql.com/doc/refman/5.7/en/upgrading.html
yum list installed | grep &quot;^mysql&quot;

$ yum list installed | grep &quot;^mysql&quot;
Repodata is over 2 weeks old. Install yum-cron? Or run: yum makecache fast
mysql-community-client.x86_64         5.7.18-1.el7                @/mysql-community-client-5.7.18-1.el7.x86_64
mysql-community-common.x86_64         5.7.18-1.el7                @/mysql-community-common-5.7.18-1.el7.x86_64
mysql-community-libs.x86_64           5.7.18-1.el7                @/mysql-community-libs-5.7.18-1.el7.x86_64
mysql-community-server.x86_64         5.7.18-1.el7                @/mysql-community-server-5.7.18-1.el7.x86_64

$ find / -name &quot;mysql&quot; -o -name &quot;mysqld&quot; -type f -print 2&gt;/dev/null
/usr/sbin/mysqld
$ find / -name &quot;mysql&quot; -type d -print 2&gt;/dev/null
/var/lib/mysql
/usr/lib64/mysql
/usr/share/mysql

</code></pre></div><p>backup https://dev.mysql.com/doc/refman/5.7/en/mysqldump-sql-format.html
mysqldump -uroot -pCappuccin0! --all-databases &gt; mysqldump_20190524.sql</p> <p>Upgrading MySQL with Directly-Downloaded RPM Packages
https://dev.mysql.com/doc/refman/5.7/en/updating-direct-rpms.html
https://dev.mysql.com/doc/refman/5.7/en/linux-installation-rpm.html</p> <p>https://dev.mysql.com/downloads/mysql/</p> <p>??rpm -qpl mysql-community-server-5.7.26-1.el7.x86_64.rpm
For Red Hat Enterprise Linux/Oracle Linux/CentOS systems:
yum install mysql-community-{server,client,common,libs}-* mysql-5.*­</p> <p>For Red Hat Enterprise Linux, Oracle Linux, CentOS, and Fedora systems, use the following command to start MySQL:
service mysqld start
mysql-upgrade -uroot -pPassword
Once the server restarts, run mysql_upgrade to check and possibly resolve any incompatibilities between the old data and the upgraded software. mysql_upgrade also performs other functions; see Section 4.4.7, “mysql_upgrade — Check and Upgrade MySQL Tables” for details.
If you use replication, review Section 16.4.3, “Upgrading a Replication Setup”.
warning Table mysql/innodb_table_stats has length mismatch in the column name table_name. Please run mysql_upgrade
https://dev.mysql.com/doc/relnotes/mysql/5.7/en/news-5-7-23.html</p> <p>Installation of previous versions of MySQL using older packages might have created a configuration file named /usr/my.cnf. It is highly recommended that you examine the contents of the file and migrate the desired settings inside to the file /etc/my.cnf file, then remove /usr/my.cnf.</p> <p>trouble shooting
https://dev.mysql.com/doc/refman/5.7/en/upgrade-troubleshooting.html</p> <p><strong>turn off local_infile</strong>
SHOW VARIABLES WHERE Variable_name = 'local_infile';
SET GLOBAL local_infile = 'OFF';</p> <p><strong>plugins</strong>
https://dev.mysql.com/doc/refman/5.7/en/server-plugins.html
https://dev.mysql.com/doc/refman/5.7/en/plugin-loading.html#server-plugin-installing</p> <div class="language- extra-class"><pre class="language-text"><code>SHOW VARIABLES WHERE Variable_name = 'plugin_dir';
	/usr/lib64/mysql/plugin/
SELECT * FROM INFORMATION_SCHEMA.PLUGINS\G 
SELECT * FROM mysql.plugin;
INSTALL PLUGIN myplugin SONAME 'validate_password.so';

SELECT PLUGIN_NAME, PLUGIN_STATUS
       FROM INFORMATION_SCHEMA.PLUGINS
       WHERE PLUGIN_NAME LIKE 'validate%';
	   
The following lines should be present in the global configuration:
plugin-load=validate_password.so
validate-password=FORCE_PLUS_PERMANENT
https://dev.mysql.com/doc/refman/5.7/en/validate-password-installation.html

vim /etc/my.cnf
[mysqld]
plugin-load-add=validate_password.so
validate-password=FORCE_PLUS_PERMANENT
</code></pre></div><p>If it is desired to prevent the server from running without the password-validation plugin, use --validate-password with a value of FORCE or FORCE_PLUS_PERMANENT to force server startup to fail if the plugin does not initialize successfully.</p> <p>service mysqld start --validate-password=FORCE_PLUS_PERMANENT</p> <h2 id="_3-troubleshooting"><a href="#_3-troubleshooting" class="header-anchor">#</a> 3.Troubleshooting</h2> <p><strong>?#Host 'xxx.xx.xxx.xxx' is not allowed to connect to this MySQL server</strong></p> <div class="language- extra-class"><pre class="language-text"><code>CREATE USER 'test'@'%' IDENTIFIED BY '123456';
GRANT ALL PRIVILEGES ON * . * TO 'test'@'%';
FLUSH PRIVILEGES;
</code></pre></div><p><strong>?#mysql workbench The type initializer for 'HtmlRenderer.Utils.FontsUtils' threw an exception.</strong>
http://stackoverflow.com/questions/32020024/upgrading-to-windows-10-breaks-mysql-workbench
https://bugs.mysql.com/bug.php?id=75344</p> <p><strong>?#script import issue;</strong></p> <div class="language- extra-class"><pre class="language-text"><code>-- Set new delimiter '$$'
DELIMITER $$
$$
-- Set default delimiter ';'
DELIMITER ;
</code></pre></div><p><strong>?#Fixing “Lock wait timeout exceeded; try restarting transaction” for a 'stuck&quot; Mysql table?</strong></p> <p>https://stackoverflow.com/questions/5836623/getting-lock-wait-timeout-exceeded-try-restarting-transaction-even-though-im</p> <div class="language- extra-class"><pre class="language-text"><code>show processlist;
kill &lt;put_process_id_here&gt;; 先干掉耗时长的process
</code></pre></div><h2 id="_4-sql"><a href="#_4-sql" class="header-anchor">#</a> 4. SQL</h2> <h3 id="basic"><a href="#basic" class="header-anchor">#</a> Basic</h3> <p>a mysql db can have many schema,<strong>like a building have many rooms, and users can get access to different room, so schema can have more than one user.</strong></p> <div class="language- extra-class"><pre class="language-text"><code>SELECT DATE_FORMAT(date_add(date_column,INTERVAL 8 HOUR),'%b %d %Y %h %p'),COUNT(distinct(count_column))
FROM db.table
where date_add(date_column,INTERVAL 8 HOUR) between '2015-02-01 00:00:00' and '2015-03-01 00:00:00'
GROUP BY DATE_FORMAT(date_column,'%b %d %Y %h %p')
order by DATE_FORMAT(date_add(date_column,INTERVAL 8 HOUR),'%b %d %Y %h %p');
</code></pre></div><p>CRUD</p> <div class="language- extra-class"><pre class="language-text"><code>insert into phoenix.`program-slot`(duration,dateOfProgram,startTime,`weekly-schedule_id`,presenter_id,producer_id,program_id)
select duration,date_add(dateOfProgram,INTERVAL 2 DAY), IFNULL(date_add(startTime,INTERVAL 2 DAY),null) ,100,presenter_id,producer_id,program_id from phoenix.`program-slot` where `weekly-schedule_id` =3;

</code></pre></div><h3 id="advance"><a href="#advance" class="header-anchor">#</a> Advance</h3> <p><strong>批量生成truncate</strong></p> <div class="language- extra-class"><pre class="language-text"><code>mysql -h'HOST' -u'USERNAME' -p'PASSWORD' -e'SELECT CONCAT(&quot;TRUNCATE TABLE &quot;,TABLE_NAME,&quot;;&quot;) FROM information_schema.TABLES WHERE TABLE_SCHEMA=&quot;clear&quot; into outfile &quot;/var/lib/mysql-files/truncate_db_clear.sql&quot;;'

SHOW VARIABLES LIKE &quot;secure_file_priv&quot; 查看能写到哪个目录
</code></pre></div><p><strong>Performance on index : when join a large table</strong></p> <div class="language- extra-class"><pre class="language-text"><code>bad:
select user.*, log.LoginTime
from users user
left join login_log log on user.id=log.userid and log.LoginTime=(select max(LoginTime) from login_log where userid=log.userid and status='true');
good:
select user.*, log.LoginTime
from users user
left join (
select max(LoginTime) LoginTime,userid from login_log
where  status='true'
group by userid) temp on temp.userid=user.userid;
</code></pre></div><p><strong>存储过程互相调用</strong></p> <div class="language- extra-class"><pre class="language-text"><code>DELIMITER $$
CREATE DEFINER=`dbuser`@`%` PROCEDURE `PROCE1`(
in _param varchar(50)
)
root:BEGIN
declare _count int;
select count(1) into _count from table where column=_param;
if _count&lt;&gt;1 then
select -1 as result;
leave root;
end if;
call PROCE2(_param);
do something else
select 0 as result;
END

DELIMITER $$
CREATE DEFINER=`dbuser`@`%` PROCEDURE `PROCE2`(
in _param int
)
BEGIN
DECLARE done INT DEFAULT FALSE;
declare _variable1 int;
declare _variable2 decimal(10,2);
declare resultCur cursor for select column1,column2 from table where column=_param;
DECLARE CONTINUE HANDLER FOR NOT FOUND SET done = TRUE;
DECLARE exit handler for sqlexception
BEGIN
ROLLBACK;
get diagnostics condition 1 @p1 = MESSAGE_TEXT;
select -1 as result, @p1 as message from dual;
END;
open resultCur;
operaLoop:Loop
fetch resultCur into _variable1,_variable2;
if done then
leave operaLoop;
end if;
do something...
end Loop;
close resultCur;
END

</code></pre></div><p><strong>Multiple cursors in mysql stored procedure</strong></p> <div class="language- extra-class"><pre class="language-text"><code>DROP PROCEDURE IF EXISTS `multipleCursorsAtOne`;
DELIMITER $$
CREATE PROCEDURE `multipleCursorsAtOne`()
BEGIN
DROP TABLE IF EXISTS userNames;
CREATE TEMPORARY TABLE userNames
(userName varchar(200) NOT NULL);
BEGIN
DECLARE done BOOLEAN DEFAULT false;
DECLARE p_first_name VARCHAR(200);
DECLARE cursor_a CURSOR FOR SELECT user_name FROM user_info LIMIT 1,3;
DECLARE CONTINUE HANDLER FOR NOT FOUND SET done = TRUE;
OPEN cursor_a;
cursor_a_loop: LOOP
FETCH cursor_a INTO p_first_name;
IF done THEN
LEAVE cursor_a_loop;
END IF;
-- cursor loop statements
IF p_first_name IS NOT NULL AND p_first_name &lt;&gt; &quot;&quot; THEN
INSERT INTO userNames(userName) VALUES(p_first_name);
END IF;
END LOOP;
CLOSE cursor_a;
END;
BEGIN
DECLARE done BOOLEAN DEFAULT false;
DECLARE p_first_name VARCHAR(200);
DECLARE cursor_a CURSOR FOR SELECT user_name FROM user_info LIMIT 4,3;
DECLARE CONTINUE HANDLER FOR NOT FOUND SET done = TRUE;
OPEN cursor_a;
cursor_a_loop: LOOP
FETCH cursor_a INTO p_first_name;
IF done THEN
LEAVE cursor_a_loop;
END IF;
-- cursor loop statements
IF p_first_name IS NOT NULL AND p_first_name &lt;&gt; &quot;&quot; THEN
INSERT INTO userNames(userName) VALUES(p_first_name);
END IF;
END LOOP;
CLOSE cursor_a;
END;
SELECT * FROM userNames;
END
$$

</code></pre></div><p><strong>Recursive query</strong></p> <p>就是针对存在parent id的存在层级关系的表</p> <p>Hierarchical data in MySQL: parents and children in one query</p> <p>https://stackoverflow.com/questions/20215744/how-to-create-a-mysql-hierarchical-recursive-query</p> <p>Managing Hierarchical Data in MySQL</p> <p>https://www.mysqltutorial.org/mysql-adjacency-list-tree/</p> <hr> <p>ref:</p> <p>https://www.digitalocean.com/community/tutorials/how-to-install-mysql-on-centos-7</p> <p>benchmark: http://www.itsecure.hu/library/image/CIS_Oracle_MySQL_Enterprise_Edition_5.7_Benchmark_v1.0.0.pdf</p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/docs/assets/js/app.b015bf24.js" defer></script><script src="/docs/assets/js/2.dc5756d7.js" defer></script><script src="/docs/assets/js/86.617cb2f5.js" defer></script>
  </body>
</html>
