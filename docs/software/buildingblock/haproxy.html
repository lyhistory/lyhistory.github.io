<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>1. intro | 计算机基础教程</title>
    <meta name="generator" content="VuePress 1.9.7">
    <script async="true" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9742852210287449" crossorigin="anonymous"></script>
    <script async="true" src="https://www.googletagmanager.com/gtag/js?id=AW-748196294"></script>
    <script>
          window.dataLayer = window.dataLayer || [];
		  function gtag(){dataLayer.push(arguments);}
		  gtag('js', new Date());
		  
		  gtag('config', 'AW-748196294');
        </script>
    <script>
			(function() { // DON'T EDIT BELOW THIS LINE
			
			})();
		 </script>
    <meta name="description" content="软件开发教程，白帽黑客入门教程，区块链入门教程，物联网，大数据">
    
    <link rel="preload" href="/docs/assets/css/0.styles.d4eb5ad8.css" as="style"><link rel="preload" href="/docs/assets/js/app.f3b5d2d6.js" as="script"><link rel="preload" href="/docs/assets/js/2.d450803a.js" as="script"><link rel="preload" href="/docs/assets/js/184.a6c0fbe9.js" as="script"><link rel="preload" href="/docs/assets/js/7.be017326.js" as="script"><link rel="prefetch" href="/docs/assets/js/10.6280ea0f.js"><link rel="prefetch" href="/docs/assets/js/100.dd7b2eaf.js"><link rel="prefetch" href="/docs/assets/js/101.120a98da.js"><link rel="prefetch" href="/docs/assets/js/102.1651235e.js"><link rel="prefetch" href="/docs/assets/js/103.d597125d.js"><link rel="prefetch" href="/docs/assets/js/104.ff56395e.js"><link rel="prefetch" href="/docs/assets/js/105.560d6962.js"><link rel="prefetch" href="/docs/assets/js/106.f13a7d16.js"><link rel="prefetch" href="/docs/assets/js/107.045ca855.js"><link rel="prefetch" href="/docs/assets/js/108.87efcedf.js"><link rel="prefetch" href="/docs/assets/js/109.aa3e7576.js"><link rel="prefetch" href="/docs/assets/js/11.68ab8c41.js"><link rel="prefetch" href="/docs/assets/js/110.c91e11ed.js"><link rel="prefetch" href="/docs/assets/js/111.3f0ac95e.js"><link rel="prefetch" href="/docs/assets/js/112.605bdc23.js"><link rel="prefetch" href="/docs/assets/js/113.4be855c2.js"><link rel="prefetch" href="/docs/assets/js/114.7dd886cd.js"><link rel="prefetch" href="/docs/assets/js/115.3174bf56.js"><link rel="prefetch" href="/docs/assets/js/116.c5bbe50c.js"><link rel="prefetch" href="/docs/assets/js/117.caeddc4a.js"><link rel="prefetch" href="/docs/assets/js/118.3c6e58d6.js"><link rel="prefetch" href="/docs/assets/js/119.0d6f1c81.js"><link rel="prefetch" href="/docs/assets/js/12.42639e7a.js"><link rel="prefetch" href="/docs/assets/js/120.d4501723.js"><link rel="prefetch" href="/docs/assets/js/121.1c102c4f.js"><link rel="prefetch" href="/docs/assets/js/122.d59d35bf.js"><link rel="prefetch" href="/docs/assets/js/123.29688b75.js"><link rel="prefetch" href="/docs/assets/js/124.09f5746a.js"><link rel="prefetch" href="/docs/assets/js/125.efea9bcc.js"><link rel="prefetch" href="/docs/assets/js/126.78bb787e.js"><link rel="prefetch" href="/docs/assets/js/127.ece9e615.js"><link rel="prefetch" href="/docs/assets/js/128.c0f197d8.js"><link rel="prefetch" href="/docs/assets/js/129.3ac4512a.js"><link rel="prefetch" href="/docs/assets/js/13.4f960cca.js"><link rel="prefetch" href="/docs/assets/js/130.dd2a1e2a.js"><link rel="prefetch" href="/docs/assets/js/131.6bd8f4d8.js"><link rel="prefetch" href="/docs/assets/js/132.df88ea23.js"><link rel="prefetch" href="/docs/assets/js/133.a3b5fe0a.js"><link rel="prefetch" href="/docs/assets/js/134.ad499f1b.js"><link rel="prefetch" href="/docs/assets/js/135.e27d6df5.js"><link rel="prefetch" href="/docs/assets/js/136.db1b386f.js"><link rel="prefetch" href="/docs/assets/js/137.b076086e.js"><link rel="prefetch" href="/docs/assets/js/138.6edd42b3.js"><link rel="prefetch" href="/docs/assets/js/139.594db60d.js"><link rel="prefetch" href="/docs/assets/js/14.707b2351.js"><link rel="prefetch" href="/docs/assets/js/140.529f22b1.js"><link rel="prefetch" href="/docs/assets/js/141.25bf61d8.js"><link rel="prefetch" href="/docs/assets/js/142.b9b9be79.js"><link rel="prefetch" href="/docs/assets/js/143.2ad03972.js"><link rel="prefetch" href="/docs/assets/js/144.4b7a00a3.js"><link rel="prefetch" href="/docs/assets/js/145.6a3ef15e.js"><link rel="prefetch" href="/docs/assets/js/146.71f24f49.js"><link rel="prefetch" href="/docs/assets/js/147.a435857d.js"><link rel="prefetch" href="/docs/assets/js/148.8cd0636b.js"><link rel="prefetch" href="/docs/assets/js/149.59500037.js"><link rel="prefetch" href="/docs/assets/js/15.234d315c.js"><link rel="prefetch" href="/docs/assets/js/150.49caeee8.js"><link rel="prefetch" href="/docs/assets/js/151.fddc5e98.js"><link rel="prefetch" href="/docs/assets/js/152.38a198ce.js"><link rel="prefetch" href="/docs/assets/js/153.1a9f7c90.js"><link rel="prefetch" href="/docs/assets/js/154.bd050107.js"><link rel="prefetch" href="/docs/assets/js/155.1159a78e.js"><link rel="prefetch" href="/docs/assets/js/156.1f5f9e09.js"><link rel="prefetch" href="/docs/assets/js/157.a3f38260.js"><link rel="prefetch" href="/docs/assets/js/158.1e91a361.js"><link rel="prefetch" href="/docs/assets/js/159.e7aa7e41.js"><link rel="prefetch" href="/docs/assets/js/16.4a51c985.js"><link rel="prefetch" href="/docs/assets/js/160.a14306aa.js"><link rel="prefetch" href="/docs/assets/js/161.b6e6822d.js"><link rel="prefetch" href="/docs/assets/js/162.d830fa56.js"><link rel="prefetch" href="/docs/assets/js/163.036b22f1.js"><link rel="prefetch" href="/docs/assets/js/164.5857fdbc.js"><link rel="prefetch" href="/docs/assets/js/165.50947da1.js"><link rel="prefetch" href="/docs/assets/js/166.714b3640.js"><link rel="prefetch" href="/docs/assets/js/167.b2cff198.js"><link rel="prefetch" href="/docs/assets/js/168.34e075cb.js"><link rel="prefetch" href="/docs/assets/js/169.76549873.js"><link rel="prefetch" href="/docs/assets/js/17.006a54ef.js"><link rel="prefetch" href="/docs/assets/js/170.d251807d.js"><link rel="prefetch" href="/docs/assets/js/171.bd487667.js"><link rel="prefetch" href="/docs/assets/js/172.e3a9e812.js"><link rel="prefetch" href="/docs/assets/js/173.80869caa.js"><link rel="prefetch" href="/docs/assets/js/174.7827131f.js"><link rel="prefetch" href="/docs/assets/js/175.6ee7d79a.js"><link rel="prefetch" href="/docs/assets/js/176.a4fecc5a.js"><link rel="prefetch" href="/docs/assets/js/177.ad2c0780.js"><link rel="prefetch" href="/docs/assets/js/178.f67c11cc.js"><link rel="prefetch" href="/docs/assets/js/179.885cef6f.js"><link rel="prefetch" href="/docs/assets/js/18.f05e0591.js"><link rel="prefetch" href="/docs/assets/js/180.8ae8692d.js"><link rel="prefetch" href="/docs/assets/js/181.697b1f75.js"><link rel="prefetch" href="/docs/assets/js/182.11476875.js"><link rel="prefetch" href="/docs/assets/js/183.cd8aab0f.js"><link rel="prefetch" href="/docs/assets/js/185.4601014d.js"><link rel="prefetch" href="/docs/assets/js/186.7ab19c26.js"><link rel="prefetch" href="/docs/assets/js/187.f67b4f96.js"><link rel="prefetch" href="/docs/assets/js/188.477a5835.js"><link rel="prefetch" href="/docs/assets/js/189.1a5ad809.js"><link rel="prefetch" href="/docs/assets/js/19.0be4353a.js"><link rel="prefetch" href="/docs/assets/js/190.c0f18fde.js"><link rel="prefetch" href="/docs/assets/js/191.8ca4812a.js"><link rel="prefetch" href="/docs/assets/js/192.dde11235.js"><link rel="prefetch" href="/docs/assets/js/193.88669354.js"><link rel="prefetch" href="/docs/assets/js/194.8ae5c728.js"><link rel="prefetch" href="/docs/assets/js/195.a463164e.js"><link rel="prefetch" href="/docs/assets/js/196.47f3c9fc.js"><link rel="prefetch" href="/docs/assets/js/197.0065d329.js"><link rel="prefetch" href="/docs/assets/js/198.658385f3.js"><link rel="prefetch" href="/docs/assets/js/199.71dc01ef.js"><link rel="prefetch" href="/docs/assets/js/20.3b79ab50.js"><link rel="prefetch" href="/docs/assets/js/200.17d68cc2.js"><link rel="prefetch" href="/docs/assets/js/201.b2b8b8a4.js"><link rel="prefetch" href="/docs/assets/js/202.95d11e68.js"><link rel="prefetch" href="/docs/assets/js/203.960d31ec.js"><link rel="prefetch" href="/docs/assets/js/204.66a3ddbb.js"><link rel="prefetch" href="/docs/assets/js/205.472c9cbc.js"><link rel="prefetch" href="/docs/assets/js/206.dd9df3d0.js"><link rel="prefetch" href="/docs/assets/js/207.b180755c.js"><link rel="prefetch" href="/docs/assets/js/208.952ccdc4.js"><link rel="prefetch" href="/docs/assets/js/209.e30442b0.js"><link rel="prefetch" href="/docs/assets/js/21.9312e011.js"><link rel="prefetch" href="/docs/assets/js/210.c71f633e.js"><link rel="prefetch" href="/docs/assets/js/211.4fca6eef.js"><link rel="prefetch" href="/docs/assets/js/212.8537f88b.js"><link rel="prefetch" href="/docs/assets/js/213.594847b7.js"><link rel="prefetch" href="/docs/assets/js/214.463a1959.js"><link rel="prefetch" href="/docs/assets/js/215.6971ffc8.js"><link rel="prefetch" href="/docs/assets/js/216.3e1b7339.js"><link rel="prefetch" href="/docs/assets/js/217.05645c53.js"><link rel="prefetch" href="/docs/assets/js/218.8754bb3b.js"><link rel="prefetch" href="/docs/assets/js/219.aa6527a4.js"><link rel="prefetch" href="/docs/assets/js/22.840bab1f.js"><link rel="prefetch" href="/docs/assets/js/220.111da57f.js"><link rel="prefetch" href="/docs/assets/js/221.6a59a9e0.js"><link rel="prefetch" href="/docs/assets/js/222.3ac8bdb5.js"><link rel="prefetch" href="/docs/assets/js/223.1a16a1c2.js"><link rel="prefetch" href="/docs/assets/js/224.dd5faaeb.js"><link rel="prefetch" href="/docs/assets/js/225.23e55812.js"><link rel="prefetch" href="/docs/assets/js/226.800c79e9.js"><link rel="prefetch" href="/docs/assets/js/227.5084e9c9.js"><link rel="prefetch" href="/docs/assets/js/228.f5966dad.js"><link rel="prefetch" href="/docs/assets/js/229.2d0c31fc.js"><link rel="prefetch" href="/docs/assets/js/23.eb14ea0a.js"><link rel="prefetch" href="/docs/assets/js/230.300148d6.js"><link rel="prefetch" href="/docs/assets/js/231.b1e26be6.js"><link rel="prefetch" href="/docs/assets/js/232.059c505d.js"><link rel="prefetch" href="/docs/assets/js/233.df9280b4.js"><link rel="prefetch" href="/docs/assets/js/234.d21644c2.js"><link rel="prefetch" href="/docs/assets/js/235.d4460d3b.js"><link rel="prefetch" href="/docs/assets/js/236.8bb49f02.js"><link rel="prefetch" href="/docs/assets/js/237.f7140b42.js"><link rel="prefetch" href="/docs/assets/js/238.95430d39.js"><link rel="prefetch" href="/docs/assets/js/239.261712eb.js"><link rel="prefetch" href="/docs/assets/js/24.6a3523bd.js"><link rel="prefetch" href="/docs/assets/js/240.38ee337d.js"><link rel="prefetch" href="/docs/assets/js/241.f40397f5.js"><link rel="prefetch" href="/docs/assets/js/242.64630cb9.js"><link rel="prefetch" href="/docs/assets/js/243.ebe87ecb.js"><link rel="prefetch" href="/docs/assets/js/244.59373918.js"><link rel="prefetch" href="/docs/assets/js/245.06410403.js"><link rel="prefetch" href="/docs/assets/js/246.5af5410e.js"><link rel="prefetch" href="/docs/assets/js/247.df4f4f02.js"><link rel="prefetch" href="/docs/assets/js/248.3cdd6d9c.js"><link rel="prefetch" href="/docs/assets/js/249.77ca8aaa.js"><link rel="prefetch" href="/docs/assets/js/25.0d5a5353.js"><link rel="prefetch" href="/docs/assets/js/250.8c75088c.js"><link rel="prefetch" href="/docs/assets/js/251.d6e181e4.js"><link rel="prefetch" href="/docs/assets/js/252.35a42de2.js"><link rel="prefetch" href="/docs/assets/js/253.a3a2519d.js"><link rel="prefetch" href="/docs/assets/js/254.46ac4f4b.js"><link rel="prefetch" href="/docs/assets/js/255.7d9d3285.js"><link rel="prefetch" href="/docs/assets/js/256.264318b3.js"><link rel="prefetch" href="/docs/assets/js/257.73a18588.js"><link rel="prefetch" href="/docs/assets/js/258.db91946d.js"><link rel="prefetch" href="/docs/assets/js/259.ed217b03.js"><link rel="prefetch" href="/docs/assets/js/26.3a5a1001.js"><link rel="prefetch" href="/docs/assets/js/260.2098ed49.js"><link rel="prefetch" href="/docs/assets/js/261.f7ecfd2a.js"><link rel="prefetch" href="/docs/assets/js/262.8200335d.js"><link rel="prefetch" href="/docs/assets/js/263.5e98ca21.js"><link rel="prefetch" href="/docs/assets/js/264.af46e3d4.js"><link rel="prefetch" href="/docs/assets/js/265.8f9770a9.js"><link rel="prefetch" href="/docs/assets/js/266.fdc35c2c.js"><link rel="prefetch" href="/docs/assets/js/267.45256123.js"><link rel="prefetch" href="/docs/assets/js/268.0db74a41.js"><link rel="prefetch" href="/docs/assets/js/269.96bf5145.js"><link rel="prefetch" href="/docs/assets/js/27.2fd17597.js"><link rel="prefetch" href="/docs/assets/js/270.a2a8d685.js"><link rel="prefetch" href="/docs/assets/js/271.80c618b8.js"><link rel="prefetch" href="/docs/assets/js/272.1af647eb.js"><link rel="prefetch" href="/docs/assets/js/273.86894be5.js"><link rel="prefetch" href="/docs/assets/js/274.65f4bed7.js"><link rel="prefetch" href="/docs/assets/js/275.31ce2614.js"><link rel="prefetch" href="/docs/assets/js/276.6e464a86.js"><link rel="prefetch" href="/docs/assets/js/277.9583139c.js"><link rel="prefetch" href="/docs/assets/js/278.6384aaeb.js"><link rel="prefetch" href="/docs/assets/js/279.68947328.js"><link rel="prefetch" href="/docs/assets/js/28.c8f68f87.js"><link rel="prefetch" href="/docs/assets/js/280.6941e4c0.js"><link rel="prefetch" href="/docs/assets/js/281.216abc76.js"><link rel="prefetch" href="/docs/assets/js/282.e1c9392b.js"><link rel="prefetch" href="/docs/assets/js/283.156aa1e0.js"><link rel="prefetch" href="/docs/assets/js/284.9aaabb45.js"><link rel="prefetch" href="/docs/assets/js/285.d3e30f81.js"><link rel="prefetch" href="/docs/assets/js/286.e78c0e38.js"><link rel="prefetch" href="/docs/assets/js/287.1c326756.js"><link rel="prefetch" href="/docs/assets/js/288.64dd2607.js"><link rel="prefetch" href="/docs/assets/js/289.33c8dd2f.js"><link rel="prefetch" href="/docs/assets/js/29.4ca7de48.js"><link rel="prefetch" href="/docs/assets/js/290.2cfaa9e0.js"><link rel="prefetch" href="/docs/assets/js/291.9612fd2e.js"><link rel="prefetch" href="/docs/assets/js/292.39a45f0f.js"><link rel="prefetch" href="/docs/assets/js/293.c2910cee.js"><link rel="prefetch" href="/docs/assets/js/294.1a7d8bdf.js"><link rel="prefetch" href="/docs/assets/js/295.429492e3.js"><link rel="prefetch" href="/docs/assets/js/296.5850d321.js"><link rel="prefetch" href="/docs/assets/js/297.ee526ea1.js"><link rel="prefetch" href="/docs/assets/js/298.4ad8b9fb.js"><link rel="prefetch" href="/docs/assets/js/299.0fa4a4c3.js"><link rel="prefetch" href="/docs/assets/js/3.d8468ba9.js"><link rel="prefetch" href="/docs/assets/js/30.88f734f4.js"><link rel="prefetch" href="/docs/assets/js/300.967725d5.js"><link rel="prefetch" href="/docs/assets/js/301.6fba530e.js"><link rel="prefetch" href="/docs/assets/js/302.c7b19d9b.js"><link rel="prefetch" href="/docs/assets/js/303.c9c22407.js"><link rel="prefetch" href="/docs/assets/js/304.55b24672.js"><link rel="prefetch" href="/docs/assets/js/305.ee18239f.js"><link rel="prefetch" href="/docs/assets/js/306.1394394d.js"><link rel="prefetch" href="/docs/assets/js/307.874736fb.js"><link rel="prefetch" href="/docs/assets/js/308.08e05281.js"><link rel="prefetch" href="/docs/assets/js/309.ab1320d3.js"><link rel="prefetch" href="/docs/assets/js/31.812febfc.js"><link rel="prefetch" href="/docs/assets/js/310.2917c730.js"><link rel="prefetch" href="/docs/assets/js/311.2250928b.js"><link rel="prefetch" href="/docs/assets/js/312.dc9ed218.js"><link rel="prefetch" href="/docs/assets/js/313.5f7354dc.js"><link rel="prefetch" href="/docs/assets/js/314.a2c3822b.js"><link rel="prefetch" href="/docs/assets/js/315.f4ebf138.js"><link rel="prefetch" href="/docs/assets/js/316.0fe20027.js"><link rel="prefetch" href="/docs/assets/js/317.338d1286.js"><link rel="prefetch" href="/docs/assets/js/318.96d07074.js"><link rel="prefetch" href="/docs/assets/js/319.67375a13.js"><link rel="prefetch" href="/docs/assets/js/32.efb9fa2b.js"><link rel="prefetch" href="/docs/assets/js/320.65d4cb05.js"><link rel="prefetch" href="/docs/assets/js/321.62007294.js"><link rel="prefetch" href="/docs/assets/js/322.de6904eb.js"><link rel="prefetch" href="/docs/assets/js/323.6dd9cbd0.js"><link rel="prefetch" href="/docs/assets/js/324.44b75b17.js"><link rel="prefetch" href="/docs/assets/js/325.6ff6abb7.js"><link rel="prefetch" href="/docs/assets/js/326.af03122c.js"><link rel="prefetch" href="/docs/assets/js/327.b9a1294a.js"><link rel="prefetch" href="/docs/assets/js/328.7141ca86.js"><link rel="prefetch" href="/docs/assets/js/329.6f043d29.js"><link rel="prefetch" href="/docs/assets/js/33.e8d002e6.js"><link rel="prefetch" href="/docs/assets/js/330.5339ae91.js"><link rel="prefetch" href="/docs/assets/js/331.f3a0ae22.js"><link rel="prefetch" href="/docs/assets/js/332.89b57255.js"><link rel="prefetch" href="/docs/assets/js/333.2065e258.js"><link rel="prefetch" href="/docs/assets/js/334.912b1efb.js"><link rel="prefetch" href="/docs/assets/js/335.b9e12774.js"><link rel="prefetch" href="/docs/assets/js/336.badc35e4.js"><link rel="prefetch" href="/docs/assets/js/337.7b9cd2de.js"><link rel="prefetch" href="/docs/assets/js/338.31a13056.js"><link rel="prefetch" href="/docs/assets/js/339.59056abd.js"><link rel="prefetch" href="/docs/assets/js/34.7debaff4.js"><link rel="prefetch" href="/docs/assets/js/340.3e0ef988.js"><link rel="prefetch" href="/docs/assets/js/341.79b60e7a.js"><link rel="prefetch" href="/docs/assets/js/342.1ca133c5.js"><link rel="prefetch" href="/docs/assets/js/343.e7176e20.js"><link rel="prefetch" href="/docs/assets/js/344.542e0141.js"><link rel="prefetch" href="/docs/assets/js/345.09658144.js"><link rel="prefetch" href="/docs/assets/js/346.2b048854.js"><link rel="prefetch" href="/docs/assets/js/347.cba5e80b.js"><link rel="prefetch" href="/docs/assets/js/348.21f3c6a5.js"><link rel="prefetch" href="/docs/assets/js/349.575c8e38.js"><link rel="prefetch" href="/docs/assets/js/35.419ae8aa.js"><link rel="prefetch" href="/docs/assets/js/350.9318f172.js"><link rel="prefetch" href="/docs/assets/js/351.9a633e72.js"><link rel="prefetch" href="/docs/assets/js/352.1c9c2c54.js"><link rel="prefetch" href="/docs/assets/js/353.4abd03cf.js"><link rel="prefetch" href="/docs/assets/js/354.82cb73b3.js"><link rel="prefetch" href="/docs/assets/js/355.554f84a2.js"><link rel="prefetch" href="/docs/assets/js/356.70b03c38.js"><link rel="prefetch" href="/docs/assets/js/357.10181c54.js"><link rel="prefetch" href="/docs/assets/js/358.111240b0.js"><link rel="prefetch" href="/docs/assets/js/359.7b0a105d.js"><link rel="prefetch" href="/docs/assets/js/36.144c0c9d.js"><link rel="prefetch" href="/docs/assets/js/360.7b0aaa32.js"><link rel="prefetch" href="/docs/assets/js/361.0fc63c1c.js"><link rel="prefetch" href="/docs/assets/js/362.aea2daa8.js"><link rel="prefetch" href="/docs/assets/js/363.c3b5f161.js"><link rel="prefetch" href="/docs/assets/js/364.69520334.js"><link rel="prefetch" href="/docs/assets/js/365.7a2c02e5.js"><link rel="prefetch" href="/docs/assets/js/366.9ec8c8b0.js"><link rel="prefetch" href="/docs/assets/js/367.8d7ffc0a.js"><link rel="prefetch" href="/docs/assets/js/368.f7a9a256.js"><link rel="prefetch" href="/docs/assets/js/369.b5c1335d.js"><link rel="prefetch" href="/docs/assets/js/37.14945475.js"><link rel="prefetch" href="/docs/assets/js/370.b5f6396b.js"><link rel="prefetch" href="/docs/assets/js/371.7470a948.js"><link rel="prefetch" href="/docs/assets/js/372.8a1ecb6c.js"><link rel="prefetch" href="/docs/assets/js/38.86e1cb4f.js"><link rel="prefetch" href="/docs/assets/js/39.351f0ffc.js"><link rel="prefetch" href="/docs/assets/js/4.6d27a4d7.js"><link rel="prefetch" href="/docs/assets/js/40.edec7486.js"><link rel="prefetch" href="/docs/assets/js/41.e086c257.js"><link rel="prefetch" href="/docs/assets/js/42.be094b47.js"><link rel="prefetch" href="/docs/assets/js/43.5e89fd04.js"><link rel="prefetch" href="/docs/assets/js/44.90a633ec.js"><link rel="prefetch" href="/docs/assets/js/45.f6c9f171.js"><link rel="prefetch" href="/docs/assets/js/46.26056234.js"><link rel="prefetch" href="/docs/assets/js/47.60a0ffb3.js"><link rel="prefetch" href="/docs/assets/js/48.cb7836d7.js"><link rel="prefetch" href="/docs/assets/js/49.e02b00fd.js"><link rel="prefetch" href="/docs/assets/js/5.3f8add54.js"><link rel="prefetch" href="/docs/assets/js/50.085679f8.js"><link rel="prefetch" href="/docs/assets/js/51.1711c0b5.js"><link rel="prefetch" href="/docs/assets/js/52.316fca4c.js"><link rel="prefetch" href="/docs/assets/js/53.304208d7.js"><link rel="prefetch" href="/docs/assets/js/54.23dbc7f7.js"><link rel="prefetch" href="/docs/assets/js/55.38293be8.js"><link rel="prefetch" href="/docs/assets/js/56.a9114d19.js"><link rel="prefetch" href="/docs/assets/js/57.a160db01.js"><link rel="prefetch" href="/docs/assets/js/58.edb10a0c.js"><link rel="prefetch" href="/docs/assets/js/59.881f3b69.js"><link rel="prefetch" href="/docs/assets/js/6.46c18dae.js"><link rel="prefetch" href="/docs/assets/js/60.a73250e3.js"><link rel="prefetch" href="/docs/assets/js/61.7a3ec1d5.js"><link rel="prefetch" href="/docs/assets/js/62.e528d9c3.js"><link rel="prefetch" href="/docs/assets/js/63.f35a521c.js"><link rel="prefetch" href="/docs/assets/js/64.2b24d5e0.js"><link rel="prefetch" href="/docs/assets/js/65.dabf4313.js"><link rel="prefetch" href="/docs/assets/js/66.9ce31f6b.js"><link rel="prefetch" href="/docs/assets/js/67.43831855.js"><link rel="prefetch" href="/docs/assets/js/68.1541268f.js"><link rel="prefetch" href="/docs/assets/js/69.988f4492.js"><link rel="prefetch" href="/docs/assets/js/70.a8bf1434.js"><link rel="prefetch" href="/docs/assets/js/71.f925cfec.js"><link rel="prefetch" href="/docs/assets/js/72.4cc4b709.js"><link rel="prefetch" href="/docs/assets/js/73.91da6b8a.js"><link rel="prefetch" href="/docs/assets/js/74.9c4d392c.js"><link rel="prefetch" href="/docs/assets/js/75.b7358cb3.js"><link rel="prefetch" href="/docs/assets/js/76.2369e6c7.js"><link rel="prefetch" href="/docs/assets/js/77.2619c27d.js"><link rel="prefetch" href="/docs/assets/js/78.8c6fe860.js"><link rel="prefetch" href="/docs/assets/js/79.a677a882.js"><link rel="prefetch" href="/docs/assets/js/8.ee4d56b4.js"><link rel="prefetch" href="/docs/assets/js/80.0f780c8a.js"><link rel="prefetch" href="/docs/assets/js/81.6b0e1e78.js"><link rel="prefetch" href="/docs/assets/js/82.d175d70f.js"><link rel="prefetch" href="/docs/assets/js/83.56b2ed24.js"><link rel="prefetch" href="/docs/assets/js/84.bf73bf5b.js"><link rel="prefetch" href="/docs/assets/js/85.3350db79.js"><link rel="prefetch" href="/docs/assets/js/86.a6715be6.js"><link rel="prefetch" href="/docs/assets/js/87.6dda8387.js"><link rel="prefetch" href="/docs/assets/js/88.f0f32c09.js"><link rel="prefetch" href="/docs/assets/js/89.3d6e839c.js"><link rel="prefetch" href="/docs/assets/js/9.a5996d1e.js"><link rel="prefetch" href="/docs/assets/js/90.3a2f84ba.js"><link rel="prefetch" href="/docs/assets/js/91.b7120088.js"><link rel="prefetch" href="/docs/assets/js/92.758bd9dc.js"><link rel="prefetch" href="/docs/assets/js/93.6d78b268.js"><link rel="prefetch" href="/docs/assets/js/94.79ab27dd.js"><link rel="prefetch" href="/docs/assets/js/95.3000b404.js"><link rel="prefetch" href="/docs/assets/js/96.21cd94f2.js"><link rel="prefetch" href="/docs/assets/js/97.ec77883f.js"><link rel="prefetch" href="/docs/assets/js/98.7e4dd49d.js"><link rel="prefetch" href="/docs/assets/js/99.41131ae1.js">
    <link rel="stylesheet" href="/docs/assets/css/0.styles.d4eb5ad8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/docs/" class="home-link router-link-active"><!----> <span class="site-name">计算机基础教程</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/docs/" class="nav-link">
  机器指令
</a></div><div class="nav-item"><a href="/docs/software/" class="nav-link router-link-active">
  软件基础
</a></div><div class="nav-item"><a href="/docs/coder2hacker/" class="nav-link">
  白帽黑客
</a></div><div class="nav-item"><a href="/docs/blockchain/" class="nav-link">
  区块链
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/docs/" class="nav-link">
  机器指令
</a></div><div class="nav-item"><a href="/docs/software/" class="nav-link router-link-active">
  软件基础
</a></div><div class="nav-item"><a href="/docs/coder2hacker/" class="nav-link">
  白帽黑客
</a></div><div class="nav-item"><a href="/docs/blockchain/" class="nav-link">
  区块链
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>1. intro</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/software/buildingblock/haproxy.html#_1-intro" class="sidebar-link">1. intro</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/docs/software/buildingblock/haproxy.html#_2-management" class="sidebar-link">2. management</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/software/buildingblock/haproxy.html#_2-1-install" class="sidebar-link">2.1 install</a></li><li class="sidebar-sub-header"><a href="/docs/software/buildingblock/haproxy.html#_2-2-logging" class="sidebar-link">2.2 Logging</a></li><li class="sidebar-sub-header"><a href="/docs/software/buildingblock/haproxy.html#_2-3-utilities-调试工具" class="sidebar-link">2.3 utilities 调试工具</a></li><li class="sidebar-sub-header"><a href="/docs/software/buildingblock/haproxy.html#_2-3-1-socat管理haproxy以及haproxy调优" class="sidebar-link" style="padding-left:3rem;">2.3.1 socat管理haproxy以及haproxy调优</a></li><li class="sidebar-sub-header"><a href="/docs/software/buildingblock/haproxy.html#unix-socket-socat" class="sidebar-link" style="padding-left:4rem;">Unix socket &amp; socat</a></li><li class="sidebar-sub-header"><a href="/docs/software/buildingblock/haproxy.html#master-cli" class="sidebar-link" style="padding-left:4rem;">Master CLI</a></li><li class="sidebar-sub-header"><a href="/docs/software/buildingblock/haproxy.html#_2-3-2-tcpdump-strace" class="sidebar-link" style="padding-left:3rem;">2.3.2 tcpdump &amp; strace</a></li></ul></li><li><a href="/docs/software/buildingblock/haproxy.html#_3-configuration" class="sidebar-link">3. configuration</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/software/buildingblock/haproxy.html#安全设置" class="sidebar-link">安全设置</a></li></ul></li><li><a href="/docs/software/buildingblock/haproxy.html#coding-style" class="sidebar-link">coding-style</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/docs/software/buildingblock/haproxy.html#proxy-protocol" class="sidebar-link">proxy-protocol</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/docs/software/buildingblock/haproxy.html#一些问题" class="sidebar-link">一些问题</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/docs/software/buildingblock/haproxy.html#国内是如何使用的" class="sidebar-link">国内是如何使用的</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="_1-intro"><a href="#_1-intro" class="header-anchor">#</a> 1. intro</h2> <p>https://cbonte.github.io/haproxy-dconv/2.3/intro.html</p> <p>what it does, what it doesn't do, some known traps to avoid, some OS-specific limitations, how to get it, how it evolves, how to ensure you're running with all known fixes</p> <p>Load balancing consists in aggregating multiple components in order to achieve a total processing capacity above each component's individual capacity, without any intervention from the end user and in a scalable way.</p> <p>A good example of this is the number of lanes on a highway which allows as many cars to pass during the same time frame without increasing their individual speed</p> <p>A load balancer may act :</p> <ul><li><p>at the link level : this is called link load balancing, and it consists in
choosing what network link to send a packet to;
L4 传输层（通过L3网络层的ip加传输层的端口决定流量负载） Stateful/Stateless</p></li> <li><p>at the network level : this is called network load balancing, and it
consists in choosing what route a series of packets will follow;
L7 应用层（在L4基础上，还可以通过URL、头信息、浏览器等决定流量负载） Stateful</p></li> <li><p>at the server level : this is called server load balancing and it consists
in deciding what server will process a connection or request.</p></li></ul> <p>packet based VS proxy based:</p> <p>[https://ipwithease.com/packet-based-design-vs-full-proxy-design-in-f5/#:~:text=Packet%20based%20designs%20have%20a,connection%20between%20client%20and%20server.&amp;text=With%20full%20proxy%20mode%2C%20we,middle%20of%20client%20and%20server.](https://ipwithease.com/packet-based-design-vs-full-proxy-design-in-f5/#:~:text=Packet based designs have a,connection between client and server.&amp;text=With full proxy mode%2C we,middle of client and server.)</p> <p>Packet-based load balancers are generally deployed in cut-through mode, so they are installed on the normal path of the traffic and divert it according to the configuration.
Proxy-based load balancers are deployed as a server with their own IP addresses and ports, without architecture changes. 	Sometimes this requires to perform some adaptations to the applications so that clients are properly directed to the load balancer's IP address and not directly to the server's.</p> <p>Note:</p> <p>haproxy is not a packet-based load balancer: it will not see IP packets nor UDP datagrams, will not perform NAT or even less DSR. These are tasks for lower layers. Some kernel-based components such as IPVS (Linux Virtual Server) already do this pretty well and complement perfectly with HAProxy.</p> <p>Linux Virtual Server (LVS or IPVS) is the layer 4 load balancer included within the Linux kernel. It works at the packet level and handles TCP and UDP.</p> <p>所以网上说haproxy提供了L4转发能力，实际上haproxy只是借助内核来实现的</p> <p>https://www.cnblogs.com/passzhang/p/12090657.html</p> <p>HAProxy:</p> <p>TCP Proxy:</p> <p>it can accept a TCP connection from a listening socket, connect to a server and attach these sockets together allowing traffic to flow in both directions; <strong>IPv4, IPv6 and even UNIX sockets</strong>are supported on either side</p> <p>HTTP reverse-proxy/Gateway:</p> <p>it presents itself as a server, receives HTTP requests over connections accepted on a listening TCP socket, and passes the requests from these connections to servers using different connections</p> <p>SSL terminator / initiator / offloader:</p> <p>SSL/TLS may be used on the connection coming from the client, on the connection going to the server, or even on both connections.</p> <p>TCP normalizer:</p> <p>abnormal traffic such as invalid packets, flag combinations, window advertisements, sequence numbers, incomplete connections (SYN floods), or so will not be passed to the other side. This protects fragile TCP stacks from protocol attacks, and also allows to optimize the connection parameters with the client without having to modify the servers' TCP stack settings.</p> <p>HTTP normalizer:</p> <p>protects against a lot of protocol-based attacks</p> <p>HTTP fixing tool:</p> <p>fixing interoperability issues in complex environments.</p> <p>content-based switch:</p> <p>it can consider any element from the request to decide what server to pass the request or connection to. Thus it is possible to handle multiple protocols over a same port (e.g. HTTP, HTTPS, SSH).</p> <p>server load balancer:</p> <p>it can load balance TCP connections and HTTP requests. In TCP mode, load balancing decisions are taken for the whole connection. In HTTP mode, decisions are taken per request</p> <p>traffic regulator:</p> <p>it can apply some rate limiting at various points, protect the servers against overloading, adjust traffic priorities based on the contents, and even pass such information to lower layers and outer network components by marking packets.</p> <p>protection against DDoS and service abuse:</p> <p>it can maintain a wide number of statistics per IP address, URL, cookie, etc and detect when an abuse is happening, then take action (slow down the offenders, block them, send them to outdated contents, etc)</p> <p>observation point for network troubleshooting:</p> <p>due to the precision of the information reported in logs, it is often used to narrow down some network-related issues.</p> <p>HTTP compression offloader:</p> <p>it can compress responses which were not compressed by the server, thus reducing the page load time for clients with poor connectivity or using high-latency, mobile networks.</p> <p>caching proxy:</p> <p>Please note that this caching feature is designed to be maintenance free and focuses solely on saving haproxy's precious resources and not on save the server's resources.</p> <p>FastCGI gateway:</p> <p>FastCGI can be seen as a different representation of HTTP</p> <ul><li>process incoming connections;</li> <li>periodically check the servers' status (known as health checks);</li> <li>exchange information with other haproxy nodes.</li></ul> <div class="language- extra-class"><pre class="language-text"><code>  - accept incoming connections from listening sockets that belong to a
    configuration entity known as a &quot;frontend&quot;, which references one or multiple
    listening addresses;

  - apply the frontend-specific processing rules to these connections that may
    result in blocking them, modifying some headers, or intercepting them to
    execute some internal applets such as the statistics page or the CLI;

  - pass these incoming connections to another configuration entity representing
    a server farm known as a &quot;backend&quot;, which contains the list of servers and
    the load balancing strategy for this server farm;

  - apply the backend-specific processing rules to these connections;

  - decide which server to forward the connection to according to the load
    balancing strategy;

  - apply the backend-specific processing rules to the response data;

  - apply the frontend-specific processing rules to the response data;

  - emit a log to report what happened in fine details;

  - in HTTP, loop back to the second step to wait for a new request, otherwise
    close the connection.
</code></pre></div><h2 id="_2-management"><a href="#_2-management" class="header-anchor">#</a> 2. management</h2> <p>https://cbonte.github.io/haproxy-dconv/2.3/management.html</p> <p>how to start haproxy, how to manage it at runtime, how to manage it on multiple nodes, and how to proceed with seamless upgrades</p> <h3 id="_2-1-install"><a href="#_2-1-install" class="header-anchor">#</a> 2.1 install</h3> <div class="language- extra-class"><pre class="language-text"><code>-------------------------------------------------------------
--- step 1: dependencies::
-------------------------------------------------------------
yum install openssl-devel pcre-devel zlib-devel

-------------------------------------------------------------
--- step 2: make install
-------------------------------------------------------------
wget https://www.haproxy.org/download/2.2/src/haproxy-2.2.1.tar.gz
tar zxvf haproxy-2.2.1.tar.gz

cd haproxy-2.2.1
# uname -r
# 3.10.0-327.el7.x86_64
# make TARGET=linux2628 USE_PCRE=1 USE_OPENSSL=1 USE_ZLIB=1 USE_LIBCRYPT=1
make target=linux31 failed!
make TARGET=linux2628 removed from haproxy
make TARGET=linux-glibc

/*
make install
cp -R /usr/local/sbin/haproxy /usr/sbin
make install PREFIX=/usr/local/haproxy
*/

$make install	#默认会安装到 /usr/local/sbin下面
‘haproxy’ -&gt; ‘/usr/local/sbin/haproxy’
‘doc/haproxy.1’ -&gt; ‘/usr/local/share/man/man1/haproxy.1’
install: creating directory ‘/usr/local/doc’
install: creating directory ‘/usr/local/doc/haproxy’
‘doc/configuration.txt’ -&gt; ‘/usr/local/doc/haproxy/configuration.txt’
‘doc/management.txt’ -&gt; ‘/usr/local/doc/haproxy/management.txt’
‘doc/seamless_reload.txt’ -&gt; ‘/usr/local/doc/haproxy/seamless_reload.txt’
‘doc/architecture.txt’ -&gt; ‘/usr/local/doc/haproxy/architecture.txt’
‘doc/peers-v2.0.txt’ -&gt; ‘/usr/local/doc/haproxy/peers-v2.0.txt’
‘doc/regression-testing.txt’ -&gt; ‘/usr/local/doc/haproxy/regression-testing.txt’
‘doc/cookie-options.txt’ -&gt; ‘/usr/local/doc/haproxy/cookie-options.txt’
‘doc/lua.txt’ -&gt; ‘/usr/local/doc/haproxy/lua.txt’
‘doc/WURFL-device-detection.txt’ -&gt; ‘/usr/local/doc/haproxy/WURFL-device-detection.txt’
‘doc/proxy-protocol.txt’ -&gt; ‘/usr/local/doc/haproxy/proxy-protocol.txt’
‘doc/linux-syn-cookies.txt’ -&gt; ‘/usr/local/doc/haproxy/linux-syn-cookies.txt’
‘doc/SOCKS4.protocol.txt’ -&gt; ‘/usr/local/doc/haproxy/SOCKS4.protocol.txt’
‘doc/network-namespaces.txt’ -&gt; ‘/usr/local/doc/haproxy/network-namespaces.txt’
‘doc/DeviceAtlas-device-detection.txt’ -&gt; ‘/usr/local/doc/haproxy/DeviceAtlas-device-detection.txt’
‘doc/51Degrees-device-detection.txt’ -&gt; ‘/usr/local/doc/haproxy/51Degrees-device-detection.txt’
‘doc/netscaler-client-ip-insertion-protocol.txt’ -&gt; ‘/usr/local/doc/haproxy/netscaler-client-ip-insertion-protocol.txt’
‘doc/peers.txt’ -&gt; ‘/usr/local/doc/haproxy/peers.txt’
‘doc/close-options.txt’ -&gt; ‘/usr/local/doc/haproxy/close-options.txt’
‘doc/SPOE.txt’ -&gt; ‘/usr/local/doc/haproxy/SPOE.txt’
‘doc/intro.txt’ -&gt; ‘/usr/local/doc/haproxy/intro.txt’

-------------------------------------------------------------
--- step 3: Configuraiton
-------------------------------------------------------------
mkdir -p /etc/haproxy
cp -R examples/option-http_proxy.cfg /etc/haproxy/haproxy.cfg
vim /etc/haproxy/haproxy.cfg
	global
        maxconn         20000
        ulimit-n        16384
        log             127.0.0.1 local0
        uid             99
        gid             99
        chroot          /var/empty
        nbproc          4
        daemon
    listen test_nginx
        bind    0.0.0.0:82
        mode    http
        server A 127.0.0.1:80
	listen stats
        bind    0.0.0.0:1080
        mode    http
        maxconn 10
        stats refresh 30s
        stats uri /stats
	
frontend http-in
 bind *:80
 default_backend appZ-backend
backend appZ-backend
 balance roundrobin
 server appZ_01 IP_OF_MACHINE_01:8080 check
 server appZ_02 IP_OF_MACHINE_02:8080 check
 

-------------------------------------------------------------
--- step 4: 配置脚本启动与关闭haproxy
-------------------------------------------------------------
cp -R examples/haproxy.init /etc/init.d/haproxy
chmod +x /etc/init.d/haproxy
chkconfig --add haproxy ！刚开始我漏了这一步，所以造成后面的问题
vi /etc/rc.d/init.d/haproxy  #这里需要把BIN的值替换为BIN=haproxy安装目录/sbin/$BASENAME
	BIN=/usr/local/sbin/$BASENAME

启动 service haproxy start
关闭 service haproxy stop
重启 service haproxy restart

● haproxy.service - SYSV: HA-Proxy is a TCP/HTTP reverse proxy which is particularly suited for high availability environments.
   Loaded: loaded (/etc/rc.d/init.d/haproxy)
   Active: failed (Result: exit-code) since Tue 2020-07-28 19:52:56 SGT; 13min ago
     Docs: man:systemd-sysv-generator(8)

Jul 28 19:52:56 vm2-devclr-v08 haproxy[13682]: Errors found in configuration file, check it with 'haproxy check'.
Jul 28 19:52:56 vm2-devclr-v08 systemd[1]: haproxy.service: control process exited, code=exited status=1
Jul 28 19:52:56 vm2-devclr-v08 systemd[1]: Failed to start SYSV: HA-Proxy is a TCP/HTTP reverse proxy which is particularly suited for high availability environments..
Jul 28 19:52:56 vm2-devclr-v08 systemd[1]: Unit haproxy.service entered failed state.
Jul 28 19:52:56 vm2-devclr-v08 systemd[1]: haproxy.service failed.

/usr/local/sbin/haproxy -c -- /etc/haproxy/haproxy.cfg
检查无问题
/usr/local/sbin/haproxy -- /etc/haproxy/haproxy.cfg
试着启动无问题，测试也无问题，但是无法用systemctl控制启动停止
 killall haproxy
 
发现需要 
chkconfig --add haproxy
就可以通过systemctl启动和停止

启动后可通过http://ip:1080/stats页面查看

$find / -name &quot;haproxy&quot;
/run/lock/subsys/haproxy
/var/log/haproxy
/etc/rc.d/init.d/haproxy
/etc/haproxy
/usr/local/sbin/haproxy
/usr/local/doc/haproxy
/opt/haproxy-2.2.1/include/haproxy
/opt/haproxy-2.2.1/haproxy

https://blog.csdn.net/demon7639/article/details/76234306
https://blog.csdn.net/qq_28710983/article/details/82194404
</code></pre></div><p>haproxy集群技巧</p> <div class="language- extra-class"><pre class="language-text"><code> $ cat site1.env
  LISTEN=192.168.1.1
  CACHE_PFX=192.168.11
  SERVER_PFX=192.168.22
  LOGGER=192.168.33.1
  STATSLP=admin:pa$$w0rd
  ABUSERS=/etc/haproxy/abuse.lst
  TIMEOUT=10s

  $ cat haproxy.cfg
  global
      log &quot;${LOGGER}:514&quot; local0

  defaults
      mode http
      timeout client &quot;${TIMEOUT}&quot;
      timeout server &quot;${TIMEOUT}&quot;
      timeout connect 5s

  frontend public
      bind &quot;${LISTEN}:80&quot;
      http-request reject if { src -f &quot;${ABUSERS}&quot; }
      stats uri /stats
      stats auth &quot;${STATSLP}&quot;
      use_backend cache if { path_end .jpg .css .ico }
      default_backend server

  backend cache
      server cache1 &quot;${CACHE_PFX}.1:18080&quot; check
      server cache2 &quot;${CACHE_PFX}.2:18080&quot; check

  backend server
      server cache1 &quot;${SERVER_PFX}.1:8080&quot; check
      server cache2 &quot;${SERVER_PFX}.2:8080&quot; check
</code></pre></div><h3 id="_2-2-logging"><a href="#_2-2-logging" class="header-anchor">#</a> 2.2 Logging</h3> <p>https://cbonte.github.io/haproxy-dconv/2.3/management.html#8</p> <p>首先 为什么haproxy不能自己写log，要通过udp发送给linux系统自带的rsyslog，是因为安全考虑，haproxy的jail模式无法访问文件系统</p> <p>/etc下面没有找到syslog或sysklogd，找到了rsyslog，而且确实看到有这个rsyslog在运行：</p> <p>systemctl status rsyslog，根据文档修改配置（注意并没有给UDPServerAddress *）</p> <div class="language- extra-class"><pre class="language-text"><code>mkdir -p /var/log/haproxy
chmod a+w /var/log/haproxy

#对于本机来说不需要设置，如果是作为中央日志服务器则需要！
vim /etc/sysconfig/rsyslog 
SYSLOGD_OPTIONS=&quot;-r -m 0 -c 2&quot;	# “-r”选项以允许接受外来日志消息,-m 0表示给日志添加-- MARK --标记，0表示关闭标记。举例，-m 240，表示每隔240分钟（每天6次）在日志文件里增加一行时间戳消息。日志文件里的“--MARK--”消息可以让你知道中央日志服务器上的syslog守护进程没有停工偷懒。

vim /etc/rsyslog.conf
$ModLoad imudp
$UDPServerRun 514
....
#save haproxy log
local0.*                                                /var/log/haproxy/haproxy.log

对应到前面/etc/haproxy/haproxy.cfg配置的global：
log             127.0.0.1 local0
其他地方直接用log global引用即可

$systemctl restart rsyslog
</code></pre></div><p>haproxy提供了一个小工具halog，需要单独安装</p> <p>https://www.haproxy.com/support/technical-notes/an-0054-en-how-to-analyze-haproxy-logs-with-halog-tool/</p> <h3 id="_2-3-utilities-调试工具"><a href="#_2-3-utilities-调试工具" class="header-anchor">#</a> 2.3 utilities 调试工具</h3> <p>Most of the time it runs as a single process, so the output of &quot;ps aux&quot; on a system will report only one &quot;haproxy&quot; process, unless a soft reload is in progress and an older process is finishing its job in parallel to the new one. It is thus always easy to trace its activity using the strace utility.</p> <h4 id="_2-3-1-socat管理haproxy以及haproxy调优"><a href="#_2-3-1-socat管理haproxy以及haproxy调优" class="header-anchor">#</a> 2.3.1 socat管理haproxy以及haproxy调优</h4> <p>https://cbonte.github.io/haproxy-dconv/2.3/management.html#9.3</p> <p>https://www.cnblogs.com/nmap/p/6498224.html</p> <h5 id="unix-socket-socat"><a href="#unix-socket-socat" class="header-anchor">#</a> Unix socket &amp; socat</h5> <blockquote><p>socat是一个多功能的网络工具，名字来由是“Socket CAT”，可以看作是netcat的N倍加强版，socat的官方网站：http://www.dest-unreach.org/socat/ 。
socat是一个两个独立数据通道之间的双向数据传输的继电器。
这些数据通道包含文件、管道、设备（终端或调制解调器等）、插座（Unix，IP4，IP6 - raw，UDP，TCP）、SSL、SOCKS4客户端或代理CONNECT。
socat支持广播和多播、抽象Unix sockets、Linux tun/tap、GNU readline和PTY。
它提供了分叉、记录和进程间通信的不同模式。多个选项可用于调整socat和其渠道，Socat可以作为TCP中继（一次性或守护进程），作为一个守护进程基于socksifier，
作为一个shell Unix套接字接口，作为IP6的继电器，或面向TCP的程序重定向到一个串行线。
socat的主要特点就是在两个数据流之间建立通道；且支持众多协议和链接方式：ip, tcp, udp, ipv6, pipe,exec,system,open,proxy,openssl,socket等。</p> <p>https://www.cnblogs.com/nmap/p/6498224.html</p></blockquote> <p>使用socat可以查看和设置HAProxy状态，首先得让HAProxy产生出一个sock出来(hatop ，socat都是基于这个的，没这个什么都做不了)。
设置配置文件开启unix socket
在global 下面 加一行：
stats socket /usr/local/haproxy/stats #路径和名字随意
然后重启服务就可以了。</p> <div class="language- extra-class"><pre class="language-text"><code>

global
        stats socket /var/run/haproxy.sock mode 600 level admin
        stats timeout 2m
        
查看有没有生成socket
ls /var/lib/haproxy/


To access the socket, an external utility such as &quot;socat&quot; is required. Socat is
a swiss-army knife to connect anything to anything. We use it to connect
terminals to the socket, or a couple of stdin/stdout pipes to it for scripts.
The two main syntaxes we'll use are the following :

    # socat /var/run/haproxy.sock stdio
    # socat /var/run/haproxy.sock readline

The first one is used with scripts. It is possible to send the output of a
script to haproxy, and pass haproxy's output to another script. That's useful
for retrieving counters or attack traces for example.

The second one is only useful for issuing commands by hand. It has the benefit
that the terminal is handled by the readline library which supports line
editing and history, which is very convenient when issuing repeated commands
(eg: watch a counter).

when debugging by hand, it's quite common to start with the
&quot;prompt&quot; command :

   # socat /var/run/haproxy readline
   prompt
   &gt; show info
   
通过socat和socket通信，它是cocket cat的缩写，安装
 yum install -y socat
利用管道查看帮助命令
echo &quot;help&quot; | socat stdio /var/lib/haproxy/haproxy.sock
echo &quot;show info&quot; | socat stdio /var/lib/haproxy/haproxy.sock

通过disable或者enable可以关闭或者启动某台主机
echo &quot;disable server http_back/linux-node2&quot; | socat stdio /var/lib/haproxy/haproxy.sock
echo &quot;enable server http_back/linux-node2&quot; | socat stdio /var/lib/haproxy/haproxy.sock

haproxy调优的地方
1、不设置进程，默认就是1，单进程
2、网卡可能跑慢，换成万兆网卡，或者拆业务，拆成不同集群
3、haproxy的端口可能被用光，因为linux提供端口最多65535。

改local的端口范围。
cat /proc/sys/net/ipv4/ip_local_port_range
改tcp的tw端口的复用，启用reuse，禁用recycle，改成1　
cat /proc/sys/net/ipv4/tcp_tw_reuse
可以缩短tw的时间，默认是60秒。
cat /proc/sys/net/ipv4/tcp_fin_timeout
使用多个IP
</code></pre></div><h5 id="master-cli"><a href="#master-cli" class="header-anchor">#</a> Master CLI</h5> <p>The master CLI is a socket bound to the master process in master-worker mode. This CLI gives access to the unix socket commands in every running or leaving processes and allows a basic supervision of those processes.</p> <div class="language- extra-class"><pre class="language-text"><code># haproxy -W -S 127.0.0.1:1234 -f test1.cfg
# haproxy -Ws -S /tmp/master-socket,uid,1000,gid,1000,mode,600 -f test1.cfg
# haproxy -W -S /tmp/master-socket,level,user -f test1.cfg

echo &amp;#x27;show proc' | socat /var/run/haproxy-master.sock -

socat /var/run/haproxy-master.sock readline
prompt
master&gt; @1 show info; @2 show info
master&gt; @1
1271&gt; show info
[...]
1271&gt; show stat
[...]
</code></pre></div><h4 id="_2-3-2-tcpdump-strace"><a href="#_2-3-2-tcpdump-strace" class="header-anchor">#</a> 2.3.2 tcpdump &amp; strace</h4> <p>https://cbonte.github.io/haproxy-dconv/2.3/management.html#12</p> <div class="language- extra-class"><pre class="language-text"><code>tcpdump sample:
run tcpdump to watch for port 514, for example on the loopback interface if
    the traffic is being sent locally : &quot;tcpdump -As0 -ni lo port 514&quot;. If the
    packets are seen there, it's the proof they're sent then the syslogd daemon
    needs to be troubleshooted.

strace sample:
run &quot;strace -tt -s100 -etrace=sendmsg -p &lt;haproxy's pid&gt;&quot; 

When debugging some latency issues, it is important to use both strace and
tcpdump on the local machine, and another tcpdump on the remote system. The
reason for this is that there are delays everywhere in the processing chain and
it is important to know which one is causing latency to know where to act. In
practice, the local tcpdump will indicate when the input data come in. Strace
will indicate when haproxy receives these data (using recv/recvfrom). Warning,
openssl uses read()/write() syscalls instead of recv()/send(). Strace will also
show when haproxy sends the data, and tcpdump will show when the system sends
these data to the interface. Then the external tcpdump will show when the data
sent are really received (since the local one only shows when the packets are
queued). The benefit of sniffing on the local system is that strace and tcpdump
will use the same reference clock. Strace should be used with &quot;-tts200&quot; to get
complete timestamps and report large enough chunks of data to read them.
Tcpdump should be used with &quot;-nvvttSs0&quot; to report full packets, real sequence
numbers and complete timestamps.

</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>haproxy -vv

haproxy -f /etc/haproxy.cfg \
           -D -p /var/run/haproxy.pid -sf $(cat /var/run/haproxy.pid)
           
strace -tt -s100 -etrace=sendmsg -p &lt;haproxy's pid&gt;

echo &quot;show info&quot; | socat - /var/run/haproxy.sock | grep ^Idle
</code></pre></div><h2 id="_3-configuration"><a href="#_3-configuration" class="header-anchor">#</a> 3. configuration</h2> <p>https://cbonte.github.io/haproxy-dconv/2.3/configuration.html</p> <h3 id="安全设置"><a href="#安全设置" class="header-anchor">#</a> 安全设置</h3> <p>涉及到linux的chroot：修改haproxy的工作目录至指定的目录并在放弃权限之前执行chroot()操作,可以提升haproxy的安全级别，不过需要注意的是要确保指定的目录为空目录且任何用户均不能有写权限</p> <blockquote><p>HAProxy is designed to run with very limited privileges. The standard way to use it is to isolate it into a chroot jail and to drop its privileges to a non-root user without any permissions inside this jail so that if any future vulnerability were to be discovered, its compromise would not affect the rest of the system.</p></blockquote> <blockquote><p>In order to perform a chroot, it first needs to be started as a root user. It is pointless to build hand-made chroots to start the process there, these ones are painful to build, are never properly maintained and always contain way more bugs than the main file-system. And in case of compromise, the intruder can use the purposely built file-system. <strong>Unfortunately many administrators confuse &quot;start as root&quot; and &quot;run as root&quot;, resulting in the uid change to be done prior to starting haproxy, and reducing the effective security restrictions.</strong> ？？这段话没有搞懂</p></blockquote> <p>https://stackoverflow.com/questions/63150374/please-help-explain-the-haproxy-statment-unfortunately-many-administrators-conf</p> <p>但是细品下面接着的两段话</p> <div class="language- extra-class"><pre class="language-text"><code>HAProxy will need to be started as root in order to :
  - adjust the file descriptor limits
  - bind to privileged port numbers
  - bind to a specific network interface
  - transparently listen to a foreign address
  - isolate itself inside the chroot jail
  - drop to another non-privileged UID

HAProxy may require to be run as root in order to :
  - bind to an interface for outgoing connections
  - bind to privileged source ports for outgoing connections
  - transparently bind to a foreign address for outgoing connections
</code></pre></div><p>可以看到start as root应该就是我们在Configuration里面指定好uid比如99 nobody，然后用root用户启动sytemctl start haproxy或者</p> <p>/usr/sbin/haproxy -D -f /etc/haproxy/haproxy.cfg，然后haproxy程序就会做下面一系列事情，比如：</p> <p>bind to privileged port numbers 绑定低于1024的端口。。。。进一步将其放入监狱jail，即根据chroot配置调用chroot，直到drop to another non-privileged UID就是降级我们指定的99 nobody，降级的原理就是根据配置的uid，然后系统调用setuid，最后就会看到haproxy的owner就是nobody这个用户；</p> <p>而run as root有什么用呢，首先bind to privileged source ports for outgoing connections 这个就是鸡肋，意思是当haproxy连接后台服务的时候，其作为客户端的源端口可以使用低于1024的端口，但是实际情况下，我们都不会关心一个客户端使用什么端口，我们写代码也只关心destination或者服务器的端口，至于其他两个，看起来也貌似没有用</p> <p>至于resulting in the uid change to be done prior to starting haproxy，首先start as root前面说了是root启动，然后降级成普通用户，所以是'uid change' after starting haproxy, 而run as root，不去配置uid，则不会降级，也不会有uid change，怎么又会prior to starting haproxy？这个暂时不深究</p> <div class="language- extra-class"><pre class="language-text"><code>A safe configuration will have :

  - a chroot statement pointing to an empty location without any access
    permissions. This can be prepared this way on the UNIX command line :

      # mkdir /var/empty &amp;&amp; chmod 0 /var/empty || echo &quot;Failed&quot;

    and referenced like this in the HAProxy configuration's global section :

      chroot /var/empty

  - both a uid/user and gid/group statements in the global section :

      user haproxy
      group haproxy

  - a stats socket whose mode, uid and gid are set to match the user and/or
    group allowed to access the CLI so that nobody may access it :

      stats socket /var/run/haproxy.stat uid hatop gid hatop mode 600
      
前面的配置中我们用了默认的linux nobody用户(id nobody)
uid 99
gid 99
当然也可以根据这里的建议创建haproxy用户
useradd haproxy -r -s /sbin/nologin 
getent passwd  haproxy
id haproxy
注意配置可以用uid gid也可以用user group

</code></pre></div><blockquote><div class="language- extra-class"><pre class="language-text"><code>insecure-setuid-wanted
HAProxy doesn't need to call executables at run time (except when using
external checks which are strongly recommended against), and is even expected
to isolate itself into an empty chroot. As such, there basically is no valid
reason to allow a setuid executable to be called without the user being fully
aware of the risks. In a situation where haproxy would need to call external
checks and/or disable chroot, exploiting a vulnerability in a library or in
haproxy itself could lead to the execution of an external program. On Linux
it is possible to lock the process so that any setuid bit present on such an
executable is ignored. This significantly reduces the risk of privilege
escalation in such a situation. This is what haproxy does by default. In case
this causes a problem to an external check (for example one which would need
the &quot;ping&quot; command), then it is possible to disable this protection by
explicitly adding this directive in the global section. If enabled, it is
possible to turn it back off by prefixing it with the &quot;no&quot; keyword.
</code></pre></div><p>https://cbonte.github.io/haproxy-dconv/2.2/configuration.html#insecure-setuid-wanted</p></blockquote> <blockquote><div class="language- extra-class"><pre class="language-text"><code>BEFORE THE PATCH:
=================

# rpm -q haproxy
haproxy-1.4.22-3.el6.x86_64

# service haproxy start
Starting haproxy: [  OK  ]

# ps axf -o pid,user,group,command | grep hapr
 4661 root     root              \_ grep hapr
 4602 haproxy  haproxy  /usr/sbin/haproxy -D -f /etc/haproxy/haproxy.cfg -p /var/run/haproxy.pid
# grep Group /proc/4602/status 
Groups: 0 


AFTER THE PATCH:
================

# rpm -q haproxy
haproxy-1.4.24-2.el6.x86_64

# service haproxy start
Starting haproxy: [  OK  ]

# ps a -o pid,user,group,command | grep haproxy
 1196 root     root     grep hapr
31712 haproxy  haproxy  haproxy -f /etc/haproxy/haproxy.cfg -d -V

# grep Group /proc/31712/status
Groups:
</code></pre></div><p>https://bugzilla.redhat.com/show_bug.cgi?id=903303</p></blockquote> <blockquote><p>chroot happens after bind, you need to:
bind to <code>/var/emtpy/var/run/haproxy.sock</code></p> <p>https://discourse.haproxy.org/t/trying-to-run-haproxy-as-non-root-not-working/3906/3</p></blockquote> <p>http://www.dscentral.in/2012/11/04/installing-haproxy-on-pfsense/</p> <h2 id="coding-style"><a href="#coding-style" class="header-anchor">#</a> coding-style</h2> <h2 id="proxy-protocol"><a href="#proxy-protocol" class="header-anchor">#</a> proxy-protocol</h2> <h2 id="一些问题"><a href="#一些问题" class="header-anchor">#</a> 一些问题</h2> <p>session问题：</p> <p>https://blog.csdn.net/weixin_45537987/article/details/106759391</p> <p>Gitlab behind Haproxy(SSL)</p> <p>https://serverfault.com/questions/820114/gitlab-behind-haproxyssl</p> <h2 id="国内是如何使用的"><a href="#国内是如何使用的" class="header-anchor">#</a> 国内是如何使用的</h2> <p>https://www.cnblogs.com/hanshanxiaoheshang/p/10285962.html</p> <div id="disqus_thread"></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/docs/assets/js/app.f3b5d2d6.js" defer></script><script src="/docs/assets/js/2.d450803a.js" defer></script><script src="/docs/assets/js/184.a6c0fbe9.js" defer></script><script src="/docs/assets/js/7.be017326.js" defer></script>
  </body>
</html>
