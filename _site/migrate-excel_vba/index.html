<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.15.2 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Excel &amp; VBA - LIU YUE’S - NOTES TO SHARE</title>
<meta name="description" content="tips: copy and paste as value/formula/transpose(row to column, column to row)">



<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="LIU YUE'S - NOTES TO SHARE">
<meta property="og:title" content="Excel &amp; VBA">
<meta property="og:url" content="http://localhost:4000/migrate-excel_vba/">


  <meta property="og:description" content="tips: copy and paste as value/formula/transpose(row to column, column to row)">







  <meta property="article:published_time" content="2019-01-01T00:00:00+08:00">






<link rel="canonical" href="http://localhost:4000/migrate-excel_vba/">













<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="LIU YUE'S - NOTES TO SHARE Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE ]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">LIU YUE'S - NOTES TO SHARE</a>
        <ul class="visible-links"></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      

      
        <img src="/content/images/common/liuyue.jpg" alt="LIU YUE" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">LIU YUE</h3>
    
    
      <p class="author__bio" itemprop="description">
        古萧龙城好青年:wechat:lyhistory; Born in XiaoXian County,Anhui China; Bachelor in cst XMU, Master in se NUS; Enneagram Type 5;
      </p>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      
        
          
            <li><a href="mailto:lyhistory@gmail.com" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i> Email</a></li>
          
        
          
            <li><a href="https://twitter.com/lyhistory" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
          
        
          
            <li><a href="https://github.com/lyhistory" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Excel &amp; VBA">
    <meta itemprop="description" content="tips: copy and paste as value/formula/transpose(row to column, column to row)">
    <meta itemprop="datePublished" content="January 01, 2019">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Excel &amp; VBA
</h1>
          
            <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  2 minute read
</p>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
        <p>tips: copy and paste as value/formula/transpose(row to column, column to row)</p>

<p>Sheet and cell: =Sheet1!$A$2:$A$8</p>

<h3 id="1how-to-convert-column-list-to-comma-separated-list-in-excel">1.How to convert column list to comma separated list in Excel?</h3>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Sub ChangeRange()
'Updateby20140310
Dim rng As Range
Dim InputRng As Range, OutRng As Range
xTitleId = "KutoolsforExcel"
Set InputRng = Application.Selection
Set InputRng = Application.InputBox("Range :", xTitleId, InputRng.Address, Type:=8)
Set OutRng = Application.InputBox("Out put to (single cell):", xTitleId, Type:=8)
outStr = ""
For Each rng In InputRng
If outStr = "" Then
outStr = rng.Value
Else
outStr = outStr &amp; "," &amp; rng.Value
End If
Next
OutRng.Value = outStr
End Sub
</code></pre></div></div>
<p>–https://www.extendoffice.com/documents/excel/1544-excel-convert-column-to-comma-separated-list.html
 </p>
<h3 id="2how-to-quickly-apply-formula-to-an-entire-column-or-row-withwithout-dragging-in-excel">2.How to quickly apply formula to an entire column or row with/without dragging in Excel?</h3>
<p>here I recommend copy the formula and then select a starting cell and scroll to the last cell you want to apply and hold down shift+select the last cell, paste,
because for excel’s nature of infinite scrolling in vertical direction, if you do fill down to apply formula, it may apply to lots of empty cells you don’t want to apply to, that will cost high memory usage, and in some case excel may get crashed.
 
https://www.extendoffice.com/documents/excel/867-excel-apply-formula-to-entire-column-row.html
How to remove prefix / suffix from multiple cells in Excel?
https://www.extendoffice.com/documents/excel/2915-excel-remove-prefix-suffix.html
 </p>
<h3 id="3use-autosum-to-sum-numbers">3.Use AutoSum to sum numbers</h3>
<p>https://support.office.com/en-us/article/Use-AutoSum-to-sum-numbers-543941e7-e783-44ef-8317-7d1bb85fe706
 </p>
<h3 id="4find-mismatch-value-comparing-two-column">4.Find mismatch value comparing two column</h3>
<p>IF(ISERROR(MATCH(E2,$C$2:$C$13363,0)),”na”,E2)</p>

<h3 id="5sumif">5.SumIF</h3>
<p>https://support.office.com/en-us/article/SUMIF-function-169b8c99-c05c-4483-a712-1697a653039b
 </p>
<h3 id="6-vlookup">6. Vlookup</h3>
<p>https://www.timeatlas.com/vlookup-tutorial/
 </p>
<h3 id="7-match-index">7. Match Index</h3>
<p>quickly find corresponding values based on comparing the other columns.
=INDEX($F$2:$F$100,MATCH(C2,$E$2:$E$100,0))
http://www.excel-university.com/how-to-return-a-value-left-of-vlookups-lookup-column/
 </p>
<h3 id="8transposeconvert-multi-column-to-single-column">8.Transpose/convert multi column to single column</h3>
<p>https://www.extendoffice.com/documents/excel/1172-excel-transpose-multiple-columns-into-one-column.html
column to table: http://www.cpearson.com/EXCEL/ColumnToTable.aspx
 </p>
<h3 id="9charts">9.Charts</h3>
<p>Scatter Chart - Format Data Label - Label options - select Range
 
SUMIF
How to use SUMIF in Excel - formula examples to conditionally sum cells https://www.ablebits.com/office-addins-blog/2014/11/04/excel-sumif-function-formula-examples/
https://www.techonthenet.com/excel/formulas/sumif.php
https://support.microsoft.com/en-us/help/260415/sumif,-countif-and-countblank-functions-return-value-error
 </p>
<h3 id="10-group-and-subtotal">10. Group and Subtotal</h3>
<p>Data-&gt; subtotal
https://www.gcflearnfree.org/print/excel2013/groups-and-subtotals?playlist=Excel_2013
 </p>
<h3 id="11-value-long-number-string-or-date-time-as-text">11. value (long number string or date time) as Text</h3>
<p>method 1: import as csv, select the column, change the type to text
method 2: Text()
https://www.extendoffice.com/documents/excel/2476-excel-convert-date-to-text-or-number.html
 </p>
<h3 id="12-group-by-sum">12 group by sum</h3>
<p>https://www.extendoffice.com/documents/excel/4970-excel-sum-by-group.html
=IF(A2=A1,”“,SUMIF(A:A,A2,B:B)), (A2 is the relative cell you want to sum based on, A1 is the column header, A:A is the column you want to sum based on, the B:B is the column you want to sum the values.) Press Enter key, drag fill handle down to the cells to fill the formula.</p>

<h2 id="problems">problems:</h2>
<h4 id="to-prevent-possible-loss-of-data-excel-cannot-shift-non-blank-cells-off-of-the-worksheet">to prevent possible loss of data excel cannot shift non-blank cells off of the worksheet</h4>
<p>remove the formats
 </p>
<h4 id="before-copy-paste-make-sure-that-you-want-to-copy-the-function-or-value-only-otherwise-excel-by-default-will-apply-functions-if-you-have-to-all-cells-you-paste-to-that-will-cost-much-longer-time-and-more-memory">before copy paste, make sure that you want to copy the function or value only, otherwise excel by default will apply functions if you have to all cells you paste to, that will cost much longer time and more memory</h4>
<p> </p>
<h4 id="stop-excel-converting-the-value">stop excel converting the value</h4>
<p>1). Change the file extension from .csv to .dif
2). Double click on the file to open it in Excel.
3). The ‘File Import Wizard’ will be launched.
4). Set the ‘File type’ to ‘Delimited’ and click on the ‘Next’ button.
5). Under Delimiters, tick ‘Comma’ and click on the ‘Next’ button.
6). Click on each column of your data that is displayed and select a ‘Column data format’. The column with the numeric value should be formatted as ‘Text’.
7). Click on the finish button, the file will be opened by Excel with the formats that you have specified.
http://stackoverflow.com/questions/137359/excel-csv-number-cell-format</p>

<h4 id="whitespace-trim-not-work-">whitespace, trim not work ?</h4>
<p> Substitute(A1,char(160),””)
remove stubborn spaces and characters in a cell
https://www.sageintelligence.com/tips-and-tricks/excel-tips-tricks/2014/07/remove-stubborn-spaces-cell/
 
DATA-&gt;Text to Columns
 
ref:
https://blogs.office.com/excel/
 
Used Script:
IF(ISERROR(MATCH(E2,$C$2:$C$13363,0)),”na”,E2)
=INDEX($f$2:$f$120,MATCH(A2,$e$2:$e$120,0))
INDEX($J$2:$J$239,MATCH(A2,$I$2:$I$239,0))
CONCATENATE(“exec somefunction(‘“,A2,”’,”,(0-F2),”,”,C2,”);”)
=LEFT(A3,LEN(A3)-6)</p>

        
      </section>

      <footer class="page__meta">
        
        


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2019-01-01T00:00:00+08:00">January 01, 2019</time></p>
        
      </footer>

      <section class="page__share">
  

  <a href="https://twitter.com/intent/tweet?text=Excel+%26+VBA%20http%3A%2F%2Flocalhost%3A4000%2Fmigrate-excel_vba%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2Fmigrate-excel_vba%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://plus.google.com/share?url=http%3A%2F%2Flocalhost%3A4000%2Fmigrate-excel_vba%2F" class="btn btn--google-plus" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Google Plus"><i class="fab fa-fw fa-google-plus" aria-hidden="true"></i><span> Google+</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2Fmigrate-excel_vba%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/migrate-confucius/" class="pagination--pager" title="孔子 – 大學之道 CONFUCIUS – The Way of Ultimate Wisdom
">Previous</a>
    
    
      <a href="/migrate-gsuite/" class="pagination--pager" title="G Suite walk-through
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You May Also Enjoy</h4>
      <div class="grid__wrapper">
        
          
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/arp/" rel="permalink">troubleshooting intranet access issue raised by wrong arp
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  1 minute read
</p>
    
    <p class="archive__item-excerpt" itemprop="description">I got an issue access the shared folder on the other pc in the same intranet at home, actually it was working fine a few days ago.
both pc are win10 os.

</p>
  </article>
</div>

        
          
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/mysql_replication/" rel="permalink">Mysql replication test between different version
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  less than 1 minute read
</p>
    
    <p class="archive__item-excerpt" itemprop="description">Master: mysql5.7

Slave: mysql8.0


</p>
  </article>
</div>

        
          
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/storm/" rel="permalink">Apache storm starter
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  2 minute read
</p>
    
    <p class="archive__item-excerpt" itemprop="description">run WordCountTopology in Local Mode and (Local) Cluster Mode
version: 1.2.2
env: vms centos7
example:https://github.com/apache/storm/blob/v1.2.2/examples/sto...</p>
  </article>
</div>

        
          
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/hdfs/" rel="permalink">[Hadoop ecosystem] Chapter 1: Data Storage: HDFS
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  less than 1 minute read
</p>
    
    <p class="archive__item-excerpt" itemprop="description">Hadoop ecosystem series…
</p>
  </article>
</div>

        
      </div>
    </div>
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form onsubmit="return googleCustomSearchExecute();" id="cse-search-box-form-id">
    <input type="text" id="cse-search-input-box-id" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
    </form>
    <div id="results" class="results">
        <gcse:searchresults-only></gcse:searchresults-only>    
    </div></div>

      </div>
    

    <div class="page__footer">
      <footer>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-9742852210287449",
    enable_page_level_ads: true
  });
</script>
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    
      
        
          <li><a href="https://alphawallet.com/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-university" aria-hidden="true"></i> AlphaWallet</a></li>
        
      
        
          <li><a href="https://developers.google.com/edu/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-google" aria-hidden="true"></i> Google Course</a></li>
        
      
        
          <li><a href="http://vouchain.one/" rel="nofollow noopener noreferrer"><i class="fas fa-link" aria-hidden="true"></i> other</a></li>
        
      
    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2019 LIU YUE'S - NOTES TO SHARE. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script data-search-pseudo-elements defer src="https://use.fontawesome.com/releases/v5.7.1/js/all.js" integrity="sha384-eVEQC9zshBn0rFj4+TU78eNA19HMNigMviK/PU/FFjLXqa/GKPgX58rvt5Z8PLs7" crossorigin="anonymous"></script>


<script>
  (function () {
    var cx = '016202475545879656962:ot3scpbjy9y';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();

  function googleCustomSearchExecute() {
    var input = document.getElementById('cse-search-input-box-id');
    var element = google.search.cse.element.getElement('searchresults-only0');
    if (input.value == '') {
      element.clearAllResults();
    } else {
      element.execute(input.value);
    }
    return false;
  }

  
    $(document).ready(function () {
      $('input#cse-search-input-box-id').on('keyup', function () {
        googleCustomSearchExecute();
      });
    });
  
</script>




    
  <script>
    var disqus_config = function () {
      this.page.url = "http://localhost:4000/migrate-excel_vba/";  // Replace PAGE_URL with your page's canonical URL variable
      this.page.identifier = "/migrate-excel_vba"; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    (function() { // DON'T EDIT BELOW THIS LINE
      var d = document, s = d.createElement('script');
      s.src = 'https://lyhistory.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


  



  </body>
</html>
