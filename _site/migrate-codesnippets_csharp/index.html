<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.15.2 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Code Snippets Series – C# - LIU YUE’S - NOTES TO SHARE</title>
<meta name="description" content="1.Test Task Async DeadLocks">



<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="LIU YUE'S - NOTES TO SHARE">
<meta property="og:title" content="Code Snippets Series – C#">
<meta property="og:url" content="http://localhost:4000/migrate-codesnippets_csharp/">


  <meta property="og:description" content="1.Test Task Async DeadLocks">







  <meta property="article:published_time" content="2019-01-01T00:00:00+08:00">






<link rel="canonical" href="http://localhost:4000/migrate-codesnippets_csharp/">













<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="LIU YUE'S - NOTES TO SHARE Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE ]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">LIU YUE'S - NOTES TO SHARE</a>
        <ul class="visible-links"></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      

      
        <img src="/content/images/common/liuyue.jpg" alt="LIU YUE" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">LIU YUE</h3>
    
    
      <p class="author__bio" itemprop="description">
        古萧龙城好青年:wechat:lyhistory; Born in XiaoXian County,Anhui China; Bachelor in cst XMU, Master in se NUS; Enneagram Type 5;
      </p>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      
        
          
            <li><a href="mailto:lyhistory@gmail.com" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i> Email</a></li>
          
        
          
            <li><a href="https://twitter.com/lyhistory" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
          
        
          
            <li><a href="https://github.com/lyhistory" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Code Snippets Series – C#">
    <meta itemprop="description" content="1.Test Task Async DeadLocks">
    <meta itemprop="datePublished" content="January 01, 2019">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Code Snippets Series – C#
</h1>
          
            <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  8 minute read
</p>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
        <h2 id="1test-task-async-deadlocks">1.Test Task Async DeadLocks</h2>

<p><a href="https://drive.google.com/folderview?id=0B5PbpyozmqqnfnQ3MTRHMktPWXlCb2J6VHFHT1Q5ZTFUMTJ5UkhMZ1Y2TUdnRkZKWDlPVEk&amp;usp=sharing">Demo Code</a>  (I am using winform app to demonstrate deadlocks which also happens on asp.net, but Console app don’t have such problem, even without calling Task.ConfigureAwait(false),codes that being ‘await’ will executed in new thread)</p>

<p>different between Task and Thread:</p>

<p>a.Task has return value (**Task.Result / **Task.GetAwaiter().GetResult())</p>

<p>b.Task run on created (Run/StartNew), Thread need Start after New</p>

<p>c.Task accept delegate/lamda, Thread accept object</p>

<p>d.Task can catch exception(after call <em>**Task.Wait() / **</em>Task.Result), Thread can not</p>

<p><a href="http://blogs.msdn.com/b/pfxteam/archive/2011/10/24/10229468.aspx">Task.Run vs Task.Factory.StartNew</a></p>

<p><a href="http://blog.stephencleary.com/2013/11/taskrun-etiquette-examples-dont-use.html">Task.Run Etiquette Examples: Don’t Use Task.Run in the Implementation</a></p>

<h2 id="2async-await">2.async await</h2>

<p><a href="https://msdn.microsoft.com/en-us/library/hh524395.aspx">Async Return Types</a></p>

<p>.Result and await block main Thread, ContinueWith doesn’t</p>

<p>await Task vs (Task&lt;T&gt; AsyncMethod).Result</p>

<p>async Task VS async Void  VS async Task&lt;T&gt;</p>

<p><a href="http://blog.stephencleary.com/2014/12/a-tour-of-task-part-6-results.html">A Tour of Task, Part 6: Results</a>  In short, await should be your go-to option for retrieving task results. The vast majority of the time, await should be used instead of Wait, Result, Exception, or GetAwaiter().GetResult().
<a href="http://stackoverflow.com/questions/24623120/await-on-a-completed-task-same-as-task-result">Await on a completed task same as task.Result?</a></p>

<p>warning: warning CS1998: This async method lacks ‘await’ operators and will run synchronously. Consider using the ‘await’ operator to await non-blocking API calls, or ‘await Task.Run(…)’ to do CPU-bound work on a background thread.</p>

<p>http://stackoverflow.com/questions/13243975/suppress-warning-cs1998-this-async-method-lacks-await</p>

<p>Error: An asynchronous operation cannot be started at this time. Asynchronous operations may only be started within an asynchronous handler or module or during certain events in the Page lifecycle. If this exception occurred while executing a Page, ensure that the Page is marked &lt;%@ Page Async=”true” %&gt;.</p>

<p>http://stackoverflow.com/questions/13647346/calling-async-method-in-controller</p>

<p>Error: DeadLocks</p>

<hr>
<p>Don’t Block on Async Code:
from http://blog.stephencleary.com/2012/07/dont-block-on-async-code.html</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// My "library" method.
public static async Task&lt;JObject&gt; GetJsonAsync(Uri uri)
{
using (var client = new HttpClient())
{
var jsonString = await client.GetStringAsync(uri);
return JObject.Parse(jsonString);
}
}
// My "top-level" method.
public void Button1_Click(...)
{
var jsonTask = GetJsonAsync(...);
textBox1.Text = jsonTask.Result;
}
</code></pre></div></div>
<p>The top-level method calls GetJsonAsync (within the UI/ASP.NET context).
GetJsonAsync starts the REST request by calling HttpClient.GetStringAsync (still within the context).
GetStringAsync returns an uncompleted Task, indicating the REST request is not complete.
GetJsonAsync awaits the Task returned by GetStringAsync. The context is captured and will be used to continue running the GetJsonAsync method later. GetJsonAsync returns an uncompleted Task, indicating that the GetJsonAsync method is not complete.
The top-level method synchronously blocks on the Task returned by GetJsonAsync. This blocks the context thread.
… Eventually, the REST request will complete. This completes the Task that was returned by GetStringAsync.
The continuation for GetJsonAsync is now ready to run, and it waits for the context to be available so it can execute in the context.
Deadlock. The top-level method is blocking the context thread, waiting for GetJsonAsync to complete, and GetJsonAsync is waiting for the context to be free so it can complete.</p>

<p>Preventing the Deadlock</p>

<p>There are two best practices (both covered in my intro post) that avoid this situation:</p>

<p>In your “library” async methods, use ConfigureAwait(false) wherever possible.
Don’t block on Tasks; use async all the way down.</p>

<p>Consider the first best practice. The new “library” method looks like this:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public static async Task&lt;JObject&gt; GetJsonAsync(Uri uri)
{
using (var client = new HttpClient())
{
var jsonString = await client.GetStringAsync(uri).ConfigureAwait(false);
return JObject.Parse(jsonString);
}
}
</code></pre></div></div>
<p>This changes the continuation behavior of GetJsonAsync so that it does not resume on the context. Instead, GetJsonAsync will resume on a thread pool thread. This enables GetJsonAsync to complete the Task it returned without having to re-enter the context.</p>

<p>Consider the second best practice. The new “top-level” methods look like this:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public async void Button1_Click(...)
{
var json = await GetJsonAsync(...);
textBox1.Text = json;
}

public class MyController : ApiController
{
public async Task&lt;string&gt; Get()
{
var json = await GetJsonAsync(...);
return json.ToString();
}
}
</code></pre></div></div>
<p>This changes the blocking behavior of the top-level methods so that the context is never actually blocked; all “waits” are “asynchronous waits”.</p>

<p>Note: It is best to apply both best practices. Either one will prevent the deadlock, but both must be applied to achieve maximum performance and responsiveness.</p>

<hr>

<p>Calling async method synchronously</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>void Func(){

Task&lt;string&gt; sCode = Task.Run(async () =&gt;
{
string msg =await GenerateCodeAsync();
return msg;
});

}
</code></pre></div></div>
<h2 id="3threadingtimer-run-async-task">3.Threading.Timer run Async Task</h2>
<p>Sometimes you may encounter such a requirement that you have a timer, and you have to do a async operation inside timer’s callback which is a sync method.</p>

<p>(in Java they have TimerTask, but seems in C# we don’t have the equivalent class)</p>

<p>a.try Nito.AsyncEx - https://github.com/StephenCleary/AsyncEx</p>

<p><a href="http://stackoverflow.com/questions/9343594/how-to-call-asynchronous-method-from-synchronous-method-in-c">How to call asynchronous method from synchronous method in C#?</a></p>

<p><a href="http://stackoverflow.com/questions/20395826/explicitly-use-a-functask-for-asynchronous-lambda-function-when-action-overloa">Explicitly use a Func for asynchronous lambda function when Action overload is available</a>
b.Task based timer implement:</p>

<p><a href="http://stackoverflow.com/questions/4890915/is-there-a-task-based-replacement-for-system-threading-timer">Is there a Task based replacement for System.Threading.Timer?</a></p>

<p><a href="http://stackoverflow.com/questions/18646650/how-to-implement-task-async-for-a-timer-in-c">How to implement Task Async for a timer in C#?</a>
c.I found this alternative ‘solution’, but this approach is proved not reliable.</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var t = new System.Threading.Timer(async (object state) =&gt;
{
await aysncOperation();
Console.WriteLine("Tmr Callback on: " + Thread.CurrentThread.ManagedThreadId);
});
</code></pre></div></div>
<p>here is why this approach can not work as we expect: <a href="http://blogs.msdn.com/b/pfxteam/archive/2012/02/08/10265476.aspx">Potential pitfalls to avoid when passing around async lambdas</a></p>

<p>references:</p>

<p><a href="http://www.abhisheksur.com/2011/03/all-about-net-timers-comparison.html">All about .NET Timers - A Comparison</a></p>

<p><a href="https://msdn.microsoft.com/en-us/library/hh191443.aspx">MSDN:Asynchronous Programming with Async and Await (C# and Visual Basic)</a></p>

<p><a href="https://msdn.microsoft.com/en-us/magazine/jj991977.aspx">Best Practices in Asynchronous Programming</a></p>

<p><a href="https://www.microsoft.com/en-us/download/details.aspx?id=19957">Task-based Asynchronous Pattern</a></p>

<p><a href="http://developer.51cto.com/art/201407/445556_all.htm">async &amp; await 的前世今生</a></p>

<p><a href="http://www.cnblogs.com/cmt/p/configure_await_false.html">走进异步世界-犯傻也值得分享：ConfigureAwait(false)使用经验分享</a></p>

<p><a href="http://zhidao.baidu.com/question/1574266920443995780.html">C#中async编程完全代替了Task了吗</a></p>

<p>System.Timers.Timer “single-threaded” usage</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>System.Timers.Timer t;
 
void StartTimer()  {
  t = new System.Timers.Timer();
  t.Interval = 500;
  t.AutoReset = false;
  t.Elapsed += TimerProc;
  t.Enabled = true;
}
 
void TimerProc(object sender, System.Timers.ElapsedEventArgs e) {
  Task();
  t.Enabled = true;
}
 
void Task() {
}
https://www.codeproject.com/Questions/405564/Syste-Timers-Timer-single-threaded-usage
</code></pre></div></div>

<h2 id="4k__backingfield">4. k__backingfield</h2>
<p>Use DataContract DataMember, add reference System.Runtime.Serialization</p>

<h2 id="5there-is-already-datareader-associated-with-this-command">5.there is already datareader associated with this command</h2>
<p>http://devproconnections.com/development/solving-net-scalability-problem</p>

<h2 id="6-iterate-datetime-beware-of-your-datetime-string-especially-when-the-source-is-from-excel">6. Iterate Datetime beware of your datetime string, especially when the source is from excel</h2>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>string dateStr="2016-01-01 11:59:59";

DateTime.ParseExtrat(dateStr,"yyyy-MM-dd",null)  ,  result is 2016-01-01 00:00:00 (12:00：00 am)

string dateStr="27/1/2011  11:27:19 AM";

DateTime.TryParseExact(***, "d/M/yyyy h:m:s tt", CultureInfo.InvariantCulture, DateTimeStyles.None, out dt)

string myValue = "12:00:00.000";

DateTime myDate = DateTime.ParseExact(myValue, "HH:mm:ss:fff");

C# DateTime Format: A Concise Explanation for Beginners

https://blog.udemy.com/c-sharp-datetime-format/
</code></pre></div></div>

<h2 id="7network-folder">7.network folder</h2>
<p>Unhandled Exception: System.ArgumentException: The UNC path should be of the form \server\share.</p>

<p>http://stackoverflow.com/questions/3567063/get-a-list-of-all-unc-shared-folders-on-a-local-network-server</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>//
// Enumerate shares on local computer
//
Console.WriteLine("\nShares on local computer:");
ShareCollection shi = ShareCollection.LocalShares;
if (shi != null)
{
foreach(Share si in shi)
{
Console.WriteLine("{0}: {1} [{2}]",
si.ShareType, si, si.Path);

// If this is a file-system share, try to
// list the first five subfolders.
// NB: If the share is on a removable device,
// you could get "Not ready" or "Access denied"
// exceptions.
if (si.IsFileSystem)
{
try
{
System.IO.DirectoryInfo d = si.Root;
System.IO.DirectoryInfo[] Flds = d.GetDirectories();
for (int i=0; i &lt; Flds.Length &amp;&amp; i &lt; 5; i++) Console.WriteLine("\t{0} - {1}", i, Flds[i].FullName); Console.WriteLine(); } catch (Exception ex) { Console.WriteLine("\tError listing {0}:\n\t{1}\n", si, ex.Message); } } } } else Console.WriteLine("Unable to enumerate the local shares."); // // Resolve local paths to UNC paths. // Console.WriteLine("{0} = {1}", fileName, ShareCollection.PathToUnc(fileName));
</code></pre></div></div>
<h2 id="8serialize-de-serialize-dynamic-objects">8.Serialize De-serialize dynamic objects</h2>
<p>Deserialize JSON into C# dynamic object?</p>

<p>http://stackoverflow.com/questions/3142495/deserialize-json-into-c-sharp-dynamic-object</p>

<p>Quick JSON Serialization/Deserialization in C#</p>

<h2 id="9email-attachment">9.Email attachment</h2>
<p>https://gist.github.com/mvark/8c523eb47670c2fc8da4</p>

<h2 id="10openxml-for-excel">10.OpenXML for excel</h2>
<p>https://msdn.microsoft.com/en-us/library/bb448854.aspx</p>

<p>Stylizing https://blogs.msdn.microsoft.com/chrisquon/2009/11/30/stylizing-your-excel-worksheets-with-open-xml-2-0/</p>

<p>Set Column Width https://social.msdn.microsoft.com/Forums/en-US/37419b3b-fc97-47a4-a52f-fba62a9dcabf/how-to-open-an-existing-excel-worksheet-and-set-column-width-to-best-fit-using-openxml-sax-in-c-?forum=oxmlsdk</p>

<p>Open XML SDK: get “Unreadable content” error when trying to populate more than 25 columns</p>

<p>http://stackoverflow.com/questions/14525573/open-xml-sdk-get-unreadable-content-error-when-trying-to-populate-more-than-2</p>

<h2 id="11unable-to-find-manifest-signing-certificate-in-the-certificate-store">11.Unable to find manifest signing certificate in the certificate store</h2>
<p>http://stackoverflow.com/questions/11957295/unable-to-find-manifest-signing-certificate-in-the-certificate-store-even-wh</p>

<h2 id="12-reflection">12. Reflection</h2>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public class ObjectB
{
public int Id { get; set; }
public string Name { get; set; }
}

public class ObjectA
{
public int Id { get; set; }
public string Name { get; set; }
public ObjectB Child { get; set; }
}
</code></pre></div></div>

<p>a. Grap a property of ObjectB obj.GetType().GetProperty(“Name”).GetValue(obj, null);</p>

<p>b. Sum Of a column of generic list by passing column name anonymously List list:list.Sum(x =&gt; x.GetType().GetProperty(columnName).GetValue(x, null)).ToString();</p>

<p>c. Get Property Value of Nested Classes</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public static class ReflectionHelper
{
public static Object GetPropValue(this Object obj, String propName)
{
string[] nameParts = propName.Split('.');
if (nameParts.Length == 1)
{
return obj.GetType().GetProperty(propName).GetValue(obj, null);
}
foreach (String part in nameParts)
{
if (obj == null) { return null; }

Type type = obj.GetType();
PropertyInfo info = type.GetProperty(part);
if (info == null) { return null; }

obj = info.GetValue(obj, null);
}
return obj;
}
}
</code></pre></div></div>

<h2 id="13-smtp">13. SMTP</h2>
<p>Gmail</p>

<p>pro#1: unable to read data from the transport connection net_io_connectionclosed</p>

<p>change port 465 to 587, EnableSsl = true, The .NET SmtpClient only supports encryption via STARTTLS. If the EnableSsl flag is set, the server must respond to EHLO with a STARTTLS, otherwise it will throw an exception.</p>

<p>pro#2: he SMTP server requires a secure connection or the client was not authenticated. The server response was: 5.5.1 Authentication Required.</p>

<p>it may not be your code issue but high possibility is that your gmail account may encounter security blocking, simpliest way is to check whether you have rececived an email like this:
<img src="/content/images/post/20190101/gmail_smtp_blocked_signin.png" alt="">
then click ‘allowing access to less secure apps’</p>

<p>if still cannot , try this https://accounts.google.com/DisplayUnlockCaptcha, unlock it</p>

<p>see more at http://stackoverflow.com/questions/20906077/gmail-error-the-smtp-server-requires-a-secure-connection-or-the-client-was-not</p>

<h2 id="14compile-error">14.Compile error</h2>
<p>1.for xml/ config file, some times got “Severity Code Description Project File Line Suppression State Error Invalid token ‘Text’ at root level of document”</p>

<p>right click- properties - Build Action - choose None.</p>

<p>2.Parser Error Message: Only one &lt;configSections&gt; element allowed per config file and if present must be the first child of the root</p>

<h2 id="15quartznet">15.Quartz.Net</h2>
<p>TimeZone problem https://forums.asp.net/t/2001087.aspx?Quartz+NET+scheduling+jobs+in+mvc+on+windows+azure
http://mattrandle.me/azure-worker-role-and-quartz-net/
http://knightcodes.com/.net/2016/08/15/xml-configuration-for-quartz-net.html</p>

<h2 id="16-run-python-in-net">16. RUN PYTHON IN .NET</h2>
<p>Running Python script from C# and working with the results https://medium.com/@dpursanov/running-python-script-from-c-and-working-with-the-results-843e68d230e5</p>

<p>http://devcenter.wintellect.com/jrobbins/pdb-files-what-every-developer-must-know</p>

<p>WorkingDirectory</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>processStartInfo start = new ProcessStartInfo();
processStartInfo start = new ProcessStartInfo();
start.FileName = "C:\\Python27\\python.exe";
Console.Write(args.Length);
// arg[0] = Path to your python script (example : "C:\\add_them.py")
// arg[1] = first arguement taken from  C#'s main method's args variable (here i'm passing a number : 5)
// arg[2] = second arguement taken from  C#'s main method's args variable ( here i'm passing a number : 6)
// pass these to your Arguements property of your ProcessStartInfo instance
start.Arguments = string.Format("{0} {1} {2}",args[0],args[1],args[2]);
start.UseShellExecute = false;
start.RedirectStandardOutput = true;
using (Process process = Process.Start(start)){ 
				using (StreamReader reader = process.StandardOutput) { 
							string result = reader.ReadToEnd(); // this prints 11 
							Console.Write(result);
				}
}
</code></pre></div></div>

<h3 id="issuesmvc-ajax-get-empty-data">issues:mvc ajax get empty data:</h3>
<p>By default, the asp.net mvc does not allow an HTTP GET request with a JSON payload. You need to explicitly allow the behavior by using JsonRequestBehavior.AllowGet as the second parameter to the Json method like following.</p>

<p>return Json(returnObj, JsonRequestBehavior.AllowGet);</p>
<h3 id="issuesjson-decoding-unexpected-token-startarray">issues:JSON decoding: Unexpected token: StartArray</h3>

<p>the value starts from the exception position should be deserialized as an object, not a string</p>

<h3 id="issuesan-asynchronous-module-or-handler-completed-while-an-asynchronous-operation-was-still-pending">issues: An asynchronous module or handler completed while an asynchronous operation was still pending</h3>

<p>https://stackoverflow.com/questions/28805796/asp-net-controller-an-asynchronous-module-or-handler-completed-while-an-asynchr/28806198</p>

<p>That’s because Task.Factory.StartNew does something dangerous in ASP.NET. It doesn’t register the tasks execution with ASP.NET. This can lead to edge cases where a pool recycle executes, ignoring your background task completely, causing an abnormal abort. That is why you have to use a mechanism which registers the task, such as HostingEnvironment.QueueBackgroundWorkItem.</p>

        
      </section>

      <footer class="page__meta">
        
        


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2019-01-01T00:00:00+08:00">January 01, 2019</time></p>
        
      </footer>

      <section class="page__share">
  

  <a href="https://twitter.com/intent/tweet?text=Code+Snippets+Series+%E2%80%93+C%23%20http%3A%2F%2Flocalhost%3A4000%2Fmigrate-codesnippets_csharp%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2Fmigrate-codesnippets_csharp%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://plus.google.com/share?url=http%3A%2F%2Flocalhost%3A4000%2Fmigrate-codesnippets_csharp%2F" class="btn btn--google-plus" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Google Plus"><i class="fab fa-fw fa-google-plus" aria-hidden="true"></i><span> Google+</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3A%2F%2Flocalhost%3A4000%2Fmigrate-codesnippets_csharp%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/migrate-chatroom/" class="pagination--pager" title="Online chat room from NULL 聊天室开发
">Previous</a>
    
    
      <a href="/migrate-confucius/" class="pagination--pager" title="孔子 – 大學之道 CONFUCIUS – The Way of Ultimate Wisdom
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You May Also Enjoy</h4>
      <div class="grid__wrapper">
        
          
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/arp/" rel="permalink">troubleshooting intranet access issue raised by wrong arp
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  1 minute read
</p>
    
    <p class="archive__item-excerpt" itemprop="description">I got an issue access the shared folder on the other pc in the same intranet at home, actually it was working fine a few days ago.
both pc are win10 os.

</p>
  </article>
</div>

        
          
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/mysql_replication/" rel="permalink">Mysql replication test between different version
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  less than 1 minute read
</p>
    
    <p class="archive__item-excerpt" itemprop="description">Master: mysql5.7

Slave: mysql8.0


</p>
  </article>
</div>

        
          
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/storm/" rel="permalink">Apache storm starter
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  2 minute read
</p>
    
    <p class="archive__item-excerpt" itemprop="description">run WordCountTopology in Local Mode and (Local) Cluster Mode
version: 1.2.2
env: vms centos7
example:https://github.com/apache/storm/blob/v1.2.2/examples/sto...</p>
  </article>
</div>

        
          
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/hdfs/" rel="permalink">[Hadoop ecosystem] Chapter 1: Data Storage: HDFS
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  less than 1 minute read
</p>
    
    <p class="archive__item-excerpt" itemprop="description">Hadoop ecosystem series…
</p>
  </article>
</div>

        
      </div>
    </div>
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap">
<form onsubmit="return googleCustomSearchExecute();" id="cse-search-box-form-id">
    <input type="text" id="cse-search-input-box-id" class="search-input" tabindex="-1" placeholder="Enter your search term...">
    </form>
    <div id="results" class="results">
        <searchresults-only></searchresults-only>    
    </div>
</div>

      </div>
    

    <div class="page__footer">
      <footer>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-9742852210287449",
    enable_page_level_ads: true
  });
</script>
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    
      
        
          <li><a href="https://alphawallet.com/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-university" aria-hidden="true"></i> AlphaWallet</a></li>
        
      
        
          <li><a href="https://developers.google.com/edu/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-google" aria-hidden="true"></i> Google Course</a></li>
        
      
        
          <li><a href="http://vouchain.one/" rel="nofollow noopener noreferrer"><i class="fas fa-link" aria-hidden="true"></i> other</a></li>
        
      
    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">© 2019 LIU YUE'S - NOTES TO SHARE. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script data-search-pseudo-elements defer src="https://use.fontawesome.com/releases/v5.7.1/js/all.js" integrity="sha384-eVEQC9zshBn0rFj4+TU78eNA19HMNigMviK/PU/FFjLXqa/GKPgX58rvt5Z8PLs7" crossorigin="anonymous"></script>


<script>
  (function () {
    var cx = '016202475545879656962:ot3scpbjy9y';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();

  function googleCustomSearchExecute() {
    var input = document.getElementById('cse-search-input-box-id');
    var element = google.search.cse.element.getElement('searchresults-only0');
    if (input.value == '') {
      element.clearAllResults();
    } else {
      element.execute(input.value);
    }
    return false;
  }

  
    $(document).ready(function () {
      $('input#cse-search-input-box-id').on('keyup', function () {
        googleCustomSearchExecute();
      });
    });
  
</script>




    
  <script>
    var disqus_config = function () {
      this.page.url = "http://localhost:4000/migrate-codesnippets_csharp/";  // Replace PAGE_URL with your page's canonical URL variable
      this.page.identifier = "/migrate-codesnippets_csharp"; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    (function() { // DON'T EDIT BELOW THIS LINE
      var d = document, s = d.createElement('script');
      s.src = 'https://lyhistory.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>


  



  </body>
</html>
